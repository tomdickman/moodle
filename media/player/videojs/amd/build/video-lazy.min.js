function _typeof(e){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t(require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define ("media_videojs/video-lazy",["./window","./document"],t):(e=e||self,e.videojs=t(e.window,e.document))})(this,function(e,t){e=e&&e.hasOwnProperty("default")?e["default"]:e;t=t&&t.hasOwnProperty("default")?t["default"]:t;function a(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}function n(e,t){n=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return n(e,t)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function s(){if(r()){s=Reflect.construct}else{s=function(e,t,r){var i=[null];i.push.apply(i,t);var a=Function.bind.apply(e,i),s=new a;if(r)n(s,r.prototype);return s}}return s.apply(null,arguments)}function o(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function d(e,t){if(!t){t=e.slice(0)}e.raw=t;return e}var kt=[],Ct=function(t,a){return function(n,r,i){var s=a.levels[r],o=new RegExp("^("+s+")$");if("log"!==n){i.unshift(n.toUpperCase()+":")}i.unshift(t+":");if(kt){kt.push([].concat(i))}if(!e.console){return}var d=e.console[n];if(!d&&"debug"===n){d=e.console.info||e.console.log}if(!d||!s||!o.test(n)){return}d[Array.isArray(i)?"apply":"call"](e.console,i)}};function l(e){var t="info",a,n=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++){n[r]=arguments[r]}a("log",t,n)};a=Ct(e,n);n.createLogger=function(t){return l(e+": "+t)};n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:t};n.level=function(e){if("string"==typeof e){if(!n.levels.hasOwnProperty(e)){throw new Error("\""+e+"\" in not a valid log level")}t=e}return t};n.history=function(){return kt?[].concat(kt):[]};n.history.filter=function(e){return(kt||[]).filter(function(t){return new RegExp(".*"+e+".*").test(t[0])})};n.history.clear=function(){if(kt){kt.length=0}};n.history.disable=function(){if(null!==kt){kt.length=0;kt=null}};n.history.enable=function(){if(null===kt){kt=[]}};n.error=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++){n[r]=arguments[r]}return a("error",t,n)};n.warn=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++){n[r]=arguments[r]}return a("warn",t,n)};n.debug=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++){n[r]=arguments[r]}return a("debug",t,n)};return n}var Et=l("VIDEOJS"),Lt=Et.createLogger;function p(e){return e.replace(/\n\r?\s*/g,"")}var It=function(e){var t="",a=0;for(;a<arguments.length;a++){t+=p(e[a])+(arguments[a+1]||"")}return t},Pt=Object.prototype.toString,xt=function(e){return g(e)?Object.keys(e):[]};function u(e,t){xt(e).forEach(function(a){return t(e[a],a)})}function c(e,t,a){if(void 0===a){a=0}return xt(e).reduce(function(a,n){return t(a,e[n],n)},a)}function m(e){for(var t=arguments.length,a=Array(1<t?t-1:0),n=1;n<t;n++){a[n-1]=arguments[n]}if(Object.assign){return Object.assign.apply(Object,[e].concat(a))}a.forEach(function(t){if(!t){return}u(t,function(t,a){e[a]=t})});return e}function g(e){return!!e&&"object"===_typeof(e)}function h(e){return g(e)&&"[object Object]"===Pt.call(e)&&e.constructor===Object}function y(t,a){if(!t||!a){return""}if("function"==typeof e.getComputedStyle){var n=e.getComputedStyle(t);return n?n[a]:""}return""}function _(){var e=d(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);_=function(){return e};return e}function f(e){return"string"==typeof e&&/\S/.test(e)}function b(e){if(/\s/.test(e)){throw new Error("class has illegal whitespace characters")}}function T(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}function v(){return t===e.document}function S(e){return g(e)&&1===e.nodeType}function k(){try{return e.parent!==e.self}catch(e){return!0}}function C(e){return function(a,n){if(!f(a)){return t[e](null)}if(f(n)){n=t.querySelector(n)}var r=S(n)?n:t;return r[e]&&r[e](a)}}function E(e,a,n,r){if(void 0===e){e="div"}if(void 0===a){a={}}if(void 0===n){n={}}var i=t.createElement(e);Object.getOwnPropertyNames(a).forEach(function(e){var t=a[e];if(-1!==e.indexOf("aria-")||"role"===e||"type"===e){Et.warn(It(_(),e,t));i.setAttribute(e,t)}else if("textContent"===e){L(i,t)}else{i[e]=t}});Object.getOwnPropertyNames(n).forEach(function(e){i.setAttribute(e,n[e])});if(r){G(i,r)}return i}function L(e,t){if("undefined"==typeof e.textContent){e.innerText=t}else{e.textContent=t}return e}function I(e,t){if(t.firstChild){t.insertBefore(e,t.firstChild)}else{t.appendChild(e)}}function P(e,t){b(t);if(e.classList){return e.classList.contains(t)}return T(t).test(e.className)}function x(e,t){if(e.classList){e.classList.add(t)}else if(!P(e,t)){e.className=(e.className+" "+t).trim()}return e}function D(e,t){if(e.classList){e.classList.remove(t)}else{b(t);e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")}return e}function A(e,t,a){var n=P(e,t);if("function"==typeof a){a=a(e,t)}if("boolean"!=typeof a){a=!n}if(a===n){return}if(a){x(e,t)}else{D(e,t)}return e}function w(e,t){Object.getOwnPropertyNames(t).forEach(function(a){var n=t[a];if(null===n||"undefined"==typeof n||!1===n){e.removeAttribute(a)}else{e.setAttribute(a,!0===n?"":n)}})}function O(e){var t={};if(e&&e.attributes&&0<e.attributes.length){for(var a=e.attributes,n=a.length-1;0<=n;n--){var r=a[n].name,s=a[n].value;if("boolean"==typeof e[r]||-1!==",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+r+",")){s=null!==s?!0:!1}t[r]=s}}return t}function U(e,t){return e.getAttribute(t)}function R(e,t,a){e.setAttribute(t,a)}function M(e,t){e.removeAttribute(t)}function B(){t.body.focus();t.onselectstart=function(){return!1}}function N(){t.onselectstart=function(){return!0}}function j(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),a={};["bottom","height","left","right","top","width"].forEach(function(e){if(t[e]!==void 0){a[e]=t[e]}});if(!a.height){a.height=parseFloat(y(e,"height"))}if(!a.width){a.width=parseFloat(y(e,"width"))}return a}}function F(a){var n;if(a.getBoundingClientRect&&a.parentNode){n=a.getBoundingClientRect()}if(!n){return{left:0,top:0}}var r=t.documentElement,i=t.body,s=r.clientLeft||i.clientLeft||0,o=e.pageXOffset||i.scrollLeft,d=n.left+o-s,l=r.clientTop||i.clientTop||0,p=e.pageYOffset||i.scrollTop,u=n.top+p-l;return{left:Math.round(d),top:Math.round(u)}}function H(e,t){var a={},n=F(e),r=e.offsetWidth,i=e.offsetHeight,s=n.top,o=n.left,d=t.pageY,l=t.pageX;if(t.changedTouches){l=t.changedTouches[0].pageX;d=t.changedTouches[0].pageY}a.y=Math.max(0,Math.min(1,(s-d+i)/i));a.x=Math.max(0,Math.min(1,(l-o)/r));return a}function V(e){return g(e)&&3===e.nodeType}function q(e){while(e.firstChild){e.removeChild(e.firstChild)}return e}function z(e){if("function"==typeof e){e=e()}return(Array.isArray(e)?e:[e]).map(function(e){if("function"==typeof e){e=e()}if(S(e)||V(e)){return e}if("string"==typeof e&&/\S/.test(e)){return t.createTextNode(e)}}).filter(function(e){return e})}function G(e,t){z(t).forEach(function(t){return e.appendChild(t)});return e}function W(e,t){return G(q(e),t)}function K(e){if(e.button===void 0&&e.buttons===void 0){return!0}if(0===e.button&&e.buttons===void 0){return!0}if(0!==e.button||1!==e.buttons){return!1}return!0}var Dt=C("querySelector"),$=C("querySelectorAll"),At=Object.freeze({isReal:v,isEl:S,isInFrame:k,createEl:E,textContent:L,prependTo:I,hasClass:P,addClass:x,removeClass:D,toggleClass:A,setAttributes:w,getAttributes:O,getAttribute:U,setAttribute:R,removeAttribute:M,blockTextSelection:B,unblockTextSelection:N,getBoundingClientRect:j,findPosition:F,getPointerPosition:H,isTextNode:V,emptyEl:q,normalizeContent:z,appendContent:G,insertContent:W,isSingleLeftClick:K,$:Dt,$$:$}),wt=1;function Y(){return wt++}var Ot={},Ut="vdata"+new Date().getTime();function X(e){var t=e[Ut];if(!t){t=e[Ut]=Y()}if(!Ot[t]){Ot[t]={}}return Ot[t]}function Q(e){var t=e[Ut];if(!t){return!1}return!!Object.getOwnPropertyNames(Ot[t]).length}function J(t){var e=t[Ut];if(!e){return}delete Ot[e];try{delete t[Ut]}catch(a){if(t.removeAttribute){t.removeAttribute(Ut)}else{t[Ut]=null}}}function Z(e,t){var a=X(e);if(0===a.handlers[t].length){delete a.handlers[t];if(e.removeEventListener){e.removeEventListener(t,a.dispatcher,!1)}else if(e.detachEvent){e.detachEvent("on"+t,a.dispatcher)}}if(0>=Object.getOwnPropertyNames(a.handlers).length){delete a.handlers;delete a.dispatcher;delete a.disabled}if(0===Object.getOwnPropertyNames(a).length){J(e)}}function ee(e,t,a,n){a.forEach(function(a){e(t,a,n)})}function te(a){function n(){return!0}function r(){return!1}if(!a||!a.isPropagationStopped){var i=a||e.event;a={};for(var s in i){if("layerX"!=s&&"layerY"!=s&&"keyLocation"!=s&&"webkitMovementX"!=s&&"webkitMovementY"!=s){if(!("returnValue"==s&&i.preventDefault)){a[s]=i[s]}}}if(!a.target){a.target=a.srcElement||t}if(!a.relatedTarget){a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement}a.preventDefault=function(){if(i.preventDefault){i.preventDefault()}a.returnValue=!1;i.returnValue=!1;a.defaultPrevented=!0};a.defaultPrevented=!1;a.stopPropagation=function(){if(i.stopPropagation){i.stopPropagation()}a.cancelBubble=!0;i.cancelBubble=!0;a.isPropagationStopped=n};a.isPropagationStopped=r;a.stopImmediatePropagation=function(){if(i.stopImmediatePropagation){i.stopImmediatePropagation()}a.isImmediatePropagationStopped=n;a.stopPropagation()};a.isImmediatePropagationStopped=r;if(null!==a.clientX&&a.clientX!==void 0){var o=t.documentElement,d=t.body;a.pageX=a.clientX+(o&&o.scrollLeft||d&&d.scrollLeft||0)-(o&&o.clientLeft||d&&d.clientLeft||0);a.pageY=a.clientY+(o&&o.scrollTop||d&&d.scrollTop||0)-(o&&o.clientTop||d&&d.clientTop||0)}a.which=a.charCode||a.keyCode;if(null!==a.button&&a.button!==void 0){a.button=1&a.button?0:4&a.button?1:2&a.button?2:0}}return a}var Rt=!1;(function(){try{var t=Object.defineProperty({},"passive",{get:function(){Rt=!0}});e.addEventListener("test",null,t);e.removeEventListener("test",null,t)}catch(t){}})();var Mt=["touchstart","touchmove"];function ae(e,t,a){if(Array.isArray(t)){return ee(ae,e,t,a)}var r=X(e);if(!r.handlers){r.handlers={}}if(!r.handlers[t]){r.handlers[t]=[]}if(!a.guid){a.guid=Y()}r.handlers[t].push(a);if(!r.dispatcher){r.disabled=!1;r.dispatcher=function(t,a){if(r.disabled){return}t=te(t);var i=r.handlers[t.type];if(i){for(var s=i.slice(0),o=0,d=s.length;o<d;o++){if(t.isImmediatePropagationStopped()){break}else{try{s[o].call(e,t,a)}catch(t){Et.error(t)}}}}}}if(1===r.handlers[t].length){if(e.addEventListener){var i=!1;if(Rt&&-1<Mt.indexOf(t)){i={passive:!0}}e.addEventListener(t,r.dispatcher,i)}else if(e.attachEvent){e.attachEvent("on"+t,r.dispatcher)}}}function ne(e,a,r){if(!Q(e)){return}var i=X(e);if(!i.handlers){return}if(Array.isArray(a)){return ee(ne,e,a,r)}var s=function(e,a){i.handlers[a]=[];Z(e,a)};if(a===void 0){for(var o in i.handlers){if(Object.prototype.hasOwnProperty.call(i.handlers||{},o)){s(e,o)}}return}var t=i.handlers[a];if(!t){return}if(!r){s(e,a);return}if(r.guid){for(var d=0;d<t.length;d++){if(t[d].guid===r.guid){t.splice(d--,1)}}}Z(e,a)}function re(e,t,a){var n=Q(e)?X(e):{},r=e.parentNode||e.ownerDocument;if("string"==typeof t){t={type:t,target:e}}else if(!t.target){t.target=e}t=te(t);if(n.dispatcher){n.dispatcher.call(e,t,a)}if(r&&!t.isPropagationStopped()&&!0===t.bubbles){re.call(null,r,t,a)}else if(!r&&!t.defaultPrevented&&t.target&&t.target[t.type]){var i=X(t.target);if(t.target[t.type]){i.disabled=!0;if("function"==typeof t.target[t.type]){t.target[t.type]()}i.disabled=!1}}return!t.defaultPrevented}function ie(e,t,a){if(Array.isArray(t)){return ee(ie,e,t,a)}var n=function n(){ne(e,t,n);a.apply(this,arguments)};n.guid=a.guid=a.guid||Y();ae(e,t,n)}var Bt=Object.freeze({fixEvent:te,on:ae,off:ne,trigger:re,one:ie}),Nt=!1,jt,Ft=function(){if(!v()||!1===jt.options.autoSetup){return}var a=Array.prototype.slice.call(t.getElementsByTagName("video")),n=Array.prototype.slice.call(t.getElementsByTagName("audio")),r=Array.prototype.slice.call(t.getElementsByTagName("video-js")),s=a.concat(n,r);if(s&&0<s.length){for(var o=0,d=s.length,e;o<d;o++){e=s[o];if(e&&e.getAttribute){if(e.player===void 0){var l=e.getAttribute("data-setup");if(null!==l){jt(e)}}}else{se(1);break}}}else if(!Nt){se(1)}};function se(t,a){if(a){jt=a}e.setTimeout(Ft,t)}if(v()&&"complete"===t.readyState){Nt=!0}else{ie(e,"load",function(){Nt=!0})}var Ht=function(e){var a=t.createElement("style");a.className=e;return a},Vt=function(e,t){if(e.styleSheet){e.styleSheet.cssText=t}else{e.textContent=t}},qt=function(e,t,a){if(!t.guid){t.guid=Y()}var n=function(){return t.apply(e,arguments)};n.guid=a?a+"_"+t.guid:t.guid;return n},zt=function(e,t){var a=Date.now(),n=function(){var n=Date.now();if(n-a>=t){e.apply(void 0,arguments);a=n}};return n},Gt=function(t,a,n,r){if(void 0===r){r=e}var i,s=function(){r.clearTimeout(i);i=null},o=function(){var e=this,s=arguments,o=function(){i=null;o=null;if(!n){t.apply(e,s)}};if(!i&&n){t.apply(e,s)}r.clearTimeout(i);i=r.setTimeout(o,a)};o.cancel=s;return o},Wt=function(){};Wt.prototype.allowedEvents_={};Wt.prototype.on=function(e,t){var a=this.addEventListener;this.addEventListener=function(){};ae(this,e,t);this.addEventListener=a};Wt.prototype.addEventListener=Wt.prototype.on;Wt.prototype.off=function(e,t){ne(this,e,t)};Wt.prototype.removeEventListener=Wt.prototype.off;Wt.prototype.one=function(e,t){var a=this.addEventListener;this.addEventListener=function(){};ie(this,e,t);this.addEventListener=a};Wt.prototype.trigger=function(e){var t=e.type||e;if("string"==typeof e){e={type:t}}e=te(e);if(this.allowedEvents_[t]&&this["on"+t]){this["on"+t](e)}re(this,e)};Wt.prototype.dispatchEvent=Wt.prototype.trigger;var Kt;Wt.prototype.queueTrigger=function(t){var a=this;if(!Kt){Kt=new Map}var n=t.type||t,r=Kt.get(this);if(!r){r=new Map;Kt.set(this,r)}var i=r.get(n);r.delete(n);e.clearTimeout(i);var s=e.setTimeout(function(){if(0===r.size){r=null;Kt.delete(a)}a.trigger(t)},0);r.set(n,s)};var Yt=function(e){return e instanceof Wt||!!e.eventBusEl_&&["on","one","off","trigger"].every(function(t){return"function"==typeof e[t]})},Xt=function(e,t){if(Yt(e)){t()}else{if(!e.eventedCallbacks){e.eventedCallbacks=[]}e.eventedCallbacks.push(t)}},$t=function(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},Qt=function(e){if(!e.nodeName&&!Yt(e)){throw new Error("Invalid target; must be a DOM node or evented object.")}},Jt=function(e){if(!$t(e)){throw new Error("Invalid event type; must be a non-empty string or array.")}},Zt=function(e){if("function"!=typeof e){throw new Error("Invalid listener; must be a function.")}},ea=function(e,t){var a=3>t.length||t[0]===e||t[0]===e.eventBusEl_,n,r,i;if(a){n=e.eventBusEl_;if(3<=t.length){t.shift()}r=t[0];i=t[1]}else{n=t[0];r=t[1];i=t[2]}Qt(n);Jt(r);Zt(i);i=qt(e,i);return{isTargetingSelf:a,target:n,type:r,listener:i}},ta=function(e,t,a,n){Qt(e);if(e.nodeName){Bt[t](e,a,n)}else{e[t](a,n)}},aa={on:function(){for(var e=this,t=arguments.length,a=Array(t),n=0;n<t;n++){a[n]=arguments[n]}var r=ea(this,a),i=r.isTargetingSelf,s=r.target,o=r.type,d=r.listener;ta(s,"on",o,d);if(!i){var l=function(){return e.off(s,o,d)};l.guid=d.guid;var p=function(){return e.off("dispose",l)};p.guid=d.guid;ta(this,"on","dispose",l);ta(s,"on","dispose",p)}},one:function(){for(var e=this,t=arguments.length,a=Array(t),n=0;n<t;n++){a[n]=arguments[n]}var r=ea(this,a),i=r.isTargetingSelf,s=r.target,o=r.type,d=r.listener;if(i){ta(s,"one",o,d)}else{var l=function t(){e.off(s,o,t);for(var a=arguments.length,n=Array(a),r=0;r<a;r++){n[r]=arguments[r]}d.apply(null,n)};l.guid=d.guid;ta(s,"one",o,l)}},off:function(e,t,a){if(!e||$t(e)){ne(this.eventBusEl_,e,t)}else{var n=e,r=t;Qt(n);Jt(r);Zt(a);a=qt(this,a);this.off("dispose",a);if(n.nodeName){ne(n,r,a);ne(n,"dispose",a)}else if(Yt(n)){n.off(r,a);n.off("dispose",a)}}},trigger:function(e,t){return re(this.eventBusEl_,e,t)}};function oe(t,a){if(void 0===a){a={}}var n=a,r=n.eventBusKey;if(r){if(!t[r].nodeName){throw new Error("The eventBusKey \""+r+"\" does not refer to an element.")}t.eventBusEl_=t[r]}else{t.eventBusEl_=E("span",{className:"vjs-event-bus"})}m(t,aa);if(t.eventedCallbacks){t.eventedCallbacks.forEach(function(e){e()})}t.on("dispose",function(){t.off();e.setTimeout(function(){t.eventBusEl_=null},0)});return t}var na={state:{},setState:function(e){var t=this;if("function"==typeof e){e=e()}var a;u(e,function(e,n){if(t.state[n]!==e){a=a||{};a[n]={from:t.state[n],to:e}}t.state[n]=e});if(a&&Yt(this)){this.trigger({changes:a,type:"statechanged"})}return a}};function de(e,t){m(e,na);e.state=m({},e.state,t);if("function"==typeof e.handleStateChanged&&Yt(e)){e.on("statechanged",e.handleStateChanged)}return e}function le(e){if("string"!=typeof e){return e}return e.charAt(0).toUpperCase()+e.slice(1)}function pe(e,t){return le(e)===le(t)}function ue(){for(var e={},t=arguments.length,a=Array(t),n=0;n<t;n++){a[n]=arguments[n]}a.forEach(function(t){if(!t){return}u(t,function(t,a){if(!h(t)){e[a]=t;return}if(!h(e[a])){e[a]={}}e[a]=ue(e[a],t)})});return e}var ra=function(){function t(e,t,a){if(!e&&this.play){this.player_=e=this}else{this.player_=e}this.parentComponent_=null;this.options_=ue({},this.options_);t=this.options_=ue(this.options_,t);this.id_=t.id||t.el&&t.el.id;if(!this.id_){var n=e&&e.id&&e.id()||"no_player";this.id_=n+"_component_"+Y()}this.name_=t.name||null;if(t.el){this.el_=t.el}else if(!1!==t.createEl){this.el_=this.createEl()}if(!1!==t.evented){oe(this,{eventBusKey:this.el_?"el_":null})}de(this,this.constructor.defaultState);this.children_=[];this.childIndex_={};this.childNameIndex_={};if(!1!==t.initChildren){this.initChildren()}this.ready(a);if(!1!==t.reportTouchActivity){this.enableTouchActivity()}}var a=t.prototype;a.dispose=function(){this.trigger({type:"dispose",bubbles:!1});if(this.children_){for(var e=this.children_.length-1;0<=e;e--){if(this.children_[e].dispose){this.children_[e].dispose()}}}this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.parentComponent_=null;if(this.el_){if(this.el_.parentNode){this.el_.parentNode.removeChild(this.el_)}J(this.el_);this.el_=null}this.player_=null};a.player=function(){return this.player_};a.options=function(e){Et.warn("this.options() has been deprecated and will be moved to the constructor in 6.0");if(!e){return this.options_}this.options_=ue(this.options_,e);return this.options_};a.el=function(){return this.el_};a.createEl=function(e,t,a){return E(e,t,a)};a.localize=function(e,t,a){if(void 0===a){a=e}var n=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),i=r&&r[n],s=n&&n.split("-")[0],o=r&&r[s],d=a;if(i&&i[e]){d=i[e]}else if(o&&o[e]){d=o[e]}if(t){d=d.replace(/\{(\d+)\}/g,function(e,a){var n=t[a-1],r=n;if("undefined"==typeof n){r=e}return r})}return d};a.contentEl=function(){return this.contentEl_||this.el_};a.id=function(){return this.id_};a.name=function(){return this.name_};a.children=function(){return this.children_};a.getChildById=function(e){return this.childIndex_[e]};a.getChild=function(e){if(!e){return}e=le(e);return this.childNameIndex_[e]};a.addChild=function(e,a,n){if(void 0===a){a={}}if(void 0===n){n=this.children_.length}var r,i;if("string"==typeof e){i=le(e);var s=a.componentClass||i;a.name=i;var o=t.getComponent(s);if(!o){throw new Error("Component "+s+" does not exist")}if("function"!=typeof o){return null}r=new o(this.player_||this,a)}else{r=e}if(r.parentComponent_){r.parentComponent_.removeChild(r)}this.children_.splice(n,0,r);r.parentComponent_=this;if("function"==typeof r.id){this.childIndex_[r.id()]=r}i=i||r.name&&le(r.name());if(i){this.childNameIndex_[i]=r}if("function"==typeof r.el&&r.el()){var d=this.contentEl().children,l=d[n]||null;this.contentEl().insertBefore(r.el(),l)}return r};a.removeChild=function(e){if("string"==typeof e){e=this.getChild(e)}if(!e||!this.children_){return}for(var t=!1,a=this.children_.length-1;0<=a;a--){if(this.children_[a]===e){t=!0;this.children_.splice(a,1);break}}if(!t){return}e.parentComponent_=null;this.childIndex_[e.id()]=null;this.childNameIndex_[e.name()]=null;var n=e.el();if(n&&n.parentNode===this.contentEl()){this.contentEl().removeChild(e.el())}};a.initChildren=function(){var e=this,a=this.options_.children;if(a){var n=this.options_,r=function(t){var a=t.name,r=t.opts;if(n[a]!==void 0){r=n[a]}if(!1===r){return}if(!0===r){r={}}r.playerOptions=e.options_.playerOptions;var i=e.addChild(a,r);if(i){e[a]=i}},i,s=t.getComponent("Tech");if(Array.isArray(a)){i=a}else{i=Object.keys(a)}i.concat(Object.keys(this.options_).filter(function(e){return!i.some(function(t){if("string"==typeof t){return e===t}return e===t.name})})).map(function(t){var n,r;if("string"==typeof t){n=t;r=a[n]||e.options_[n]||{}}else{n=t.name;r=t}return{name:n,opts:r}}).filter(function(e){var a=t.getComponent(e.opts.componentClass||le(e.name));return a&&!s.isTech(a)}).forEach(r)}};a.buildCSSClass=function(){return""};a.ready=function(e,t){if(void 0===t){t=!1}if(!e){return}if(!this.isReady_){this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(e);return}if(t){e.call(this)}else{this.setTimeout(e,1)}};a.triggerReady=function(){this.isReady_=!0;this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[];if(e&&0<e.length){e.forEach(function(e){e.call(this)},this)}this.trigger("ready")},1)};a.$=function(e,t){return Dt(e,t||this.contentEl())};a.$$=function(e,t){return $(e,t||this.contentEl())};a.hasClass=function(e){return P(this.el_,e)};a.addClass=function(e){x(this.el_,e)};a.removeClass=function(e){D(this.el_,e)};a.toggleClass=function(e,t){A(this.el_,e,t)};a.show=function(){this.removeClass("vjs-hidden")};a.hide=function(){this.addClass("vjs-hidden")};a.lockShowing=function(){this.addClass("vjs-lock-showing")};a.unlockShowing=function(){this.removeClass("vjs-lock-showing")};a.getAttribute=function(e){return U(this.el_,e)};a.setAttribute=function(e,t){R(this.el_,e,t)};a.removeAttribute=function(e){M(this.el_,e)};a.width=function(e,t){return this.dimension("width",e,t)};a.height=function(e,t){return this.dimension("height",e,t)};a.dimensions=function(e,t){this.width(e,!0);this.height(t)};a.dimension=function(e,t,a){if(t!==void 0){if(null===t||t!==t){t=0}if(-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")){this.el_.style[e]=t}else if("auto"===t){this.el_.style[e]=""}else{this.el_.style[e]=t+"px"}if(!a){this.trigger("componentresize")}return}if(!this.el_){return 0}var n=this.el_.style[e],r=n.indexOf("px");if(-1!==r){return parseInt(n.slice(0,r),10)}return parseInt(this.el_["offset"+le(e)],10)};a.currentDimension=function(t){var a=0;if("width"!==t&&"height"!==t){throw new Error("currentDimension only accepts width or height value")}if("function"==typeof e.getComputedStyle){var n=e.getComputedStyle(this.el_);a=n.getPropertyValue(t)||n[t]}a=parseFloat(a);if(0===a){var r="offset"+le(t);a=this.el_[r]}return a};a.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}};a.currentWidth=function(){return this.currentDimension("width")};a.currentHeight=function(){return this.currentDimension("height")};a.focus=function(){this.el_.focus()};a.blur=function(){this.el_.blur()};a.handleKeyDown=function(e){if(this.player_){e.stopPropagation();this.player_.handleKeyDown(e)}};a.handleKeyPress=function(e){this.handleKeyDown(e)};a.emitTapEvents=function(){var e=0,t=null,a;this.on("touchstart",function(n){if(1===n.touches.length){t={pageX:n.touches[0].pageX,pageY:n.touches[0].pageY};e=new Date().getTime();a=!0}});this.on("touchmove",function(e){if(1<e.touches.length){a=!1}else if(t){var n=e.touches[0].pageX-t.pageX,r=e.touches[0].pageY-t.pageY,i=Math.sqrt(n*n+r*r);if(i>10){a=!1}}});var n=function(){a=!1};this.on("touchleave",n);this.on("touchcancel",n);this.on("touchend",function(n){t=null;if(!0===a){var r=new Date().getTime()-e;if(r<200){n.preventDefault();this.trigger("tap")}}})};a.enableTouchActivity=function(){if(!this.player()||!this.player().reportUserActivity){return}var e=qt(this.player(),this.player().reportUserActivity),t;this.on("touchstart",function(){e();this.clearInterval(t);t=this.setInterval(e,250)});var a=function(){e();this.clearInterval(t)};this.on("touchmove",e);this.on("touchend",a);this.on("touchcancel",a)};a.setTimeout=function(t,a){var n=this,r,i;t=qt(this,t);r=e.setTimeout(function(){n.off("dispose",i);t()},a);i=function(){return n.clearTimeout(r)};i.guid="vjs-timeout-"+r;this.on("dispose",i);return r};a.clearTimeout=function(t){e.clearTimeout(t);var a=function(){};a.guid="vjs-timeout-"+t;this.off("dispose",a);return t};a.setInterval=function(t,a){var n=this;t=qt(this,t);var r=e.setInterval(t,a),i=function(){return n.clearInterval(r)};i.guid="vjs-interval-"+r;this.on("dispose",i);return r};a.clearInterval=function(t){e.clearInterval(t);var a=function(){};a.guid="vjs-interval-"+t;this.off("dispose",a);return t};a.requestAnimationFrame=function(t){var a=this,n,r;if(this.supportsRaf_){t=qt(this,t);n=e.requestAnimationFrame(function(){a.off("dispose",r);t()});r=function(){return a.cancelAnimationFrame(n)};r.guid="vjs-raf-"+n;this.on("dispose",r);return n}return this.setTimeout(t,1e3/60)};a.cancelAnimationFrame=function(t){if(this.supportsRaf_){e.cancelAnimationFrame(t);var a=function(){};a.guid="vjs-raf-"+t;this.off("dispose",a);return t}return this.clearTimeout(t)};t.registerComponent=function(e,a){if("string"!=typeof e||!e){throw new Error("Illegal component name, \""+e+"\"; must be a non-empty string.")}var n=t.getComponent("Tech"),r=n&&n.isTech(a),i=t===a||t.prototype.isPrototypeOf(a.prototype);if(r||!i){var s;if(r){s="techs must be registered using Tech.registerTech()"}else{s="must be a Component subclass"}throw new Error("Illegal component, \""+e+"\"; "+s+".")}e=le(e);if(!t.components_){t.components_={}}var o=t.getComponent("Player");if("Player"===e&&o&&o.players){var d=o.players,l=Object.keys(d);if(d&&0<l.length&&l.map(function(e){return d[e]}).every(Boolean)){throw new Error("Can not register Player component after player has been created.")}}t.components_[e]=a;return a};t.getComponent=function(e){if(!e){return}e=le(e);if(t.components_&&t.components_[e]){return t.components_[e]}};return t}();ra.prototype.supportsRaf_="function"==typeof e.requestAnimationFrame&&"function"==typeof e.cancelAnimationFrame;ra.registerComponent("Component",ra);var ia=e.navigator&&e.navigator.userAgent||"",sa=/AppleWebKit\/([\d.]+)/i.exec(ia),oa=sa?parseFloat(sa.pop()):null,da=/iPad/i.test(ia),la=/iPhone/i.test(ia)&&!da,pa=/iPod/i.test(ia),ua=la||da||pa,ca=function(){var e=ia.match(/OS (\d+)_/i);if(e&&e[1]){return e[1]}return null}(),ma=/Android/i.test(ia),ga=function(){var e=ia.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e){return null}var t=e[1]&&parseFloat(e[1]),a=e[2]&&parseFloat(e[2]);if(t&&a){return parseFloat(e[1]+"."+e[2])}else if(t){return t}return null}(),ha=ma&&5>ga&&537>oa,ya=/Firefox/i.test(ia),_a=/Edge/i.test(ia),fa=!_a&&(/Chrome/i.test(ia)||/CriOS/i.test(ia)),ba=function(){var e=ia.match(/(Chrome|CriOS)\/(\d+)/);if(e&&e[2]){return parseFloat(e[2])}return null}(),Ta=function(){var e=/MSIE\s(\d+)\.\d/.exec(ia),t=e&&parseFloat(e[1]);return"7.5.5"}(),va=/Safari/i.test(ia)&&!fa&&!ma&&!_a,Sa=(va||ua)&&!fa,ka=v()&&("ontouchstart"in e||e.navigator.maxTouchPoints||e.DocumentTouch&&e.document instanceof e.DocumentTouch),Ca=Object.freeze({IS_IPAD:da,IS_IPHONE:la,IS_IPOD:pa,IS_IOS:ua,IOS_VERSION:ca,IS_ANDROID:ma,ANDROID_VERSION:ga,IS_NATIVE_ANDROID:ha,IS_FIREFOX:ya,IS_EDGE:_a,IS_CHROME:fa,CHROME_VERSION:ba,IE_VERSION:Ta,IS_SAFARI:va,IS_ANY_SAFARI:Sa,TOUCH_ENABLED:ka});function ce(e,t,a){if("number"!=typeof t||0>t||t>a){throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+a+").")}}function me(e,t,a,n){ce(e,n,a.length-1);return a[n][t]}function ge(e){if(e===void 0||0===e.length){return{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}}return{length:e.length,start:me.bind(null,"start",0,e),end:me.bind(null,"end",1,e)}}function he(e,t){if(Array.isArray(e)){return ge(e)}else if(e===void 0||t===void 0){return ge()}return ge([[e,t]])}function ye(e,t){var a=0,n,r;if(!t){return 0}if(!e||!e.length){e=he(0,0)}for(var s=0;s<e.length;s++){n=e.start(s);r=e.end(s);if(r>t){r=t}a+=r-n}return a/t}for(var Ea={},La=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Ia=La[0],Pa,xa=!1,Da=0;Da<La.length;Da++){if(La[Da][1]in t){Pa=La[Da];break}}if(Pa){for(var Aa=0;Aa<Pa.length;Aa++){Ea[Ia[Aa]]=Pa[Aa]}xa=Pa[0]===Ia[0]}function _e(e){if(e instanceof _e){return e}if("number"==typeof e){this.code=e}else if("string"==typeof e){this.message=e}else if(g(e)){if("number"==typeof e.code){this.code=e.code}m(this,e)}if(!this.message){this.message=_e.defaultMessages[this.code]||""}}_e.prototype.code=0;_e.prototype.message="";_e.prototype.status=null;_e.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];_e.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var wa=0;wa<_e.errorTypes.length;wa++){_e[_e.errorTypes[wa]]=wa;_e.prototype[_e.errorTypes[wa]]=wa}var Oa=function(e,t){var a,n=null;try{a=JSON.parse(e,t)}catch(e){n=e}return[n,a]};function fe(e){return e!==void 0&&null!==e&&"function"==typeof e.then}function be(e){if(fe(e)){e.then(null,function(){})}}var Ua=function(e){var t=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(t,a){if(e[a]){t[a]=e[a]}return t},{cues:e.cues&&Array.prototype.map.call(e.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})});return t},Ra={textTracksToJson:function(e){var t=e.$$("track"),a=Array.prototype.map.call(t,function(e){return e.track}),n=Array.prototype.map.call(t,function(e){var t=Ua(e.track);if(e.src){t.src=e.src}return t});return n.concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===a.indexOf(e)}).map(Ua))},jsonToTextTracks:function(e,t){e.forEach(function(e){var a=t.addRemoteTextTrack(e).track;if(!e.src&&e.cues){e.cues.forEach(function(e){return a.addCue(e)})}});return t.textTracks()},trackToJson_:Ua},Ma="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Te(e,t){return t={exports:{}},e(t,t.exports),t.exports}var Ba=Te(function(e,t){function a(e){if(e&&"object"===_typeof(e)){var t=e.which||e.keyCode||e.charCode;if(t)e=t}if("number"==typeof e)return o[e];var a=e+"",i=n[a.toLowerCase()];if(i)return i;var i=r[a.toLowerCase()];if(i)return i;if(1===a.length)return a.charCodeAt(0)}a.isEventKey=function(e,t){if(e&&"object"===_typeof(e)){var a=e.which||e.keyCode||e.charCode;if(null===a||a===void 0){return!1}if("string"==typeof t){var i=n[t.toLowerCase()];if(i){return i===a}var i=r[t.toLowerCase()];if(i){return i===a}}else if("number"==typeof t){return t===a}return!1}};t=e.exports=a;var n=t.code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},r=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(s=97;123>s;s++){n[String.fromCharCode(s)]=s-32}for(var s=48;58>s;s++){n[s-48]=s}for(s=1;13>s;s++){n["f"+s]=s+111}for(s=0;10>s;s++){n["numpad "+s]=s+96}var o=t.names=t.title={};for(s in n){o[n[s]]=s}for(var d in r){n[d]=r[d]}}),Na=Ba.code,ja=Ba.codes,Fa=Ba.aliases,Ha=Ba.names,Va=Ba.title,qa="vjs-modal-dialog",za=function(n){a(r,n);function r(e,t){var a=n.call(this,e,t)||this;a.opened_=a.hasBeenOpened_=a.hasBeenFilled_=!1;a.closeable(!a.options_.uncloseable);a.content(a.options_.content);a.contentEl_=E("div",{className:qa+"-content"},{role:"document"});a.descEl_=E("p",{className:qa+"-description vjs-control-text",id:a.el().getAttribute("aria-describedby")});L(a.descEl_,a.description());a.el_.appendChild(a.descEl_);a.el_.appendChild(a.contentEl_);return a}var i=r.prototype;i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})};i.dispose=function(){this.contentEl_=null;this.descEl_=null;this.previouslyActiveEl_=null;n.prototype.dispose.call(this)};i.buildCSSClass=function(){return qa+" vjs-hidden "+n.prototype.buildCSSClass.call(this)};i.label=function(){return this.localize(this.options_.label||"Modal Window")};i.description=function(){var e=this.options_.description||this.localize("This is a modal window.");if(this.closeable()){e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")}return e};i.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen");this.opened_=!0;if(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_){this.fill()}this.wasPlaying_=!e.paused();if(this.options_.pauseOnOpen&&this.wasPlaying_){e.pause()}this.on("keydown",this.handleKeyDown);this.hadControls_=e.controls();e.controls(!1);this.show();this.conditionalFocus_();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=!0}};i.opened=function(e){if("boolean"==typeof e){this[e?"open":"close"]()}return this.opened_};i.close=function(){if(!this.opened_){return}var e=this.player();this.trigger("beforemodalclose");this.opened_=!1;if(this.wasPlaying_&&this.options_.pauseOnOpen){e.play()}this.off("keydown",this.handleKeyDown);if(this.hadControls_){e.controls(!0)}this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");this.conditionalBlur_();if(this.options_.temporary){this.dispose()}};i.closeable=function e(t){if("boolean"==typeof t){var e=this.closeable_=!!t,a=this.getChild("closeButton");if(e&&!a){var n=this.contentEl_;this.contentEl_=this.el_;a=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=n;this.on(a,"close",this.close)}if(!e&&a){this.off(a,"close",this.close);this.removeChild(a);a.dispose()}}return this.closeable_};i.fill=function(){this.fillWith(this.content())};i.fillWith=function(e){var t=this.contentEl(),a=t.parentNode,n=t.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=!0;a.removeChild(t);this.empty();W(t,e);this.trigger("modalfill");if(n){a.insertBefore(t,n)}else{a.appendChild(t)}var r=this.getChild("closeButton");if(r){a.appendChild(r.el_)}};i.empty=function(){this.trigger("beforemodalempty");q(this.contentEl());this.trigger("modalempty")};i.content=function(e){if("undefined"!=typeof e){this.content_=e}return this.content_};i.conditionalFocus_=function(){var e=t.activeElement,a=this.player_.el_;this.previouslyActiveEl_=null;if(a.contains(e)||a===e){this.previouslyActiveEl_=e;this.focus()}};i.conditionalBlur_=function(){if(this.previouslyActiveEl_){this.previouslyActiveEl_.focus();this.previouslyActiveEl_=null}};i.handleKeyDown=function(e){e.stopPropagation();if(Ba.isEventKey(e,"Escape")&&this.closeable()){e.preventDefault();this.close();return}if(!Ba.isEventKey(e,"Tab")){return}for(var a=this.focusableEls_(),n=this.el_.querySelector(":focus"),r,s=0;s<a.length;s++){if(n===a[s]){r=s;break}}if(t.activeElement===this.el_){r=0}if(e.shiftKey&&0===r){a[a.length-1].focus();e.preventDefault()}else if(!e.shiftKey&&r===a.length-1){a[0].focus();e.preventDefault()}};i.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(t){return(t instanceof e.HTMLAnchorElement||t instanceof e.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof e.HTMLInputElement||t instanceof e.HTMLSelectElement||t instanceof e.HTMLTextAreaElement||t instanceof e.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof e.HTMLIFrameElement||t instanceof e.HTMLObjectElement||t instanceof e.HTMLEmbedElement||t.hasAttribute("tabindex")&&-1!==t.getAttribute("tabindex")||t.hasAttribute("contenteditable")})};return r}(ra);za.prototype.options_={pauseOnOpen:!0,temporary:!0};ra.registerComponent("ModalDialog",za);var Ga=function(e){a(t,e);function t(t){var a;if(void 0===t){t=[]}a=e.call(this)||this;a.tracks_=[];Object.defineProperty(o(o(a)),"length",{get:function(){return this.tracks_.length}});for(var n=0;n<t.length;n++){a.addTrack(t[n])}return a}var n=t.prototype;n.addTrack=function(e){var t=this.tracks_.length;if(!(""+t in this)){Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}})}if(-1===this.tracks_.indexOf(e)){this.tracks_.push(e);this.trigger({track:e,type:"addtrack",target:this})}};n.removeTrack=function(e){for(var t,a=0,n=this.length;a<n;a++){if(this[a]===e){t=this[a];if(t.off){t.off()}this.tracks_.splice(a,1);break}}if(!t){return}this.trigger({track:t,type:"removetrack",target:this})};n.getTrackById=function(e){for(var t=null,a=0,n=this.length,r;a<n;a++){r=this[a];if(r.id===e){t=r;break}}return t};return t}(Wt);Ga.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var Wa in Ga.prototype.allowedEvents_){Ga.prototype["on"+Wa]=null}var Ka=function(e,t){for(var a=0;a<e.length;a++){if(!Object.keys(e[a]).length||t.id===e[a].id){continue}e[a].enabled=!1}},Ya=function(e){a(t,e);function t(t){var a;if(void 0===t){t=[]}for(var n=t.length-1;0<=n;n--){if(t[n].enabled){Ka(t,t[n]);break}}a=e.call(this,t)||this;a.changing_=!1;return a}var n=t.prototype;n.addTrack=function(t){var a=this;if(t.enabled){Ka(this,t)}e.prototype.addTrack.call(this,t);if(!t.addEventListener){return}t.enabledChange_=function(){if(a.changing_){return}a.changing_=!0;Ka(a,t);a.changing_=!1;a.trigger("change")};t.addEventListener("enabledchange",t.enabledChange_)};n.removeTrack=function(t){e.prototype.removeTrack.call(this,t);if(t.removeEventListener&&t.enabledChange_){t.removeEventListener("enabledchange",t.enabledChange_);t.enabledChange_=null}};return t}(Ga),Xa=function(e,t){for(var a=0;a<e.length;a++){if(!Object.keys(e[a]).length||t.id===e[a].id){continue}e[a].selected=!1}},$a=function(e){a(t,e);function t(t){var a;if(void 0===t){t=[]}for(var n=t.length-1;0<=n;n--){if(t[n].selected){Xa(t,t[n]);break}}a=e.call(this,t)||this;a.changing_=!1;Object.defineProperty(o(o(a)),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++){if(this[e].selected){return e}}return-1},set:function(){}});return a}var n=t.prototype;n.addTrack=function(t){var a=this;if(t.selected){Xa(this,t)}e.prototype.addTrack.call(this,t);if(!t.addEventListener){return}t.selectedChange_=function(){if(a.changing_){return}a.changing_=!0;Xa(a,t);a.changing_=!1;a.trigger("change")};t.addEventListener("selectedchange",t.selectedChange_)};n.removeTrack=function(t){e.prototype.removeTrack.call(this,t);if(t.removeEventListener&&t.selectedChange_){t.removeEventListener("selectedchange",t.selectedChange_);t.selectedChange_=null}};return t}(Ga),Qa=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.addTrack=function(t){var a=this;e.prototype.addTrack.call(this,t);if(!this.queueChange_){this.queueChange_=function(){return a.queueTrigger("change")}}if(!this.triggerSelectedlanguagechange){this.triggerSelectedlanguagechange_=function(){return a.trigger("selectedlanguagechange")}}t.addEventListener("modechange",this.queueChange_);if(-1===["metadata","chapters"].indexOf(t.kind)){t.addEventListener("modechange",this.triggerSelectedlanguagechange_)}};n.removeTrack=function(t){e.prototype.removeTrack.call(this,t);if(t.removeEventListener){if(this.queueChange_){t.removeEventListener("modechange",this.queueChange_)}if(this.selectedlanguagechange_){t.removeEventListener("modechange",this.triggerSelectedlanguagechange_)}}};return t}(Ga),Ja=function(){function e(e){if(void 0===e){e=[]}this.trackElements_=[];Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,a=e.length;t<a;t++){this.addTrackElement_(e[t])}}var t=e.prototype;t.addTrackElement_=function(e){var t=this.trackElements_.length;if(!(""+t in this)){Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}})}if(-1===this.trackElements_.indexOf(e)){this.trackElements_.push(e)}};t.getTrackElementByTrack_=function(e){for(var t,a=0,n=this.trackElements_.length;a<n;a++){if(e===this.trackElements_[a].track){t=this.trackElements_[a];break}}return t};t.removeTrackElement_=function(e){for(var t=0,a=this.trackElements_.length;t<a;t++){if(e===this.trackElements_[t]){if(this.trackElements_[t].track&&"function"==typeof this.trackElements_[t].track.off){this.trackElements_[t].track.off()}if("function"==typeof this.trackElements_[t].off){this.trackElements_[t].off()}this.trackElements_.splice(t,1);break}}};return e}(),Za=function(){function e(t){e.prototype.setCues_.call(this,t);Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;t.setCues_=function(e){var t=this.length||0,a=0,n=e.length;this.cues_=e;this.length_=e.length;var r=function(e){if(!(""+e in this)){Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})}};if(t<n){a=t;for(;a<n;a++){r.call(this,a)}}};t.getCueById=function(e){for(var t=null,a=0,n=this.length,r;a<n;a++){r=this[a];if(r.id===e){t=r;break}}return t};return e}(),en={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},tn={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},an={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},nn={disabled:"disabled",hidden:"hidden",showing:"showing"},rn=function(e){a(t,e);function t(t){var a;if(void 0===t){t={}}a=e.call(this)||this;var n={id:t.id||"vjs_track_"+Y(),kind:t.kind||"",label:t.label||"",language:t.language||""},r=function(e){Object.defineProperty(o(o(a)),e,{get:function(){return n[e]},set:function(){}})};for(var i in n){r(i)}return a}return t}(Wt),sn=function(n){var r=["protocol","hostname","port","pathname","search","hash","host"],s=t.createElement("a");s.href=n;var o=""===s.host&&"file:"!==s.protocol,d;if(o){d=t.createElement("div");d.innerHTML="<a href=\""+n+"\"></a>";s=d.firstChild;d.setAttribute("style","display:none; position:absolute;");t.body.appendChild(d)}for(var l={},p=0;p<r.length;p++){l[r[p]]=s[r[p]]}if("http:"===l.protocol){l.host=l.host.replace(/:80$/,"")}if("https:"===l.protocol){l.host=l.host.replace(/:443$/,"")}if(!l.protocol){l.protocol=e.location.protocol}if(o){t.body.removeChild(d)}return l},on=function(e){if(!e.match(/^https?:\/\//)){var a=t.createElement("div");a.innerHTML="<a href=\""+e+"\">x</a>";e=a.firstChild.href}return e},dn=function(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i,a=t.exec(e);if(a){return a.pop().toLowerCase()}}return""},ln=function(t){var a=e.location,n=sn(t),r=":"===n.protocol?a.protocol:n.protocol,i=r+n.host!==a.protocol+a.host;return i},pn=Object.freeze({parseUrl:sn,getAbsoluteURL:on,getFileExtension:dn,isCrossOrigin:ln}),un=function(e){var t=cn.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},cn=Object.prototype.toString;var mn=Te(function(e,t){t=e.exports=function(e){return e.replace(/^\s*|\s*$/g,"")};t.left=function(e){return e.replace(/^\s*/,"")};t.right=function(e){return e.replace(/\s*$/,"")}}),gn=mn.left,hn=mn.right,yn=Function.prototype.toString,_n=/^\s*class\b/,fn=function(e){try{var t=yn.call(e);return _n.test(t)}catch(t){return!1}},bn=function(e){try{if(fn(e)){return!1}yn.call(e);return!0}catch(t){return!1}},Tn=Object.prototype.toString,vn="function"==typeof Symbol&&"symbol"===_typeof(Symbol.toStringTag),Sn=function(e){if(!e){return!1}if("function"!=typeof e&&"object"!==_typeof(e)){return!1}if("function"==typeof e&&!e.prototype){return!0}if(vn){return bn(e)}if(fn(e)){return!1}var t=Tn.call(e);return t==="[object Function]"||t==="[object GeneratorFunction]"},kn=Object.prototype.toString,Cn=Object.prototype.hasOwnProperty,En=function(e,t,a){for(var n=0,r=e.length;n<r;n++){if(Cn.call(e,n)){if(null==a){t(e[n],n,e)}else{t.call(a,e[n],n,e)}}}},Ln=function(e,t,a){for(var n=0,r=e.length;n<r;n++){if(null==a){t(e.charAt(n),n,e)}else{t.call(a,e.charAt(n),n,e)}}},In=function(e,t,a){for(var n in e){if(Cn.call(e,n)){if(null==a){t(e[n],n,e)}else{t.call(a,e[n],n,e)}}}},Pn=function(e,t,a){if(!Sn(t)){throw new TypeError("iterator must be a function")}var n;if(3<=arguments.length){n=a}if("[object Array]"===kn.call(e)){En(e,t,n)}else if("string"==typeof e){Ln(e,t,n)}else{In(e,t,n)}},xn=function(e){return"[object Array]"===Object.prototype.toString.call(e)},Dn=function(e){if(!e)return{};var t={};Pn(mn(e).split("\n"),function(e){var a=e.indexOf(":"),n=mn(e.slice(0,a)).toLowerCase(),r=mn(e.slice(a+1));if("undefined"==typeof t[n]){t[n]=r}else if(xn(t[n])){t[n].push(r)}else{t[n]=[t[n],r]}});return t},An=Object.prototype.hasOwnProperty;function ve(){for(var e={},t=0,a;t<arguments.length;t++){a=arguments[t];for(var n in a){if(An.call(a,n)){e[n]=a[n]}}}return e}var wn=Ee;Ee.XMLHttpRequest=e.XMLHttpRequest||function(){};Ee.XDomainRequest="withCredentials"in new Ee.XMLHttpRequest?Ee.XMLHttpRequest:e.XDomainRequest;Se(["get","put","post","patch","head","delete"],function(e){Ee["delete"===e?"del":e]=function(t,a,n){a=Ce(t,a,n);a.method=e.toUpperCase();return Le(a)}});function Se(e,t){for(var a=0;a<e.length;a++){t(e[a])}}function ke(e){for(var t in e){if(e.hasOwnProperty(t))return!1}return!0}function Ce(e,t,a){var n=e;if(un(t)){a=t;if("string"==typeof e){n={uri:e}}}else{n=ve(t,{uri:e})}n.callback=a;return n}function Ee(e,t,a){t=Ce(e,t,a);return Le(t)}function Le(e){if("undefined"==typeof e.callback){throw new Error("callback argument missing")}var i=!1,s=function(t,a,n){if(!i){i=!0;e.callback(t,a,n)}};function t(){if(4===o.readyState){setTimeout(r,0)}}function a(){var e;if(o.response){e=o.response}else{e=o.responseText||Ie(o)}if(h){try{e=JSON.parse(e)}catch(t){}}return e}function n(e){clearTimeout(y);if(!(e instanceof Error)){e=new Error(""+(e||"Unknown XMLHttpRequest Error"))}e.statusCode=0;return s(e,_)}function r(){if(l)return;var t;clearTimeout(y);if(e.useXDR&&o.status===void 0){t=200}else{t=1223===o.status?204:o.status}var n=_,r=null;if(0!==t){n={body:a(),statusCode:t,method:u,headers:{},url:p,rawRequest:o};if(o.getAllResponseHeaders){n.headers=Dn(o.getAllResponseHeaders())}}else{r=new Error("Internal XMLHttpRequest Error")}return s(r,n,n.body)}var o=e.xhr||null;if(!o){if(e.cors||e.useXDR){o=new Ee.XDomainRequest}else{o=new Ee.XMLHttpRequest}}var d,l,p=o.url=e.uri||e.url,u=o.method=e.method||"GET",c=e.body||e.data,m=o.headers=e.headers||{},g=!!e.sync,h=!1,y,_={body:void 0,headers:{},statusCode:0,method:u,url:p,rawRequest:o};if("json"in e&&!1!==e.json){h=!0;m.accept||m.Accept||(m.Accept="application/json");if("GET"!==u&&"HEAD"!==u){m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json");c=JSON.stringify(!0===e.json?c:e.json)}}o.onreadystatechange=t;o.onload=r;o.onerror=n;o.onprogress=function(){};o.onabort=function(){l=!0};o.ontimeout=n;o.open(u,p,!g,e.username,e.password);if(!g){o.withCredentials=!!e.withCredentials}if(!g&&0<e.timeout){y=setTimeout(function(){if(l)return;l=!0;o.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT";n(t)},e.timeout)}if(o.setRequestHeader){for(d in m){if(m.hasOwnProperty(d)){o.setRequestHeader(d,m[d])}}}else if(e.headers&&!ke(e.headers)){throw new Error("Headers cannot be set on an XDomainRequest object")}if("responseType"in e){o.responseType=e.responseType}if("beforeSend"in e&&"function"==typeof e.beforeSend){e.beforeSend(o)}o.send(c||null);return o}function Ie(e){if("document"===e.responseType){return e.responseXML}var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t){return e.responseXML}return null}var On=function(t,a){var n=new e.WebVTT.Parser(e,e.vttjs,e.WebVTT.StringDecoder()),r=[];n.oncue=function(e){a.addCue(e)};n.onparsingerror=function(e){r.push(e)};n.onflush=function(){a.trigger({type:"loadeddata",target:a})};n.parse(t);if(0<r.length){if(e.console&&e.console.groupCollapsed){e.console.groupCollapsed("Text Track parsing errors for "+a.src)}r.forEach(function(e){return Et.error(e)});if(e.console&&e.console.groupEnd){e.console.groupEnd()}}n.flush()},Un=function(t,a){var n={uri:t},r=ln(t);if(r){n.cors=r}wn(n,qt(this,function(t,n,r){if(t){return Et.error(t,n)}a.loaded_=!0;if("function"!=typeof e.WebVTT){if(a.tech_){var i,s=function(){Et.error("vttjs failed to load, stopping trying to process "+a.src);a.tech_.off("vttjsloaded",i)};i=function(){a.tech_.off("vttjserror",s);return On(r,a)};a.tech_.one("vttjsloaded",i);a.tech_.one("vttjserror",s)}}else{On(r,a)}}))},Rn=function(t){a(n,t);function n(e){var a;if(void 0===e){e={}}if(!e.tech){throw new Error("A tech was not provided.")}var n=ue(e,{kind:an[e.kind]||"subtitles",language:e.language||e.srclang||""}),r=nn[n.mode]||"disabled",i=n.default;if("metadata"===n.kind||"chapters"===n.kind){r="hidden"}a=t.call(this,n)||this;a.tech_=n.tech;a.cues_=[];a.activeCues_=[];var s=new Za(a.cues_),d=new Za(a.activeCues_),p=!1,u=qt(o(o(a)),function(){this.activeCues=this.activeCues;if(p){this.trigger("cuechange");p=!1}});if("disabled"!==r){a.tech_.ready(function(){a.tech_.on("timeupdate",u)},!0)}Object.defineProperties(o(o(a)),{default:{get:function(){return i},set:function(){}},mode:{get:function(){return r},set:function(e){var t=this;if(!nn[e]){return}r=e;if("disabled"!==r){this.tech_.ready(function(){t.tech_.on("timeupdate",u)},!0)}else{this.tech_.off("timeupdate",u)}this.trigger("modechange")}},cues:{get:function(){if(!this.loaded_){return null}return s},set:function(){}},activeCues:{get:function(){if(!this.loaded_){return null}if(0===this.cues.length){return d}for(var e=this.tech_.currentTime(),t=[],a=0,n=this.cues.length,r;a<n;a++){r=this.cues[a];if(r.startTime<=e&&r.endTime>=e){t.push(r)}else if(r.startTime===r.endTime&&r.startTime<=e&&r.startTime+.5>=e){t.push(r)}}p=!1;if(t.length!==this.activeCues_.length){p=!0}else{for(var s=0;s<t.length;s++){if(-1===this.activeCues_.indexOf(t[s])){p=!0}}}this.activeCues_=t;d.setCues_(this.activeCues_);return d},set:function(){}}});if(n.src){a.src=n.src;Un(n.src,o(o(a)))}else{a.loaded_=!0}return a}var r=n.prototype;r.addCue=function(t){var a=t;if(e.vttjs&&!(t instanceof e.vttjs.VTTCue)){a=new e.vttjs.VTTCue(t.startTime,t.endTime,t.text);for(var n in t){if(!(n in a)){a[n]=t[n]}}a.id=t.id;a.originalCue_=t}for(var r=this.tech_.textTracks(),s=0;s<r.length;s++){if(r[s]!==this){r[s].removeCue(a)}}this.cues_.push(a);this.cues.setCues_(this.cues_)};r.removeCue=function(e){var t=this.cues_.length;while(t--){var a=this.cues_[t];if(a===e||a.originalCue_&&a.originalCue_===e){this.cues_.splice(t,1);this.cues.setCues_(this.cues_);break}}};return n}(rn);Rn.prototype.allowedEvents_={cuechange:"cuechange"};var Mn=function(e){a(t,e);function t(t){var a;if(void 0===t){t={}}var n=ue(t,{kind:tn[t.kind]||""});a=e.call(this,n)||this;var r=!1;Object.defineProperty(o(o(a)),"enabled",{get:function(){return r},set:function(e){if("boolean"!=typeof e||e===r){return}r=e;this.trigger("enabledchange")}});if(n.enabled){a.enabled=n.enabled}a.loaded_=!0;return a}return t}(rn),Bn=function(e){a(t,e);function t(t){var a;if(void 0===t){t={}}var n=ue(t,{kind:en[t.kind]||""});a=e.call(this,n)||this;var r=!1;Object.defineProperty(o(o(a)),"selected",{get:function(){return r},set:function(e){if("boolean"!=typeof e||e===r){return}r=e;this.trigger("selectedchange")}});if(n.selected){a.selected=n.selected}return a}return t}(rn),Nn=0,jn=2,Fn=function(e){a(t,e);function t(t){var a;if(void 0===t){t={}}a=e.call(this)||this;var n,r=new Rn(t);a.kind=r.kind;a.src=r.src;a.srclang=r.language;a.label=r.label;a.default=r.default;Object.defineProperties(o(o(a)),{readyState:{get:function(){return n}},track:{get:function(){return r}}});n=Nn;r.addEventListener("loadeddata",function(){n=jn;a.trigger({type:"load",target:o(o(a))})});return a}return t}(Wt);Fn.prototype.allowedEvents_={load:"load"};Fn.NONE=Nn;Fn.LOADING=1;Fn.LOADED=jn;Fn.ERROR=3;var Hn={audio:{ListClass:Ya,TrackClass:Mn,capitalName:"Audio"},video:{ListClass:$a,TrackClass:Bn,capitalName:"Video"},text:{ListClass:Qa,TrackClass:Rn,capitalName:"Text"}};Object.keys(Hn).forEach(function(e){Hn[e].getterName=e+"Tracks";Hn[e].privateName=e+"Tracks_"});var Vn={remoteText:{ListClass:Qa,TrackClass:Rn,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Ja,TrackClass:Fn,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},qn=ue(Hn,Vn);Vn.names=Object.keys(Vn);Hn.names=Object.keys(Hn);qn.names=[].concat(Vn.names).concat(Hn.names);var zn=Object.create||function(){function e(){}return function(t){if(1!==arguments.length){throw new Error("Object.create shim only accepts one parameter.")}e.prototype=t;return new e}}();function Pe(e,t){this.name="ParsingError";this.code=e.code;this.message=t||e.message}Pe.prototype=zn(Error.prototype);Pe.prototype.constructor=Pe;Pe.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function xe(e){function t(e,t,a,n){return 3600*(0|e)+60*(0|t)+(0|a)+(0|n)/1e3}var a=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);if(!a){return null}if(a[3]){return t(a[1],a[2],a[3].replace(":",""),a[4])}else if(59<a[1]){return t(a[1],a[2],0,a[4])}else{return t(0,a[1],a[2],a[4])}}function De(){this.values=zn(null)}De.prototype={set:function(e,t){if(!this.get(e)&&""!==t){this.values[e]=t}},get:function(e,t,a){if(a){return this.has(e)?this.values[e]:t[a]}return this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var a=0;a<r.length;++a){if(t===r[a]){this.set(e,t);break}}},integer:function(e,t){if(/^-?\d+$/.test(t)){this.set(e,parseInt(t,10))}},percent:function(e,t){var a;if(a=t.match(/^([\d]{1,3})(\.[\d]*)?%$/)){t=parseFloat(t);if(0<=t&&100>=t){this.set(e,t);return!0}}return!1}};function Ae(e,t,a,n){var r=n?e.split(n):[e];for(var s in r){if("string"!=typeof r[s]){continue}var i=r[s].split(a);if(2!==i.length){continue}var o=i[0],d=i[1];t(o,d)}}function we(e,t,a){var s=e;function n(){var t=xe(e);if(null===t){throw new Pe(Pe.Errors.BadTimeStamp,"Malformed timestamp: "+s)}e=e.replace(/^[^\sa-zA-Z-]+/,"");return t}function r(e,t){var n=new De;Ae(e,function(e,t){switch(e){case"region":for(var r=a.length-1;0<=r;r--){if(a[r].id===t){n.set(e,a[r].region);break}}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var s=t.split(","),o=s[0];n.integer(e,o);n.percent(e,o)?n.set("snapToLines",!1):null;n.alt(e,o,["auto"]);if(2===s.length){n.alt("lineAlign",s[1],["start","middle","end"])}break;case"position":s=t.split(",");n.percent(e,s[0]);if(2===s.length){n.alt("positionAlign",s[1],["start","middle","end"])}break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start","middle","end","left","right"]);break;}},/:/,/\s/);t.region=n.get("region",null);t.vertical=n.get("vertical","");t.line=n.get("line","auto");t.lineAlign=n.get("lineAlign","start");t.snapToLines=n.get("snapToLines",!0);t.size=n.get("size",100);t.align=n.get("align","middle");t.position=n.get("position",{start:0,left:0,middle:50,end:100,right:100},t.align);t.positionAlign=n.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},t.align)}function i(){e=e.replace(/^\s+/,"")}i();t.startTime=n();i();if("-->"!==e.substr(0,3)){throw new Pe(Pe.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+s)}e=e.substr(3);i();t.endTime=n();i();r(e,t)}var Gn={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"\u200E","&rlm;":"\u200F","&nbsp;":"\xA0"},Wn={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},Kn={v:"title",lang:"lang"},Yn={rt:"ruby"};function Oe(e,a){function n(){if(!a){return null}function e(e){a=a.substr(e.length);return e}var t=a.match(/^([^<]*)(<[^>]*>?)?/);return e(t[1]?t[1]:t[2])}function r(t){return Gn[t]}function i(e){while(h=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/)){e=e.replace(h[0],r)}return e}function s(e,t){return!Yn[t.localName]||Yn[t.localName]===e.localName}function o(t,a){var n=Wn[t];if(!n){return null}var r=e.document.createElement(n);r.localName=n;var i=Kn[t];if(i&&a){r[i]=a.trim()}return r}var d=e.document.createElement("div"),l=d,p,u=[];while(null!==(p=n())){if("<"===p[0]){if("/"===p[1]){if(u.length&&u[u.length-1]===p.substr(2).replace(">","")){u.pop();l=l.parentNode}continue}var c=xe(p.substr(1,p.length-2)),g;if(c){g=e.document.createProcessingInstruction("timestamp",c);l.appendChild(g);continue}var h=p.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!h){continue}g=o(h[1],h[3]);if(!g){continue}if(!s(l,g)){continue}if(h[2]){g.className=h[2].substr(1).replace("."," ")}u.push(h[1]);l.appendChild(g);l=g;continue}l.appendChild(e.document.createTextNode(i(p)))}return d}var Xn=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Ue(e){for(var t=0,a;t<Xn.length;t++){a=Xn[t];if(e>=a[0]&&e<=a[1]){return!0}}return!1}function Re(e){var n=[],r="",s;if(!e||!e.childNodes){return"ltr"}function t(e,t){for(var a=t.childNodes.length-1;0<=a;a--){e.push(t.childNodes[a])}}function a(e){if(!e||!e.length){return null}var n=e.pop(),r=n.textContent||n.innerText;if(r){var i=r.match(/^.*(\n|\r)/);if(i){e.length=0;return i[0]}return r}if("ruby"===n.tagName){return a(e)}if(n.childNodes){t(e,n);return a(e)}}t(n,e);while(r=a(n)){for(var o=0;o<r.length;o++){s=r.charCodeAt(o);if(Ue(s)){return"rtl"}}}return"ltr"}function Me(e){if("number"==typeof e.line&&(e.snapToLines||0<=e.line&&100>=e.line)){return e.line}if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement){return-1}for(var t=e.track,a=t.textTrackList,n=0,r=0;r<a.length&&a[r]!==t;r++){if("showing"===a[r].mode){n++}}return-1*++n}function Be(){}Be.prototype.applyStyles=function(e,t){t=t||this.div;for(var a in e){if(e.hasOwnProperty(a)){t.style[a]=e[a]}}};Be.prototype.formatStyle=function(e,t){return 0===e?0:e+t};function Ne(e,t,a){Be.call(this);this.cue=t;this.cueDiv=Oe(e,t.text);var n={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(n,this.cueDiv);this.div=e.document.createElement("div");n={direction:Re(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:a.font,whiteSpace:"pre-line",position:"absolute"};this.applyStyles(n);this.div.appendChild(this.cueDiv);var r=0;switch(t.positionAlign){case"start":r=t.position;break;case"middle":r=t.position-t.size/2;break;case"end":r=t.position-t.size;break;}if(""===t.vertical){this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")})}else{this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")})}this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}Ne.prototype=zn(Be.prototype);Ne.prototype.constructor=Ne;function je(e){var t,a,n,r;if(e.div){a=e.div.offsetHeight;n=e.div.offsetWidth;r=e.div.offsetTop;var i=(i=e.div.childNodes)&&(i=i[0])&&i.getClientRects&&i.getClientRects();e=e.div.getBoundingClientRect();t=i?Math.max(i[0]&&i[0].height||0,e.height/i.length):0}this.left=e.left;this.right=e.right;this.top=e.top||r;this.height=e.height||a;this.bottom=e.bottom||r+(e.height||a);this.width=e.width||n;this.lineHeight=t!==void 0?t:e.lineHeight}je.prototype.move=function(e,t){t=t!==void 0?t:this.lineHeight;switch(e){case"+x":this.left+=t;this.right+=t;break;case"-x":this.left-=t;this.right-=t;break;case"+y":this.top+=t;this.bottom+=t;break;case"-y":this.top-=t;this.bottom-=t;break;}};je.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top};je.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++){if(this.overlaps(e[t])){return!0}}return!1};je.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right};je.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom;}};je.prototype.intersectPercentage=function(e){var t=Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left)),a=Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top));return t*a/(this.height*this.width)};je.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}};je.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,a=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,n=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e;var r={left:e.left,right:e.right,top:e.top||n,height:e.height||t,bottom:e.bottom||n+(e.height||t),width:e.width||a};return r};function Fe(e,t,a,n){function r(e,t){for(var r,s=new je(e),o=1,d=0;d<t.length;d++){while(e.overlapsOppositeAxis(a,t[d])||e.within(a)&&e.overlapsAny(n)){e.move(t[d])}if(e.within(a)){return e}var l=e.intersectPercentage(a);if(o>l){r=new je(e);o=l}e=new je(s)}return r||s}var i=new je(t),s=t.cue,o=Me(s),d=[];if(s.snapToLines){var l;switch(s.vertical){case"":d=["+y","-y"];l="height";break;case"rl":d=["+x","-x"];l="width";break;case"lr":d=["-x","+x"];l="width";break;}var p=i.lineHeight,u=p*Math.round(o),c=a[l]+p,m=d[0];if(Math.abs(u)>c){u=0>u?-1:1;u*=Math.ceil(c/p)*p}if(0>o){u+=""===s.vertical?a.height:a.width;d=d.reverse()}i.move(m,u)}else{var g=100*(i.lineHeight/a.height);switch(s.lineAlign){case"middle":o-=g/2;break;case"end":o-=g;break;}switch(s.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")});break;}d=["+y","-x","+x","-y"];i=new je(t)}var h=r(i,d);t.move(h.toCSSCompatValues(a))}function He(){}He.StringDecoder=function(){return{decode:function(e){if(!e){return""}if("string"!=typeof e){throw new Error("Error - expected string data.")}return decodeURIComponent(encodeURIComponent(e))}}};He.convertCueToDOMTree=function(e,t){if(!e||!t){return null}return Oe(e,t)};He.processCues=function(e,t,a){if(!e||!t||!a){return null}while(a.firstChild){a.removeChild(a.firstChild)}var r=e.document.createElement("div");r.style.position="absolute";r.style.left="0";r.style.right="0";r.style.top="0";r.style.bottom="0";r.style.margin="1.5%";a.appendChild(r);function n(e){for(var t=0;t<e.length;t++){if(e[t].hasBeenReset||!e[t].displayState){return!0}}return!1}if(!n(t)){for(var s=0;s<t.length;s++){r.appendChild(t[s].displayState)}return}var o=[],d=je.getSimpleBoxPosition(r),l=Math.round(100*(d.height*.05))/100,p={font:l+"px "+"sans-serif"};(function(){for(var a,n,s=0;s<t.length;s++){n=t[s];a=new Ne(e,n,p);r.appendChild(a.div);Fe(e,a,d,o);n.displayState=a.div;o.push(je.getSimpleBoxPosition(a))}})()};He.Parser=function(e,t,a){if(!a){a=t;t={}}if(!t){t={}}this.window=e;this.vttjs=t;this.state="INITIAL";this.buffer="";this.decoder=a||new TextDecoder("utf8");this.regionList=[]};He.Parser.prototype={reportOrThrowError:function(t){if(t instanceof Pe){this.onparsingerror&&this.onparsingerror(t)}else{throw t}},parse:function(e){var i=this;if(e){i.buffer+=i.decoder.decode(e,{stream:!0})}function t(){var e=i.buffer,t=0;while(t<e.length&&"\r"!==e[t]&&"\n"!==e[t]){++t}var a=e.substr(0,t);if("\r"===e[t]){++t}if("\n"===e[t]){++t}i.buffer=e.substr(t);return a}function a(e){var t=new De;Ae(e,function(e,a){switch(e){case"id":t.set(e,a);break;case"width":t.percent(e,a);break;case"lines":t.integer(e,a);break;case"regionanchor":case"viewportanchor":var n=a.split(",");if(2!==n.length){break}var r=new De;r.percent("x",n[0]);r.percent("y",n[1]);if(!r.has("x")||!r.has("y")){break}t.set(e+"X",r.get("x"));t.set(e+"Y",r.get("y"));break;case"scroll":t.alt(e,a,["up"]);break;}},/=/,/\s/);if(t.has("id")){var a=new(i.vttjs.VTTRegion||i.window.VTTRegion);a.width=t.get("width",100);a.lines=t.get("lines",3);a.regionAnchorX=t.get("regionanchorX",0);a.regionAnchorY=t.get("regionanchorY",100);a.viewportAnchorX=t.get("viewportanchorX",0);a.viewportAnchorY=t.get("viewportanchorY",100);a.scroll=t.get("scroll","");i.onregion&&i.onregion(a);i.regionList.push({id:t.get("id"),region:a})}}function n(e){var t=new De;Ae(e,function(e,a){switch(e){case"MPEGT":t.integer(e+"S",a);break;case"LOCA":t.set(e+"L",xe(a));break;}},/[^\d]:/,/,/);i.ontimestampmap&&i.ontimestampmap({MPEGTS:t.get("MPEGTS"),LOCAL:t.get("LOCAL")})}function r(e){if(e.match(/X-TIMESTAMP-MAP/)){Ae(e,function(e,t){switch(e){case"X-TIMESTAMP-MAP":n(t);break;}},/=/)}else{Ae(e,function(e,t){switch(e){case"Region":a(t);break;}},/:/)}}try{var s;if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer)){return this}s=t();var o=s.match(/^WEBVTT([ \t].*)?$/);if(!o||!o[0]){throw new Pe(Pe.Errors.BadSignature)}i.state="HEADER"}var d=!1;while(i.buffer){if(!/\r\n|\n/.test(i.buffer)){return this}if(!d){s=t()}else{d=!1}switch(i.state){case"HEADER":if(/:/.test(s)){r(s)}else if(!s){i.state="ID"}continue;case"NOTE":if(!s){i.state="ID"}continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){i.state="NOTE";break}if(!s){continue}i.cue=new(i.vttjs.VTTCue||i.window.VTTCue)(0,0,"");i.state="CUE";if(-1===s.indexOf("-->")){i.cue.id=s;continue}case"CUE":try{we(s,i.cue,i.regionList)}catch(t){i.reportOrThrowError(t);i.cue=null;i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var l=-1!==s.indexOf("-->");if(!s||l&&(d=!0)){i.oncue&&i.oncue(i.cue);i.cue=null;i.state="ID";continue}if(i.cue.text){i.cue.text+="\n"}i.cue.text+=s;continue;case"BADCUE":if(!s){i.state="ID"}continue;}}}catch(t){i.reportOrThrowError(t);if("CUETEXT"===i.state&&i.cue&&i.oncue){i.oncue(i.cue)}i.cue=null;i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{t.buffer+=t.decoder.decode();if(t.cue||"HEADER"===t.state){t.buffer+="\n\n";t.parse()}if("INITIAL"===t.state){throw new Pe(Pe.Errors.BadSignature)}}catch(a){t.reportOrThrowError(a)}t.onflush&&t.onflush();return this}};var $n={"":1,lr:1,rl:1},Qn={start:1,middle:1,end:1,left:1,right:1};function Ve(e){if("string"!=typeof e){return!1}var t=$n[e.toLowerCase()];return t?e.toLowerCase():!1}function qe(e){if("string"!=typeof e){return!1}var t=Qn[e.toLowerCase()];return t?e.toLowerCase():!1}function ze(e,t,a){this.hasBeenReset=!1;var n="",r=!1,i=e,s=t,o=a,d=null,l="",p=!0,u="auto",c="start",m=50,g="middle",h=50,y="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return n},set:function(e){n=""+e}},pauseOnExit:{enumerable:!0,get:function(){return r},set:function(e){r=!!e}},startTime:{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e){throw new TypeError("Start time must be set to a number.")}i=e;this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e){throw new TypeError("End time must be set to a number.")}s=e;this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(e){o=""+e;this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return d},set:function(e){d=e;this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return l},set:function(e){var t=Ve(e);if(!1===t){throw new SyntaxError("An invalid or illegal string was specified.")}l=t;this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return p},set:function(e){p=!!e;this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e&&e!=="auto"){throw new SyntaxError("An invalid number or illegal string was specified.")}u=e;this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return c},set:function(e){var t=qe(e);if(!t){throw new SyntaxError("An invalid or illegal string was specified.")}c=t;this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return m},set:function(e){if(0>e||100<e){throw new Error("Position must be between 0 and 100.")}m=e;this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return g},set:function(e){var t=qe(e);if(!t){throw new SyntaxError("An invalid or illegal string was specified.")}g=t;this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return h},set:function(e){if(0>e||100<e){throw new Error("Size must be between 0 and 100.")}h=e;this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return y},set:function(e){var t=qe(e);if(!t){throw new SyntaxError("An invalid or illegal string was specified.")}y=t;this.hasBeenReset=!0}}});this.displayState=void 0}ze.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Jn={"":!0,up:!0};function Ge(e){if("string"!=typeof e){return!1}var t=Jn[e.toLowerCase()];return t?e.toLowerCase():!1}function We(e){return"number"==typeof e&&0<=e&&100>=e}var Zn=function(){var e=100,t=3,a=0,n=100,r=0,i=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!We(t)){throw new Error("Width must be between 0 and 100.")}e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!=typeof e){throw new TypeError("Lines must be set to a number.")}t=e}},regionAnchorY:{enumerable:!0,get:function(){return n},set:function(e){if(!We(e)){throw new Error("RegionAnchorX must be between 0 and 100.")}n=e}},regionAnchorX:{enumerable:!0,get:function(){return a},set:function(e){if(!We(e)){throw new Error("RegionAnchorY must be between 0 and 100.")}a=e}},viewportAnchorY:{enumerable:!0,get:function(){return i},set:function(e){if(!We(e)){throw new Error("ViewportAnchorY must be between 0 and 100.")}i=e}},viewportAnchorX:{enumerable:!0,get:function(){return r},set:function(e){if(!We(e)){throw new Error("ViewportAnchorX must be between 0 and 100.")}r=e}},scroll:{enumerable:!0,get:function(){return s},set:function(e){var t=Ge(e);if(!1===t){throw new SyntaxError("An invalid or illegal string was specified.")}s=t}}})},er=Te(function(t){var a=t.exports={WebVTT:He,VTTCue:ze,VTTRegion:Zn};e.vttjs=a;e.WebVTT=a.WebVTT;var n=a.VTTCue,r=a.VTTRegion,i=e.VTTCue,s=e.VTTRegion;a.shim=function(){e.VTTCue=n;e.VTTRegion=r};a.restore=function(){e.VTTCue=i;e.VTTRegion=s};if(!e.VTTCue){a.shim()}}),tr=er.WebVTT,ar=er.VTTCue,nr=er.VTTRegion;function Ke(e,t,a,n,r){if(void 0===r){r={}}var i=e.textTracks();r.kind=t;if(a){r.label=a}if(n){r.language=n}r.tech=e;var s=new qn.text.TrackClass(r);i.addTrack(s);return s}var rr=function(n){a(r,n);function r(e,t){var a;if(void 0===e){e={}}if(void 0===t){t=function(){}}e.reportTouchActivity=!1;a=n.call(this,null,e,t)||this;a.hasStarted_=!1;a.on("playing",function(){this.hasStarted_=!0});a.on("loadstart",function(){this.hasStarted_=!1});qn.names.forEach(function(t){var n=qn[t];if(e&&e[n.getterName]){a[n.privateName]=e[n.getterName]}});if(!a.featuresProgressEvents){a.manualProgressOn()}if(!a.featuresTimeupdateEvents){a.manualTimeUpdatesOn()}["Text","Audio","Video"].forEach(function(t){if(!1===e["native"+t+"Tracks"]){a["featuresNative"+t+"Tracks"]=!1}});if(!1===e.nativeCaptions||!1===e.nativeTextTracks){a.featuresNativeTextTracks=!1}else if(!0===e.nativeCaptions||!0===e.nativeTextTracks){a.featuresNativeTextTracks=!0}if(!a.featuresNativeTextTracks){a.emulateTextTracks()}a.autoRemoteTextTracks_=new qn.text.ListClass;a.initTrackListeners();if(!e.nativeControlsForTouch){a.emitTapEvents()}if(a.constructor){a.name_=a.constructor.name||"Unknown Tech"}return a}var i=r.prototype;i.triggerSourceset=function(e){var t=this;if(!this.isReady_){this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)})}this.trigger({src:e,type:"sourceset"})};i.manualProgressOn=function(){this.on("durationchange",this.onDurationChange);this.manualProgress=!0;this.one("ready",this.trackProgress)};i.manualProgressOff=function(){this.manualProgress=!1;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange)};i.trackProgress=function(){this.stopTrackingProgress();this.progressInterval=this.setInterval(qt(this,function(){var e=this.bufferedPercent();if(this.bufferedPercent_!==e){this.trigger("progress")}this.bufferedPercent_=e;if(1===e){this.stopTrackingProgress()}}),500)};i.onDurationChange=function(){this.duration_=this.duration()};i.buffered=function(){return he(0,0)};i.bufferedPercent=function(){return ye(this.buffered(),this.duration_)};i.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)};i.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0;this.on("play",this.trackCurrentTime);this.on("pause",this.stopTrackingCurrentTime)};i.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime)};i.trackCurrentTime=function(){if(this.currentTimeInterval){this.stopTrackingCurrentTime()}this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)};i.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})};i.dispose=function(){this.clearTracks(Hn.names);if(this.manualProgress){this.manualProgressOff()}if(this.manualTimeUpdates){this.manualTimeUpdatesOff()}n.prototype.dispose.call(this)};i.clearTracks=function(e){var t=this;e=[].concat(e);e.forEach(function(e){var a=t[e+"Tracks"]()||[],n=a.length;while(n--){var r=a[n];if("text"===e){t.removeRemoteTextTrack(r)}a.removeTrack(r)}})};i.cleanupAutoTextTracks=function(){var e=this.autoRemoteTextTracks_||[],t=e.length;while(t--){var a=e[t];this.removeRemoteTextTrack(a)}};i.reset=function(){};i.error=function(e){if(e!==void 0){this.error_=new _e(e);this.trigger("error")}return this.error_};i.played=function(){if(this.hasStarted_){return he(0,0)}return he()};i.setCurrentTime=function(){if(this.manualTimeUpdates){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}};i.initTrackListeners=function(){var e=this;Hn.names.forEach(function(t){var a=Hn[t],n=function(){e.trigger(t+"trackchange")},r=e[a.getterName]();r.addEventListener("removetrack",n);r.addEventListener("addtrack",n);e.on("dispose",function(){r.removeEventListener("removetrack",n);r.removeEventListener("addtrack",n)})})};i.addWebVttScript_=function(){var a=this;if(e.WebVTT){return}if(t.body.contains(this.el())){if(!this.options_["vtt.js"]&&h(er)&&0<Object.keys(er).length){this.trigger("vttjsloaded");return}var n=t.createElement("script");n.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js";n.onload=function(){a.trigger("vttjsloaded")};n.onerror=function(){a.trigger("vttjserror")};this.on("dispose",function(){n.onload=null;n.onerror=null});e.WebVTT=!0;this.el().parentNode.appendChild(n)}else{this.ready(this.addWebVttScript_)}};i.emulateTextTracks=function(){var e=this,t=this.textTracks(),a=this.remoteTextTracks(),n=function(a){return t.addTrack(a.track)},r=function(a){return t.removeTrack(a.track)};a.on("addtrack",n);a.on("removetrack",r);this.addWebVttScript_();var s=function(){return e.trigger("texttrackchange")},o=function(){s();for(var e=0,a;e<t.length;e++){a=t[e];a.removeEventListener("cuechange",s);if("showing"===a.mode){a.addEventListener("cuechange",s)}}};o();t.addEventListener("change",o);t.addEventListener("addtrack",o);t.addEventListener("removetrack",o);this.on("dispose",function(){a.off("addtrack",n);a.off("removetrack",r);t.removeEventListener("change",o);t.removeEventListener("addtrack",o);t.removeEventListener("removetrack",o);for(var e=0,d;e<t.length;e++){d=t[e];d.removeEventListener("cuechange",s)}})};i.addTextTrack=function(e,t,a){if(!e){throw new Error("TextTrack kind is required but was not provided")}return Ke(this,e,t,a)};i.createRemoteTextTrack=function(e){var t=ue(e,{tech:this});return new Vn.remoteTextEl.TrackClass(t)};i.addRemoteTextTrack=function(e,t){var a=this;if(void 0===e){e={}}var n=this.createRemoteTextTrack(e);if(!0!==t&&!1!==t){Et.warn("Calling addRemoteTextTrack without explicitly setting the \"manualCleanup\" parameter to `true` is deprecated and default to `false` in future version of video.js");t=!0}this.remoteTextTrackEls().addTrackElement_(n);this.remoteTextTracks().addTrack(n.track);if(!0!==t){this.ready(function(){return a.autoRemoteTextTracks_.addTrack(n.track)})}return n};i.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t);this.remoteTextTracks().removeTrack(e);this.autoRemoteTextTracks_.removeTrack(e)};i.getVideoPlaybackQuality=function(){return{}};i.setPoster=function(){};i.playsinline=function(){};i.setPlaysinline=function(){};i.overrideNativeAudioTracks=function(){};i.overrideNativeVideoTracks=function(){};i.canPlayType=function(){return""};r.canPlayType=function(){return""};r.canPlaySource=function(e){return r.canPlayType(e.type)};r.isTech=function(e){return e.prototype instanceof r||e instanceof r||e===r};r.registerTech=function(e,t){if(!r.techs_){r.techs_={}}if(!r.isTech(t)){throw new Error("Tech "+e+" must be a Tech")}if(!r.canPlayType){throw new Error("Techs must have a static canPlayType method on them")}if(!r.canPlaySource){throw new Error("Techs must have a static canPlaySource method on them")}e=le(e);r.techs_[e]=t;if("Tech"!==e){r.defaultTechOrder_.push(e)}return t};r.getTech=function(t){if(!t){return}t=le(t);if(r.techs_&&r.techs_[t]){return r.techs_[t]}if(e&&e.videojs&&e.videojs[t]){Et.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)");return e.videojs[t]}};return r}(ra);qn.names.forEach(function(e){var t=qn[e];rr.prototype[t.getterName]=function(){this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}});rr.prototype.featuresVolumeControl=!0;rr.prototype.featuresMuteControl=!0;rr.prototype.featuresFullscreenResize=!1;rr.prototype.featuresPlaybackRate=!1;rr.prototype.featuresProgressEvents=!1;rr.prototype.featuresSourceset=!1;rr.prototype.featuresTimeupdateEvents=!1;rr.prototype.featuresNativeTextTracks=!1;rr.withSourceHandlers=function(e){e.registerSourceHandler=function(t,a){var n=e.sourceHandlers;if(!n){n=e.sourceHandlers=[]}if(a===void 0){a=n.length}n.splice(a,0,t)};e.canPlayType=function(t){for(var a=e.sourceHandlers||[],n,r=0;r<a.length;r++){n=a[r].canPlayType(t);if(n){return n}}return""};e.selectSourceHandler=function(t,a){for(var n=e.sourceHandlers||[],r,s=0;s<n.length;s++){r=n[s].canHandleSource(t,a);if(r){return n[s]}}return null};e.canPlaySource=function(t,a){var n=e.selectSourceHandler(t,a);if(n){return n.canHandleSource(t,a)}return""};["seekable","seeking","duration"].forEach(function(e){var t=this[e];if("function"!=typeof t){return}this[e]=function(){if(this.sourceHandler_&&this.sourceHandler_[e]){return this.sourceHandler_[e].apply(this.sourceHandler_,arguments)}return t.apply(this,arguments)}},e.prototype);e.prototype.setSource=function(t){var a=e.selectSourceHandler(t,this.options_);if(!a){if(e.nativeSourceHandler){a=e.nativeSourceHandler}else{Et.error("No source handler found for the current source.")}}this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);if(a!==e.nativeSourceHandler){this.currentSource_=t}this.sourceHandler_=a.handleSource(t,this,this.options_);this.one("dispose",this.disposeSourceHandler)};e.prototype.disposeSourceHandler=function(){if(this.currentSource_){this.clearTracks(["audio","video"]);this.currentSource_=null}this.cleanupAutoTextTracks();if(this.sourceHandler_){if(this.sourceHandler_.dispose){this.sourceHandler_.dispose()}this.sourceHandler_=null}}};ra.registerComponent("Tech",rr);rr.registerTech("Tech",rr);rr.defaultTechOrder_=[];var ir={},sr={},or={};function Ye(e,t,a){e.setTimeout(function(){return nt(t,ir[t.type],a,e)},1)}function Xe(e,t){e.forEach(function(e){return e.setTech&&e.setTech(t)})}function $e(e,t,a){return e.reduceRight(Ze(a),t[a]())}function Qe(e,t,a,n){return t[a](e.reduce(Ze(a),n))}function Je(e,t,a,n){if(void 0===n){n=null}var r="call"+le(a),i=e.reduce(Ze(r),n),s=i===or,o=s?null:t[a](i);et(e,a,o,s);return o}var dr={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1},lr={setCurrentTime:1},pr={play:1,pause:1};function Ze(e){return function(t,a){if(t===or){return or}if(a[e]){return a[e](t)}return t}}function et(e,t,a,n){for(var r=e.length-1,s;0<=r;r--){s=e[r];if(s[t]){s[t](n,a)}}}function tt(e){sr[e.id()]=null}function at(e,t){var a=sr[e.id()],n=null;if(a===void 0||null===a){n=t(e);sr[e.id()]=[[t,n]];return n}for(var r=0;r<a.length;r++){var s=a[r],o=s[0],d=s[1];if(o!==t){continue}n=d}if(null===n){n=t(e);a.push([t,n])}return n}function nt(e,t,a,n,r,i){if(void 0===e){e={}}if(void 0===t){t=[]}if(void 0===r){r=[]}if(void 0===i){i=!1}var s=t,o=s[0],d=s.slice(1);if("string"==typeof o){nt(e,ir[o],a,n,r,i)}else if(o){var l=at(n,o);if(!l.setSource){r.push(l);return nt(e,d,a,n,r,i)}l.setSource(m({},e),function(t,s){if(t){return nt(e,d,a,n,r,i)}r.push(l);nt(s,e.type===s.type?d:ir[s.type],a,n,r,i)})}else if(d.length){nt(e,d,a,n,r,i)}else if(i){a(e,r)}else{nt(e,ir["*"],a,n,r,!0)}}var ur={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},cr=function(e){if(void 0===e){e=""}var t=dn(e),a=ur[t.toLowerCase()];return a||""},mr=function(e,t){if(!t){return""}if(e.cache_.source.src===t&&e.cache_.source.type){return e.cache_.source.type}var a=e.cache_.sources.filter(function(e){return e.src===t});if(a.length){return a[0].type}for(var n=e.$$("source"),r=0,o;r<n.length;r++){o=n[r];if(o.type&&o.src&&o.src===t){return o.type}}return cr(t)},gr=function e(t){if(Array.isArray(t)){var a=[];t.forEach(function(t){t=e(t);if(Array.isArray(t)){a=a.concat(t)}else if(g(t)){a.push(t)}});t=a}else if("string"==typeof t&&t.trim()){t=[rt({src:t})]}else if(g(t)&&"string"==typeof t.src&&t.src&&t.src.trim()){t=[rt(t)]}else{t=[]}return t};function rt(e){var t=cr(e.src);if(!e.type&&t){e.type=t}return e}var hr=function(e){a(t,e);function t(t,a,n){var r,s=ue({createEl:!1},a);r=e.call(this,t,s,n)||this;if(!a.playerOptions.sources||0===a.playerOptions.sources.length){for(var o=0,d=a.playerOptions.techOrder;o<d.length;o++){var l=le(d[o]),p=rr.getTech(l);if(!l){p=ra.getComponent(l)}if(p&&p.isSupported()){t.loadTech_(l);break}}}else{t.src(a.playerOptions.sources)}return r}return t}(ra);ra.registerComponent("MediaLoader",hr);var yr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.emitTapEvents();n.enable();return n}var n=t.prototype;n.createEl=function(t,a,n){if(void 0===t){t="div"}if(void 0===a){a={}}if(void 0===n){n={}}a=m({innerHTML:"<span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>",className:this.buildCSSClass(),tabIndex:0},a);if("button"===t){Et.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead.")}n=m({role:"button"},n);this.tabIndex_=a.tabIndex;var r=e.prototype.createEl.call(this,t,a,n);this.createControlTextEl(r);return r};n.dispose=function(){this.controlTextEl_=null;e.prototype.dispose.call(this)};n.createControlTextEl=function(e){this.controlTextEl_=E("span",{className:"vjs-control-text"},{"aria-live":"polite"});if(e){e.appendChild(this.controlTextEl_)}this.controlText(this.controlText_,e);return this.controlTextEl_};n.controlText=function(e,t){if(void 0===t){t=this.el()}if(e===void 0){return this.controlText_||"Need Text"}var a=this.localize(e);this.controlText_=e;L(this.controlTextEl_,a);if(!this.nonIconControl){t.setAttribute("title",a)}};n.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)};n.enable=function(){if(!this.enabled_){this.enabled_=!0;this.removeClass("vjs-disabled");this.el_.setAttribute("aria-disabled","false");if("undefined"!=typeof this.tabIndex_){this.el_.setAttribute("tabIndex",this.tabIndex_)}this.on(["tap","click"],this.handleClick);this.on("keydown",this.handleKeyDown)}};n.disable=function(){this.enabled_=!1;this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");if("undefined"!=typeof this.tabIndex_){this.el_.removeAttribute("tabIndex")}this.off(["tap","click"],this.handleClick);this.off("keydown",this.handleKeyDown)};n.handleClick=function(){};n.handleKeyDown=function(t){if(Ba.isEventKey(t,"Space")||Ba.isEventKey(t,"Enter")){t.preventDefault();t.stopPropagation();this.trigger("click")}else{e.prototype.handleKeyDown.call(this,t)}};return t}(ra);ra.registerComponent("ClickableComponent",yr);var _r=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.update();t.on("posterchange",qt(o(o(n)),n.update));return n}var n=t.prototype;n.dispose=function(){this.player().off("posterchange",this.update);e.prototype.dispose.call(this)};n.createEl=function(){var e=E("div",{className:"vjs-poster",tabIndex:-1});return e};n.update=function(){var e=this.player().poster();this.setSrc(e);if(e){this.show()}else{this.hide()}};n.setSrc=function(e){var t="";if(e){t="url(\""+e+"\")"}this.el_.style.backgroundImage=t};n.handleClick=function(){if(!this.player_.controls()){return}this.player_.tech(!0).focus();if(this.player_.paused()){be(this.player_.play())}else{this.player_.pause()}};return t}(yr);ra.registerComponent("PosterImage",_r);var fr="#ccc",br={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:"\"Andale Mono\", \"Lucida Console\", monospace",monospaceSerif:"\"Courier New\", monospace",proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:"\"Comic Sans MS\", Impact, fantasy",script:"\"Monotype Corsiva\", cursive",smallcaps:"\"Andale Mono\", \"Lucida Console\", monospace, sans-serif"};function it(e,t){var a;if(4===e.length){a=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]}else if(7===e.length){a=e.slice(1)}else{throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.")}return"rgba("+parseInt(a.slice(0,2),16)+","+parseInt(a.slice(2,4),16)+","+parseInt(a.slice(4,6),16)+","+t+")"}function st(e,t,a){try{e.style[t]=a}catch(t){}}var Tr=function(t){a(n,t);function n(a,n,r){var i=t.call(this,a,n,r)||this;var s=qt(o(o(i)),i.updateDisplay);a.on("loadstart",qt(o(o(i)),i.toggleDisplay));a.on("texttrackchange",s);a.on("loadedmetadata",qt(o(o(i)),i.preselectTrack));a.ready(qt(o(o(i)),function(){if(a.tech_&&a.tech_.featuresNativeTextTracks){this.hide();return}a.on("fullscreenchange",s);a.on("playerresize",s);e.addEventListener("orientationchange",s);a.on("dispose",function(){return e.removeEventListener("orientationchange",s)});for(var t=this.options_.playerOptions.tracks||[],n=0;n<t.length;n++){this.player_.addRemoteTextTrack(t[n],!0)}this.preselectTrack()}));return i}var r=n.prototype;r.preselectTrack=function(){for(var e={captions:1,subtitles:1},t=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,n,r,s,o=0,d;o<t.length;o++){d=t[o];if(a&&a.enabled&&a.language&&a.language===d.language&&d.kind in e){if(d.kind===a.kind){s=d}else if(!s){s=d}}else if(a&&!a.enabled){s=null;n=null;r=null}else if(d.default){if("descriptions"===d.kind&&!n){n=d}else if(d.kind in e&&!r){r=d}}}if(s){s.mode="showing"}else if(r){r.mode="showing"}else if(n){n.mode="showing"}};r.toggleDisplay=function(){if(this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks){this.hide()}else{this.show()}};r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})};r.clearDisplay=function(){if("function"==typeof e.WebVTT){e.WebVTT.processCues(e,[],this.el_)}};r.updateDisplay=function(){var e=this.player_.textTracks();this.clearDisplay();var t=null,a=null,n=e.length;while(n--){var r=e[n];if("showing"===r.mode){if("descriptions"===r.kind){t=r}else{a=r}}}if(a){if("off"!==this.getAttribute("aria-live")){this.setAttribute("aria-live","off")}this.updateForTrack(a)}else if(t){if("assertive"!==this.getAttribute("aria-live")){this.setAttribute("aria-live","assertive")}this.updateForTrack(t)}};r.updateForTrack=function(t){if("function"!=typeof e.WebVTT||!t.activeCues){return}for(var a=[],n=0;n<t.activeCues.length;n++){a.push(t.activeCues[n])}e.WebVTT.processCues(e,a,this.el_);if(!this.player_.textTrackSettings){return}var r=this.player_.textTrackSettings.getValues(),s=a.length;while(s--){var o=a[s];if(!o){continue}var d=o.displayState;if(r.color){d.firstChild.style.color=r.color}if(r.textOpacity){st(d.firstChild,"color",it(r.color||"#fff",r.textOpacity))}if(r.backgroundColor){d.firstChild.style.backgroundColor=r.backgroundColor}if(r.backgroundOpacity){st(d.firstChild,"backgroundColor",it(r.backgroundColor||"#000",r.backgroundOpacity))}if(r.windowColor){if(r.windowOpacity){st(d,"backgroundColor",it(r.windowColor,r.windowOpacity))}else{d.style.backgroundColor=r.windowColor}}if(r.edgeStyle){if("dropshadow"===r.edgeStyle){d.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222"}else if("raised"===r.edgeStyle){d.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222"}else if("depressed"===r.edgeStyle){d.firstChild.style.textShadow="1px 1px "+fr+", 0 1px "+fr+", -1px -1px "+"#222"+", 0 -1px "+"#222"}else if("uniform"===r.edgeStyle){d.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222"}}if(r.fontPercent&&1!==r.fontPercent){var l=e.parseFloat(d.style.fontSize);d.style.fontSize=l*r.fontPercent+"px";d.style.height="auto";d.style.top="auto";d.style.bottom="2px"}if(r.fontFamily&&"default"!==r.fontFamily){if("small-caps"===r.fontFamily){d.firstChild.style.fontVariant="small-caps"}else{d.firstChild.style.fontFamily=br[r.fontFamily]}}}};return n}(ra);ra.registerComponent("TextTrackDisplay",Tr);var vr=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createEl=function(){var t=this.player_.isAudio(),a=this.localize(t?"Audio Player":"Video Player"),n=E("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[a])}),r=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});r.appendChild(n);return r};return t}(ra);ra.registerComponent("LoadingSpinner",vr);var Sr=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createEl=function(e,t,a){if(void 0===t){t={}}if(void 0===a){a={}}e="button";t=m({innerHTML:"<span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>",className:this.buildCSSClass()},t);a=m({type:"button"},a);var n=ra.prototype.createEl.call(this,e,t,a);this.createControlTextEl(n);return n};n.addChild=function(e,t){if(void 0===t){t={}}var a=this.constructor.name;Et.warn("Adding an actionable (user controllable) child to a Button ("+a+") is not supported; use a ClickableComponent instead.");return ra.prototype.addChild.call(this,e,t)};n.enable=function(){e.prototype.enable.call(this);this.el_.removeAttribute("disabled")};n.disable=function(){e.prototype.disable.call(this);this.el_.setAttribute("disabled","disabled")};n.handleKeyDown=function(t){if(Ba.isEventKey(t,"Space")||Ba.isEventKey(t,"Enter")){t.stopPropagation();return}e.prototype.handleKeyDown.call(this,t)};return t}(yr);ra.registerComponent("Button",Sr);var kr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.mouseused_=!1;n.on("mousedown",n.handleMouseDown);return n}var n=t.prototype;n.buildCSSClass=function(){return"vjs-big-play-button"};n.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){be(t);this.player_.tech(!0).focus();return}var a=this.player_.getChild("controlBar"),n=a&&a.getChild("playToggle");if(!n){this.player_.tech(!0).focus();return}var r=function(){return n.focus()};if(fe(t)){t.then(r,function(){})}else{this.setTimeout(r,1)}};n.handleKeyDown=function(t){this.mouseused_=!1;e.prototype.handleKeyDown.call(this,t)};n.handleMouseDown=function(){this.mouseused_=!0};return t}(Sr);kr.prototype.controlText_="Play Video";ra.registerComponent("BigPlayButton",kr);var Cr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.controlText(a&&a.controlText||n.localize("Close"));return n}var n=t.prototype;n.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)};n.handleClick=function(){this.trigger({type:"close",bubbles:!1})};return t}(Sr);ra.registerComponent("CloseButton",Cr);var Er=function(e){a(t,e);function t(t,a){var n;if(void 0===a){a={}}n=e.call(this,t,a)||this;a.replay=a.replay===void 0||a.replay;n.on(t,"play",n.handlePlay);n.on(t,"pause",n.handlePause);if(a.replay){n.on(t,"ended",n.handleEnded)}return n}var n=t.prototype;n.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)};n.handleClick=function(){if(this.player_.paused()){this.player_.play()}else{this.player_.pause()}};n.handleSeeked=function(e){this.removeClass("vjs-ended");if(this.player_.paused()){this.handlePause(e)}else{this.handlePlay(e)}};n.handlePlay=function(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")};n.handlePause=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")};n.handleEnded=function(){this.removeClass("vjs-playing");this.addClass("vjs-ended");this.controlText("Replay");this.one(this.player_,"seeked",this.handleSeeked)};return t}(Sr);Er.prototype.controlText_="Play";ra.registerComponent("PlayToggle",Er);var Lr=function(e,t){e=0>e?0:e;var a=Math.floor(e%60),n=Math.floor(e/60%60),r=Math.floor(e/3600),i=Math.floor(t/60%60),o=Math.floor(t/3600);if(isNaN(e)||e===1/0){r=n=a="-"}r=0<r||0<o?r+":":"";n=((r||10<=i)&&10>n?"0"+n:n)+":";a=10>a?"0"+a:a;return r+n+a},Ir=Lr;function ot(e,t){if(void 0===t){t=e}return Ir(e,t)}var Pr=function(e){a(n,e);function n(t,a){var n=e.call(this,t,a)||this;n.throttledUpdateContent=zt(qt(o(o(n)),n.updateContent),25);n.on(t,"timeupdate",n.throttledUpdateContent);return n}var r=n.prototype;r.createEl=function(){var t=this.buildCSSClass(),a=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:"<span class=\"vjs-control-text\" role=\"presentation\">"+this.localize(this.labelText_)+"\xA0</span>"});this.contentEl_=E("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"});this.updateTextNode_();a.appendChild(this.contentEl_);return a};r.dispose=function(){this.contentEl_=null;this.textNode_=null;e.prototype.dispose.call(this)};r.updateTextNode_=function(){if(!this.contentEl_){return}while(this.contentEl_.firstChild){this.contentEl_.removeChild(this.contentEl_.firstChild)}this.textNode_=t.createTextNode(this.formattedTime_||this.formatTime_(0));this.contentEl_.appendChild(this.textNode_)};r.formatTime_=function(e){return ot(e)};r.updateFormattedTime_=function(e){var t=this.formatTime_(e);if(t===this.formattedTime_){return}this.formattedTime_=t;this.requestAnimationFrame(this.updateTextNode_)};r.updateContent=function(){};return n}(ra);Pr.prototype.labelText_="Time";Pr.prototype.controlText_="Time";ra.registerComponent("TimeDisplay",Pr);var xr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.on(t,"ended",n.handleEnded);return n}var n=t.prototype;n.buildCSSClass=function(){return"vjs-current-time"};n.updateContent=function(){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(e)};n.handleEnded=function(){if(!this.player_.duration()){return}this.updateFormattedTime_(this.player_.duration())};return t}(Pr);xr.prototype.labelText_="Current Time";xr.prototype.controlText_="Current Time";ra.registerComponent("CurrentTimeDisplay",xr);var Dr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.on(t,"durationchange",n.updateContent);n.on(t,"loadstart",n.updateContent);n.on(t,"loadedmetadata",n.throttledUpdateContent);return n}var n=t.prototype;n.buildCSSClass=function(){return"vjs-duration"};n.updateContent=function(){var e=this.player_.duration();if(this.duration_!==e){this.duration_=e;this.updateFormattedTime_(e)}};return t}(Pr);Dr.prototype.labelText_="Duration";Dr.prototype.controlText_="Duration";ra.registerComponent("DurationDisplay",Dr);var Ar=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})};return t}(ra);ra.registerComponent("TimeDivider",Ar);var wr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.on(t,"durationchange",n.throttledUpdateContent);n.on(t,"ended",n.handleEnded);return n}var n=t.prototype;n.buildCSSClass=function(){return"vjs-remaining-time"};n.createEl=function(){var t=e.prototype.createEl.call(this);t.insertBefore(E("span",{},{"aria-hidden":!0},"-"),this.contentEl_);return t};n.updateContent=function(){if("number"!=typeof this.player_.duration()){return}if(this.player_.remainingTimeDisplay){this.updateFormattedTime_(this.player_.remainingTimeDisplay())}else{this.updateFormattedTime_(this.player_.remainingTime())}};n.handleEnded=function(){if(!this.player_.duration()){return}this.updateFormattedTime_(0)};return t}(Pr);wr.prototype.labelText_="Remaining Time";wr.prototype.controlText_="Remaining Time";ra.registerComponent("RemainingTimeDisplay",wr);var Or=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.updateShowing();n.on(n.player(),"durationchange",n.updateShowing);return n}var n=t.prototype;n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});this.contentEl_=E("div",{className:"vjs-live-display",innerHTML:"<span class=\"vjs-control-text\">"+this.localize("Stream Type")+"\xA0</span>"+this.localize("LIVE")},{"aria-live":"off"});t.appendChild(this.contentEl_);return t};n.dispose=function(){this.contentEl_=null;e.prototype.dispose.call(this)};n.updateShowing=function(){if(this.player().duration()===1/0){this.show()}else{this.hide()}};return t}(ra);ra.registerComponent("LiveDisplay",Or);var Ur=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.updateLiveEdgeStatus();if(n.player_.liveTracker){n.on(n.player_.liveTracker,"liveedgechange",n.updateLiveEdgeStatus)}return n}var n=t.prototype;n.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});this.textEl_=E("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"});t.appendChild(this.textEl_);return t};n.updateLiveEdgeStatus=function(){if(!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()){this.setAttribute("aria-disabled",!0);this.addClass("vjs-at-live-edge");this.controlText("Seek to live, currently playing live")}else{this.setAttribute("aria-disabled",!1);this.removeClass("vjs-at-live-edge");this.controlText("Seek to live, currently behind live")}};n.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()};n.dispose=function(){if(this.player_.liveTracker){this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus)}this.textEl_=null;e.prototype.dispose.call(this)};return t}(Sr);Ur.prototype.controlText_="Seek to live, currently playing live";ra.registerComponent("SeekToLive",Ur);var Rr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.bar=n.getChild(n.options_.barName);n.vertical(!!n.options_.vertical);n.enable();return n}var n=t.prototype;n.enabled=function(){return this.enabled_};n.enable=function(){if(this.enabled()){return}this.on("mousedown",this.handleMouseDown);this.on("touchstart",this.handleMouseDown);this.on("keydown",this.handleKeyDown);this.on("click",this.handleClick);this.on(this.player_,"controlsvisible",this.update);if(this.playerEvent){this.on(this.player_,this.playerEvent,this.update)}this.removeClass("disabled");this.setAttribute("tabindex",0);this.enabled_=!0};n.disable=function(){if(!this.enabled()){return}var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown);this.off("touchstart",this.handleMouseDown);this.off("keydown",this.handleKeyDown);this.off("click",this.handleClick);this.off(this.player_,"controlsvisible",this.update);this.off(e,"mousemove",this.handleMouseMove);this.off(e,"mouseup",this.handleMouseUp);this.off(e,"touchmove",this.handleMouseMove);this.off(e,"touchend",this.handleMouseUp);this.removeAttribute("tabindex");this.addClass("disabled");if(this.playerEvent){this.off(this.player_,this.playerEvent,this.update)}this.enabled_=!1};n.createEl=function(t,a,n){if(void 0===a){a={}}if(void 0===n){n={}}a.className=a.className+" vjs-slider";a=m({tabIndex:0},a);n=m({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},n);return e.prototype.createEl.call(this,t,a,n)};n.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;if("mousedown"===e.type){e.preventDefault()}if("touchstart"===e.type&&!fa){e.preventDefault()}B();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(t,"mousemove",this.handleMouseMove);this.on(t,"mouseup",this.handleMouseUp);this.on(t,"touchmove",this.handleMouseMove);this.on(t,"touchend",this.handleMouseUp);this.handleMouseMove(e)};n.handleMouseMove=function(){};n.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;N();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(e,"mousemove",this.handleMouseMove);this.off(e,"mouseup",this.handleMouseUp);this.off(e,"touchmove",this.handleMouseMove);this.off(e,"touchend",this.handleMouseUp);this.update()};n.update=function(){if(!this.el_){return}var e=this.getPercent(),t=this.bar;if(!t){return}if("number"!=typeof e||e!==e||0>e||e===1/0){e=0}var a=(100*e).toFixed(2)+"%",n=t.el().style;if(this.vertical()){n.height=a}else{n.width=a}return e};n.calculateDistance=function(e){var t=H(this.el_,e);if(this.vertical()){return t.y}return t.x};n.handleKeyDown=function(t){if(Ba.isEventKey(t,"Left")||Ba.isEventKey(t,"Down")){t.preventDefault();t.stopPropagation();this.stepBack()}else if(Ba.isEventKey(t,"Right")||Ba.isEventKey(t,"Up")){t.preventDefault();t.stopPropagation();this.stepForward()}else{e.prototype.handleKeyDown.call(this,t)}};n.handleClick=function(e){e.stopPropagation();e.preventDefault()};n.vertical=function(e){if(e===void 0){return this.vertical_||!1}this.vertical_=!!e;if(this.vertical_){this.addClass("vjs-slider-vertical")}else{this.addClass("vjs-slider-horizontal")}};return t}(ra);ra.registerComponent("Slider",Rr);var Mr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.partEls_=[];n.on(t,"progress",n.update);return n}var n=t.prototype;n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:"<span class=\"vjs-control-text\"><span>"+this.localize("Loaded")+"</span>: <span class=\"vjs-control-text-loaded-percentage\">0%</span></span>"})};n.dispose=function(){this.partEls_=null;e.prototype.dispose.call(this)};n.update=function(){var e=this.player_.liveTracker,t=this.player_.buffered(),a=e&&e.isLive()?e.seekableEnd():this.player_.duration(),n=this.player_.bufferedEnd(),r=this.partEls_,s=this.$(".vjs-control-text-loaded-percentage"),o=function(e,t,a){var n=e/t||0;n=100*(1<=n?1:n);if(a){n=n.toFixed(2)}return n+"%"};this.el_.style.width=o(n,a);L(s,o(n,a,!0));for(var d=0;d<t.length;d++){var l=t.start(d),p=t.end(d),u=r[d];if(!u){u=this.el_.appendChild(E());r[d]=u}u.style.left=o(l,n);u.style.width=o(p-l,n)}for(var c=r.length;c>t.length;c--){this.el_.removeChild(r[c-1])}r.length=t.length};return t}(ra);ra.registerComponent("LoadProgressBar",Mr);var Br=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})};n.update=function(e,t,a){var n=j(this.el_),r=j(this.player_.el()),i=e.width*t;if(!r||!n){return}var s=e.left-r.left+i,o=e.width-i+(r.right-e.right),d=n.width/2;if(s<d){d+=d-s}else if(o<d){d=o}if(0>d){d=0}else if(d>n.width){d=n.width}this.el_.style.right="-"+d+"px";L(this.el_,a)};n.updateTime=function(e,t,a,n){var r=this;if(this.rafId_){this.cancelAnimationFrame(this.rafId_)}this.rafId_=this.requestAnimationFrame(function(){var i,s=r.player_.duration();if(r.player_.liveTracker&&r.player_.liveTracker.isLive()){var o=r.player_.liveTracker.liveWindow(),d=o-t*o;i=(1>d?"":"-")+ot(d,o)}else{i=ot(a,s)}r.update(e,t,i);if(n){n()}})};return t}(ra);ra.registerComponent("TimeTooltip",Br);var Nr=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})};n.update=function(e,t){var a=this.getChild("timeTooltip");if(!a){return}var n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();a.updateTime(e,t,n)};return t}(ra);Nr.prototype.options_={children:[]};if(!ua&&!ma){Nr.prototype.options_.children.push("timeTooltip")}ra.registerComponent("PlayProgressBar",Nr);var jr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.update=zt(qt(o(o(n)),n.update),25);return n}var n=t.prototype;n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})};n.update=function(e,t){var a=this,n=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,n,function(){a.el_.style.left=e.width*t+"px"})};return t}(ra);jr.prototype.options_={children:["timeTooltip"]};ra.registerComponent("MouseTimeDisplay",jr);var Fr=12,Hr=30,Vr=function(e){a(n,e);function n(t,a){var n=e.call(this,t,a)||this;n.setEventHandlers_();return n}var r=n.prototype;r.setEventHandlers_=function(){this.update=zt(qt(this,this.update),Hr);this.on(this.player_,"timeupdate",this.update);this.on(this.player_,"ended",this.handleEnded);this.on(this.player_,"durationchange",this.update);if(this.player_.liveTracker){this.on(this.player_.liveTracker,"liveedgechange",this.update)}this.updateInterval=null;this.on(this.player_,["playing"],this.enableInterval_);this.on(this.player_,["ended","pause","waiting"],this.disableInterval_);if("hidden"in t&&"visibilityState"in t){this.on(t,"visibilitychange",this.toggleVisibility_)}};r.toggleVisibility_=function(a){if(t.hidden){this.disableInterval_(a)}else{this.enableInterval_();this.requestAnimationFrame(this.update)}};r.enableInterval_=function(){var e=this;this.clearInterval(this.updateInterval);this.updateInterval=this.setInterval(function(){e.requestAnimationFrame(e.update)},Hr)};r.disableInterval_=function(t){if(this.player_.liveTracker&&this.player_.liveTracker.isLive()&&"ended"!==t.type){return}this.clearInterval(this.updateInterval)};r.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})};r.update_=function(e,t){var a=this.player_.liveTracker,n=this.player_.duration();if(a&&a.isLive()){n=this.player_.liveTracker.liveCurrentTime()}this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2));this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[ot(e,n),ot(n,n)],"{1} of {2}"));if(this.bar){this.bar.update(j(this.el_),t)}};r.update=function(){if(null===this.el().offsetParent){return}var t=e.prototype.update.call(this);this.update_(this.getCurrentTime_(),t);return t};r.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()};r.handleEnded=function(){this.update_(this.player_.duration(),1)};r.getPercent=function(){var e=this.getCurrentTime_(),t,a=this.player_.liveTracker;if(a&&a.isLive()){t=(e-a.seekableStart())/a.liveWindow();if(a.atLiveEdge()){t=1}}else{t=e/this.player_.duration()}return 1<=t?1:t||0};r.handleMouseDown=function(t){if(!K(t)){return}t.stopPropagation();this.player_.scrubbing(!0);this.videoWasPlaying=!this.player_.paused();this.player_.pause();e.prototype.handleMouseDown.call(this,t)};r.handleMouseMove=function(e){if(!K(e)){return}var t,a=this.calculateDistance(e),n=this.player_.liveTracker;if(!n||!n.isLive()){t=a*this.player_.duration();if(t===this.player_.duration()){t=t-.1}}else{var r=n.seekableStart(),i=n.liveCurrentTime();t=r+a*n.liveWindow();if(t>=i){t=i}if(t<=r){t=r+.1}if(t===1/0){return}}this.player_.currentTime(t)};r.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");if(!t){return}t.show()};r.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");if(!t){return}t.hide()};r.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t);if(t){t.stopPropagation()}this.player_.scrubbing(!1);this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0});if(this.videoWasPlaying){be(this.player_.play())}};r.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)};r.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)};r.handleAction=function(){if(this.player_.paused()){this.player_.play()}else{this.player_.pause()}};r.handleKeyDown=function(t){if(Ba.isEventKey(t,"Space")||Ba.isEventKey(t,"Enter")){t.preventDefault();t.stopPropagation();this.handleAction(t)}else if(Ba.isEventKey(t,"Home")){t.preventDefault();t.stopPropagation();this.player_.currentTime(0)}else if(Ba.isEventKey(t,"End")){t.preventDefault();t.stopPropagation();this.player_.currentTime(this.player_.duration())}else if(/^[0-9]$/.test(Ba(t))){t.preventDefault();t.stopPropagation();var a=10*(Ba.codes[Ba(t)]-Ba.codes[0])/100;this.player_.currentTime(this.player_.duration()*a)}else if(Ba.isEventKey(t,"PgDn")){t.preventDefault();t.stopPropagation();this.player_.currentTime(this.player_.currentTime()-5*Fr)}else if(Ba.isEventKey(t,"PgUp")){t.preventDefault();t.stopPropagation();this.player_.currentTime(this.player_.currentTime()+5*Fr)}else{e.prototype.handleKeyDown.call(this,t)}};return n}(Rr);Vr.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};if(!ua&&!ma){Vr.prototype.options_.children.splice(1,0,"mouseTimeDisplay")}ra.registerComponent("SeekBar",Vr);var qr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.handleMouseMove=zt(qt(o(o(n)),n.handleMouseMove),25);n.throttledHandleMouseSeek=zt(qt(o(o(n)),n.handleMouseSeek),25);n.enable();return n}var n=t.prototype;n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})};n.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var a=t.getChild("mouseTimeDisplay"),n=t.el(),r=j(n),i=H(n,e).x;if(1<i){i=1}else if(0>i){i=0}if(a){a.update(r,i)}}};n.handleMouseSeek=function(e){var t=this.getChild("seekBar");if(t){t.handleMouseMove(e)}};n.enabled=function(){return this.enabled_};n.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()});if(!this.enabled()){return}this.off(["mousedown","touchstart"],this.handleMouseDown);this.off(this.el_,"mousemove",this.handleMouseMove);this.handleMouseUp();this.addClass("disabled");this.enabled_=!1};n.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()});if(this.enabled()){return}this.on(["mousedown","touchstart"],this.handleMouseDown);this.on(this.el_,"mousemove",this.handleMouseMove);this.removeClass("disabled");this.enabled_=!0};n.handleMouseDown=function(e){var t=this.el_.ownerDocument,a=this.getChild("seekBar");if(a){a.handleMouseDown(e)}this.on(t,"mousemove",this.throttledHandleMouseSeek);this.on(t,"touchmove",this.throttledHandleMouseSeek);this.on(t,"mouseup",this.handleMouseUp);this.on(t,"touchend",this.handleMouseUp)};n.handleMouseUp=function(e){var t=this.el_.ownerDocument,a=this.getChild("seekBar");if(a){a.handleMouseUp(e)}this.off(t,"mousemove",this.throttledHandleMouseSeek);this.off(t,"touchmove",this.throttledHandleMouseSeek);this.off(t,"mouseup",this.handleMouseUp);this.off(t,"touchend",this.handleMouseUp)};return t}(ra);qr.prototype.options_={children:["seekBar"]};ra.registerComponent("ProgressControl",qr);var zr=function(e){a(n,e);function n(a,n){var r=e.call(this,a,n)||this;r.on(a,"fullscreenchange",r.handleFullscreenChange);if(!1===t[Ea.fullscreenEnabled]){r.disable()}return r}var r=n.prototype;r.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)};r.handleFullscreenChange=function(){if(this.player_.isFullscreen()){this.controlText("Non-Fullscreen")}else{this.controlText("Fullscreen")}};r.handleClick=function(){if(!this.player_.isFullscreen()){this.player_.requestFullscreen()}else{this.player_.exitFullscreen()}};return n}(Sr);zr.prototype.controlText_="Fullscreen";ra.registerComponent("FullscreenToggle",zr);var Gr=function(e,t){if(t.tech_&&!t.tech_.featuresVolumeControl){e.addClass("vjs-hidden")}e.on(t,"loadstart",function(){if(!t.tech_.featuresVolumeControl){e.addClass("vjs-hidden")}else{e.removeClass("vjs-hidden")}})},Wr=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:"<span class=\"vjs-control-text\"></span>"})};return t}(ra);ra.registerComponent("VolumeLevel",Wr);var Kr=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.on("slideractive",n.updateLastVolume_);n.on(t,"volumechange",n.updateARIAAttributes);t.ready(function(){return n.updateARIAAttributes()});return n}var n=t.prototype;n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})};n.handleMouseDown=function(t){if(!K(t)){return}e.prototype.handleMouseDown.call(this,t)};n.handleMouseMove=function(e){if(!K(e)){return}this.checkMuted();this.player_.volume(this.calculateDistance(e))};n.checkMuted=function(){if(this.player_.muted()){this.player_.muted(!1)}};n.getPercent=function(){if(this.player_.muted()){return 0}return this.player_.volume()};n.stepForward=function(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)};n.stepBack=function(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)};n.updateARIAAttributes=function(){var e=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",e);this.el_.setAttribute("aria-valuetext",e+"%")};n.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())};n.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){if(0===e.player_.volume()){e.player_.lastVolume_(t)}})};return t}(Rr);Kr.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};Kr.prototype.playerEvent="volumechange";ra.registerComponent("VolumeBar",Kr);var Yr=function(e){a(t,e);function t(t,a){var n;if(void 0===a){a={}}a.vertical=a.vertical||!1;if("undefined"==typeof a.volumeBar||h(a.volumeBar)){a.volumeBar=a.volumeBar||{};a.volumeBar.vertical=a.vertical}n=e.call(this,t,a)||this;Gr(o(o(n)),t);n.throttledHandleMouseMove=zt(qt(o(o(n)),n.handleMouseMove),25);n.on("mousedown",n.handleMouseDown);n.on("touchstart",n.handleMouseDown);n.on(n.volumeBar,["focus","slideractive"],function(){n.volumeBar.addClass("vjs-slider-active");n.addClass("vjs-slider-active");n.trigger("slideractive")});n.on(n.volumeBar,["blur","sliderinactive"],function(){n.volumeBar.removeClass("vjs-slider-active");n.removeClass("vjs-slider-active");n.trigger("sliderinactive")});return n}var n=t.prototype;n.createEl=function(){var t="vjs-volume-horizontal";if(this.options_.vertical){t="vjs-volume-vertical"}return e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})};n.handleMouseDown=function(){var e=this.el_.ownerDocument;this.on(e,"mousemove",this.throttledHandleMouseMove);this.on(e,"touchmove",this.throttledHandleMouseMove);this.on(e,"mouseup",this.handleMouseUp);this.on(e,"touchend",this.handleMouseUp)};n.handleMouseUp=function(){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseMove);this.off(e,"touchmove",this.throttledHandleMouseMove);this.off(e,"mouseup",this.handleMouseUp);this.off(e,"touchend",this.handleMouseUp)};n.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)};return t}(ra);Yr.prototype.options_={children:["volumeBar"]};ra.registerComponent("VolumeControl",Yr);var Xr=function(e,t){if(t.tech_&&!t.tech_.featuresMuteControl){e.addClass("vjs-hidden")}e.on(t,"loadstart",function(){if(!t.tech_.featuresMuteControl){e.addClass("vjs-hidden")}else{e.removeClass("vjs-hidden")}})},$r=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;Xr(o(o(n)),t);n.on(t,["loadstart","volumechange"],n.update);return n}var n=t.prototype;n.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)};n.handleClick=function(){var e=this.player_.volume(),t=this.player_.lastVolume_();if(0===e){var a=.1>t?.1:t;this.player_.volume(a);this.player_.muted(!1)}else{this.player_.muted(this.player_.muted()?!1:!0)}};n.update=function(){this.updateIcon_();this.updateControlText_()};n.updateIcon_=function(){var e=this.player_.volume(),t=3;if(ua&&this.player_.tech_&&this.player_.tech_.el_){this.player_.muted(this.player_.tech_.el_.muted)}if(0===e||this.player_.muted()){t=0}else if(.33>e){t=1}else if(.67>e){t=2}for(var a=0;4>a;a++){D(this.el_,"vjs-vol-"+a)}x(this.el_,"vjs-vol-"+t)};n.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume(),t=e?"Unmute":"Mute";if(this.controlText()!==t){this.controlText(t)}};return t}(Sr);$r.prototype.controlText_="Mute";ra.registerComponent("MuteToggle",$r);var Qr=function(e){a(t,e);function t(t,a){var n;if(void 0===a){a={}}if("undefined"!=typeof a.inline){a.inline=a.inline}else{a.inline=!0}if("undefined"==typeof a.volumeControl||h(a.volumeControl)){a.volumeControl=a.volumeControl||{};a.volumeControl.vertical=!a.inline}n=e.call(this,t,a)||this;n.on(t,["loadstart"],n.volumePanelState_);n.on(n.volumeControl,["slideractive"],n.sliderActive_);n.on(n.volumeControl,["sliderinactive"],n.sliderInactive_);return n}var n=t.prototype;n.sliderActive_=function(){this.addClass("vjs-slider-active")};n.sliderInactive_=function(){this.removeClass("vjs-slider-active")};n.volumePanelState_=function(){if(this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")){this.addClass("vjs-hidden")}if(this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")){this.addClass("vjs-mute-toggle-only")}};n.createEl=function(){var t="vjs-volume-panel-horizontal";if(!this.options_.inline){t="vjs-volume-panel-vertical"}return e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})};return t}(ra);Qr.prototype.options_={children:["muteToggle","volumeControl"]};ra.registerComponent("VolumePanel",Qr);var Jr=function(e){a(n,e);function n(t,a){var n=e.call(this,t,a)||this;if(a){n.menuButton_=a.menuButton}n.focusedChild_=-1;n.on("keydown",n.handleKeyDown);n.boundHandleBlur_=qt(o(o(n)),n.handleBlur);n.boundHandleTapClick_=qt(o(o(n)),n.handleTapClick);return n}var r=n.prototype;r.addEventListenerForItem=function(e){if(!(e instanceof ra)){return}this.on(e,"blur",this.boundHandleBlur_);this.on(e,["tap","click"],this.boundHandleTapClick_)};r.removeEventListenerForItem=function(e){if(!(e instanceof ra)){return}this.off(e,"blur",this.boundHandleBlur_);this.off(e,["tap","click"],this.boundHandleTapClick_)};r.removeChild=function(t){if("string"==typeof t){t=this.getChild(t)}this.removeEventListenerForItem(t);e.prototype.removeChild.call(this,t)};r.addItem=function(e){var t=this.addChild(e);if(t){this.addEventListenerForItem(t)}};r.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=E(t,{className:"vjs-menu-content"});this.contentEl_.setAttribute("role","menu");var a=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});a.appendChild(this.contentEl_);ae(a,"click",function(e){e.preventDefault();e.stopImmediatePropagation()});return a};r.dispose=function(){this.contentEl_=null;this.boundHandleBlur_=null;this.boundHandleTapClick_=null;e.prototype.dispose.call(this)};r.handleBlur=function(e){var a=e.relatedTarget||t.activeElement;if(!this.children().some(function(e){return e.el()===a})){var n=this.menuButton_;if(n&&n.buttonPressed_&&a!==n.el().firstChild){n.unpressButton()}}};r.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t)){return}var a=t.filter(function(t){return t.el()===e.target})[0];if(!a){return}if("CaptionSettingsMenuItem"!==a.name()){this.menuButton_.focus()}}};r.handleKeyDown=function(e){if(Ba.isEventKey(e,"Left")||Ba.isEventKey(e,"Down")){e.preventDefault();e.stopPropagation();this.stepForward()}else if(Ba.isEventKey(e,"Right")||Ba.isEventKey(e,"Up")){e.preventDefault();e.stopPropagation();this.stepBack()}};r.stepForward=function(){var e=0;if(this.focusedChild_!==void 0){e=this.focusedChild_+1}this.focus(e)};r.stepBack=function(){var e=0;if(this.focusedChild_!==void 0){e=this.focusedChild_-1}this.focus(e)};r.focus=function(e){if(void 0===e){e=0}var t=this.children().slice(),a=t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className);if(a){t.shift()}if(0<t.length){if(0>e){e=0}else if(e>=t.length){e=t.length-1}this.focusedChild_=e;t[e].el_.focus()}};return n}(ra);ra.registerComponent("Menu",Jr);var Zr=function(e){a(t,e);function t(t,a){var n;if(void 0===a){a={}}n=e.call(this,t,a)||this;n.menuButton_=new Sr(t,a);n.menuButton_.controlText(n.controlText_);n.menuButton_.el_.setAttribute("aria-haspopup","true");var r=Sr.prototype.buildCSSClass();n.menuButton_.el_.className=n.buildCSSClass()+" "+r;n.menuButton_.removeClass("vjs-control");n.addChild(n.menuButton_);n.update();n.enabled_=!0;n.on(n.menuButton_,"tap",n.handleClick);n.on(n.menuButton_,"click",n.handleClick);n.on(n.menuButton_,"keydown",n.handleKeyDown);n.on(n.menuButton_,"mouseenter",function(){n.menu.show()});n.on("keydown",n.handleSubmenuKeyDown);return n}var n=t.prototype;n.update=function(){var e=this.createMenu();if(this.menu){this.menu.dispose();this.removeChild(this.menu)}this.menu=e;this.addChild(e);this.buttonPressed_=!1;this.menuButton_.el_.setAttribute("aria-expanded","false");if(this.items&&this.items.length<=this.hideThreshold_){this.hide()}else{this.show()}};n.createMenu=function(){var e=new Jr(this.player_,{menuButton:this});this.hideThreshold_=0;if(this.options_.title){var t=E("li",{className:"vjs-menu-title",innerHTML:le(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var a=new ra(this.player_,{el:t});e.addItem(a)}this.items=this.createItems();if(this.items){for(var n=0;n<this.items.length;n++){e.addItem(this.items[n])}}return e};n.createItems=function(){};n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})};n.buildWrapperCSSClass=function(){var t="vjs-menu-button";if(!0===this.options_.inline){t+="-inline"}else{t+="-popup"}var a=Sr.prototype.buildCSSClass();return"vjs-menu-button "+t+" "+a+" "+e.prototype.buildCSSClass.call(this)};n.buildCSSClass=function(){var t="vjs-menu-button";if(!0===this.options_.inline){t+="-inline"}else{t+="-popup"}return"vjs-menu-button "+t+" "+e.prototype.buildCSSClass.call(this)};n.controlText=function(e,t){if(void 0===t){t=this.menuButton_.el()}return this.menuButton_.controlText(e,t)};n.handleClick=function(){if(this.buttonPressed_){this.unpressButton()}else{this.pressButton()}};n.focus=function(){this.menuButton_.focus()};n.blur=function(){this.menuButton_.blur()};n.handleKeyDown=function(e){if(Ba.isEventKey(e,"Esc")||Ba.isEventKey(e,"Tab")){if(this.buttonPressed_){this.unpressButton()}if(!Ba.isEventKey(e,"Tab")){e.preventDefault();this.menuButton_.focus()}}else if(Ba.isEventKey(e,"Up")||Ba.isEventKey(e,"Down")){if(!this.buttonPressed_){e.preventDefault();this.pressButton()}}};n.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)};n.handleSubmenuKeyDown=function(e){if(Ba.isEventKey(e,"Esc")||Ba.isEventKey(e,"Tab")){if(this.buttonPressed_){this.unpressButton()}if(!Ba.isEventKey(e,"Tab")){e.preventDefault();this.menuButton_.focus()}}};n.pressButton=function(){if(this.enabled_){this.buttonPressed_=!0;this.menu.show();this.menu.lockShowing();this.menuButton_.el_.setAttribute("aria-expanded","true");if(ua&&k()){return}this.menu.focus()}};n.unpressButton=function(){if(this.enabled_){this.buttonPressed_=!1;this.menu.unlockShowing();this.menu.hide();this.menuButton_.el_.setAttribute("aria-expanded","false")}};n.disable=function(){this.unpressButton();this.enabled_=!1;this.addClass("vjs-disabled");this.menuButton_.disable()};n.enable=function(){this.enabled_=!0;this.removeClass("vjs-disabled");this.menuButton_.enable()};return t}(ra);ra.registerComponent("MenuButton",Zr);var ei=function(e){a(t,e);function t(t,a){var n,r=a.tracks;n=e.call(this,t,a)||this;if(1>=n.items.length){n.hide()}if(!r){return o(n)}var i=qt(o(o(n)),n.update);r.addEventListener("removetrack",i);r.addEventListener("addtrack",i);n.player_.on("ready",i);n.player_.on("dispose",function(){r.removeEventListener("removetrack",i);r.removeEventListener("addtrack",i)});return n}return t}(Zr);ra.registerComponent("TrackButton",ei);var ti=["Tab","Esc","Up","Down","Right","Left"],ai=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.selectable=a.selectable;n.isSelected_=a.selected||!1;n.multiSelectable=a.multiSelectable;n.selected(n.isSelected_);if(n.selectable){if(n.multiSelectable){n.el_.setAttribute("role","menuitemcheckbox")}else{n.el_.setAttribute("role","menuitemradio")}}else{n.el_.setAttribute("role","menuitem")}return n}var n=t.prototype;n.createEl=function(t,a,n){this.nonIconControl=!0;return e.prototype.createEl.call(this,"li",m({className:"vjs-menu-item",innerHTML:"<span class=\"vjs-menu-item-text\">"+this.localize(this.options_.label)+"</span>",tabIndex:-1},a),n)};n.handleKeyDown=function(t){if(!ti.some(function(e){return Ba.isEventKey(t,e)})){e.prototype.handleKeyDown.call(this,t)}};n.handleClick=function(){this.selected(!0)};n.selected=function(e){if(this.selectable){if(e){this.addClass("vjs-selected");this.el_.setAttribute("aria-checked","true");this.controlText(", selected");this.isSelected_=!0}else{this.removeClass("vjs-selected");this.el_.setAttribute("aria-checked","false");this.controlText("");this.isSelected_=!1}}};return t}(yr);ra.registerComponent("MenuItem",ai);var ni=function(n){a(r,n);function r(a,r){var i,s=r.track,d=a.textTracks();r.label=s.label||s.language||"Unknown";r.selected="showing"===s.mode;i=n.call(this,a,r)||this;i.track=s;i.kinds=(r.kinds||[r.kind||i.track.kind]).filter(Boolean);var l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++){t[a]=arguments[a]}i.handleTracksChange.apply(o(o(i)),t)},p=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++){t[a]=arguments[a]}i.handleSelectedLanguageChange.apply(o(o(i)),t)};a.on(["loadstart","texttrackchange"],l);d.addEventListener("change",l);d.addEventListener("selectedlanguagechange",p);i.on("dispose",function(){a.off(["loadstart","texttrackchange"],l);d.removeEventListener("change",l);d.removeEventListener("selectedlanguagechange",p)});if(d.onchange===void 0){var u;i.on(["tap","click"],function(){if("object"!==_typeof(e.Event)){try{u=new e.Event("change")}catch(e){}}if(!u){u=t.createEvent("Event");u.initEvent("change",!0,!0)}d.dispatchEvent(u)})}i.handleTracksChange();return i}var i=r.prototype;i.handleClick=function(e){var t=this.track,a=this.player_.textTracks();n.prototype.handleClick.call(this,e);if(!a){return}for(var r=0,s;r<a.length;r++){s=a[r];if(-1===this.kinds.indexOf(s.kind)){continue}if(s===t){if("showing"!==s.mode){s.mode="showing"}}else if("disabled"!==s.mode){s.mode="disabled"}}};i.handleTracksChange=function(){var e="showing"===this.track.mode;if(e!==this.isSelected_){this.selected(e)}};i.handleSelectedLanguageChange=function(){if("showing"===this.track.mode){var e=this.player_.cache_.selectedLanguage;if(e&&e.enabled&&e.language===this.track.language&&e.kind!==this.track.kind){return}this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}};i.dispose=function(){this.track=null;n.prototype.dispose.call(this)};return r}(ai);ra.registerComponent("TextTrackMenuItem",ni);var ri=function(e){a(t,e);function t(t,a){a.track={player:t,kind:a.kind,kinds:a.kinds,default:!1,mode:"disabled"};if(!a.kinds){a.kinds=[a.kind]}if(a.label){a.track.label=a.label}else{a.track.label=a.kinds.join(" and ")+" off"}a.selectable=!0;a.multiSelectable=!1;return e.call(this,t,a)||this}var n=t.prototype;n.handleTracksChange=function(){for(var e=this.player().textTracks(),t=!0,a=0,n=e.length,r;a<n;a++){r=e[a];if(-1<this.options_.kinds.indexOf(r.kind)&&"showing"===r.mode){t=!1;break}}if(t!==this.isSelected_){this.selected(t)}};n.handleSelectedLanguageChange=function(){for(var e=this.player().textTracks(),t=!0,a=0,n=e.length,r;a<n;a++){r=e[a];if(-1<["captions","descriptions","subtitles"].indexOf(r.kind)&&"showing"===r.mode){t=!1;break}}if(t){this.player_.cache_.selectedLanguage={enabled:!1}}};return t}(ni);ra.registerComponent("OffTextTrackMenuItem",ri);var ii=function(e){a(t,e);function t(t,a){if(void 0===a){a={}}a.tracks=t.textTracks();return e.call(this,t,a)||this}var n=t.prototype;n.createItems=function(e,t){if(void 0===e){e=[]}if(void 0===t){t=ni}var a;if(this.label_){a=this.label_+" off"}e.push(new ri(this.player_,{kinds:this.kinds_,kind:this.kind_,label:a}));this.hideThreshold_+=1;var n=this.player_.textTracks();if(!Array.isArray(this.kinds_)){this.kinds_=[this.kind_]}for(var r=0,s;r<n.length;r++){s=n[r];if(-1<this.kinds_.indexOf(s.kind)){var o=new t(this.player_,{track:s,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+s.kind+"-menu-item");e.push(o)}}return e};return t}(ei);ra.registerComponent("TextTrackButton",ii);var si=function(e){a(t,e);function t(t,a){var n,r=a.track,i=a.cue,s=t.currentTime();a.selectable=!0;a.multiSelectable=!1;a.label=i.text;a.selected=i.startTime<=s&&s<i.endTime;n=e.call(this,t,a)||this;n.track=r;n.cue=i;r.addEventListener("cuechange",qt(o(o(n)),n.update));return n}var n=t.prototype;n.handleClick=function(){e.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)};n.update=function(){var e=this.cue,t=this.player_.currentTime();this.selected(e.startTime<=t&&t<e.endTime)};return t}(ai);ra.registerComponent("ChaptersTrackMenuItem",si);var oi=function(e){a(t,e);function t(t,a,n){return e.call(this,t,a,n)||this}var n=t.prototype;n.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)};n.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)};n.update=function(t){if(!this.track_||t&&("addtrack"===t.type||"removetrack"===t.type)){this.setTrack(this.findChaptersTrack())}e.prototype.update.call(this)};n.setTrack=function(e){if(this.track_===e){return}if(!this.updateHandler_){this.updateHandler_=this.update.bind(this)}if(this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(t){t.removeEventListener("load",this.updateHandler_)}this.track_=null}this.track_=e;if(this.track_){this.track_.mode="hidden";var a=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(a){a.addEventListener("load",this.updateHandler_)}}};n.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1,a;0<=t;t--){a=e[t];if(a.kind===this.kind_){return a}}};n.getMenuCaption=function(){if(this.track_&&this.track_.label){return this.track_.label}return this.localize(le(this.kind_))};n.createMenu=function(){this.options_.title=this.getMenuCaption();return e.prototype.createMenu.call(this)};n.createItems=function(){var e=[];if(!this.track_){return e}var t=this.track_.cues;if(!t){return e}for(var a=0,n=t.length;a<n;a++){var r=t[a],s=new si(this.player_,{track:this.track_,cue:r});e.push(s)}return e};return t}(ii);oi.prototype.kind_="chapters";oi.prototype.controlText_="Chapters";ra.registerComponent("ChaptersButton",oi);var di=function(e){a(t,e);function t(t,a,n){var r=e.call(this,t,a,n)||this;var i=t.textTracks(),s=qt(o(o(r)),r.handleTracksChange);i.addEventListener("change",s);r.on("dispose",function(){i.removeEventListener("change",s)});return r}var n=t.prototype;n.handleTracksChange=function(){for(var e=this.player().textTracks(),t=!1,a=0,n=e.length,r;a<n;a++){r=e[a];if(r.kind!==this.kind_&&"showing"===r.mode){t=!0;break}}if(t){this.disable()}else{this.enable()}};n.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)};n.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)};return t}(ii);di.prototype.kind_="descriptions";di.prototype.controlText_="Descriptions";ra.registerComponent("DescriptionsButton",di);var li=function(e){a(t,e);function t(t,a,n){return e.call(this,t,a,n)||this}var n=t.prototype;n.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)};n.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)};return t}(ii);li.prototype.kind_="subtitles";li.prototype.controlText_="Subtitles";ra.registerComponent("SubtitlesButton",li);var pi=function(e){a(t,e);function t(t,a){var n;a.track={player:t,kind:a.kind,label:a.kind+" settings",selectable:!1,default:!1,mode:"disabled"};a.selectable=!1;a.name="CaptionSettingsMenuItem";n=e.call(this,t,a)||this;n.addClass("vjs-texttrack-settings");n.controlText(", opens "+a.kind+" settings dialog");return n}var n=t.prototype;n.handleClick=function(){this.player().getChild("textTrackSettings").open()};return t}(ni);ra.registerComponent("CaptionSettingsMenuItem",pi);var ui=function(e){a(t,e);function t(t,a,n){return e.call(this,t,a,n)||this}var n=t.prototype;n.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)};n.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)};n.createItems=function(){var t=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){t.push(new pi(this.player_,{kind:this.kind_}));this.hideThreshold_+=1}return e.prototype.createItems.call(this,t)};return t}(ii);ui.prototype.kind_="captions";ui.prototype.controlText_="Captions";ra.registerComponent("CaptionsButton",ui);var ci=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createEl=function(t,a,n){var r="<span class=\"vjs-menu-item-text\">"+this.localize(this.options_.label);if("captions"===this.options_.track.kind){r+="\n        <span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>\n        <span class=\"vjs-control-text\"> "+this.localize("Captions")+"</span>\n      "}r+="</span>";var i=e.prototype.createEl.call(this,t,m({innerHTML:r},a),n);return i};return t}(ni);ra.registerComponent("SubsCapsMenuItem",ci);var mi=function(e){a(t,e);function t(t,a){var n;if(void 0===a){a={}}n=e.call(this,t,a)||this;n.label_="subtitles";if(-1<["en","en-us","en-ca","fr-ca"].indexOf(n.player_.language_)){n.label_="captions"}n.menuButton_.controlText(le(n.label_));return n}var n=t.prototype;n.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)};n.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)};n.createItems=function(){var t=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){t.push(new pi(this.player_,{kind:this.label_}));this.hideThreshold_+=1}t=e.prototype.createItems.call(this,t,ci);return t};return t}(ii);mi.prototype.kinds_=["captions","subtitles"];mi.prototype.controlText_="Subtitles";ra.registerComponent("SubsCapsButton",mi);var gi=function(e){a(t,e);function t(t,a){var n,r=a.track,i=t.audioTracks();a.label=r.label||r.language||"Unknown";a.selected=r.enabled;n=e.call(this,t,a)||this;n.track=r;n.addClass("vjs-"+r.kind+"-menu-item");var s=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++){t[a]=arguments[a]}n.handleTracksChange.apply(o(o(n)),t)};i.addEventListener("change",s);n.on("dispose",function(){i.removeEventListener("change",s)});return n}var n=t.prototype;n.createEl=function(t,a,n){var r="<span class=\"vjs-menu-item-text\">"+this.localize(this.options_.label);if("main-desc"===this.options_.track.kind){r+="\n        <span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>\n        <span class=\"vjs-control-text\"> "+this.localize("Descriptions")+"</span>\n      "}r+="</span>";var i=e.prototype.createEl.call(this,t,m({innerHTML:r},a),n);return i};n.handleClick=function(t){var a=this.player_.audioTracks();e.prototype.handleClick.call(this,t);for(var n=0,r;n<a.length;n++){r=a[n];r.enabled=r===this.track}};n.handleTracksChange=function(){this.selected(this.track.enabled)};return t}(ai);ra.registerComponent("AudioTrackMenuItem",gi);var hi=function(e){a(t,e);function t(t,a){if(void 0===a){a={}}a.tracks=t.audioTracks();return e.call(this,t,a)||this}var n=t.prototype;n.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)};n.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)};n.createItems=function(e){if(void 0===e){e=[]}this.hideThreshold_=1;for(var t=this.player_.audioTracks(),a=0,n;a<t.length;a++){n=t[a];e.push(new gi(this.player_,{track:n,selectable:!0,multiSelectable:!1}))}return e};return t}(ei);hi.prototype.controlText_="Audio Track";ra.registerComponent("AudioTrackButton",hi);var yi=function(e){a(t,e);function t(t,a){var n,r=a.rate,i=parseFloat(r,10);a.label=r;a.selected=1===i;a.selectable=!0;a.multiSelectable=!1;n=e.call(this,t,a)||this;n.label=r;n.rate=i;n.on(t,"ratechange",n.update);return n}var n=t.prototype;n.handleClick=function(){e.prototype.handleClick.call(this);this.player().playbackRate(this.rate)};n.update=function(){this.selected(this.player().playbackRate()===this.rate)};return t}(ai);yi.prototype.contentElType="button";ra.registerComponent("PlaybackRateMenuItem",yi);var fi=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.updateVisibility();n.updateLabel();n.on(t,"loadstart",n.updateVisibility);n.on(t,"ratechange",n.updateLabel);return n}var n=t.prototype;n.createEl=function(){var t=e.prototype.createEl.call(this);this.labelEl_=E("div",{className:"vjs-playback-rate-value",innerHTML:"1x"});t.appendChild(this.labelEl_);return t};n.dispose=function(){this.labelEl_=null;e.prototype.dispose.call(this)};n.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)};n.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)};n.createMenu=function(){var e=new Jr(this.player()),t=this.playbackRates();if(t){for(var a=t.length-1;0<=a;a--){e.addChild(new yi(this.player(),{rate:t[a]+"x"}))}}return e};n.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())};n.handleClick=function(){for(var e=this.player().playbackRate(),t=this.playbackRates(),a=t[0],n=0;n<t.length;n++){if(t[n]>e){a=t[n];break}}this.player().playbackRate(a)};n.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates};n.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length};n.updateVisibility=function(){if(this.playbackRateSupported()){this.removeClass("vjs-hidden")}else{this.addClass("vjs-hidden")}};n.updateLabel=function(){if(this.playbackRateSupported()){this.labelEl_.innerHTML=this.player().playbackRate()+"x"}};return t}(Zr);fi.prototype.controlText_="Playback Rate";ra.registerComponent("PlaybackRateMenuButton",fi);var bi=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)};n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})};return t}(ra);ra.registerComponent("Spacer",bi);var Ti=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)};n.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});t.innerHTML="\xA0";return t};return t}(bi);ra.registerComponent("CustomControlSpacer",Ti);var vi=function(e){a(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})};return t}(ra);vi.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};ra.registerComponent("ControlBar",vi);var Si=function(e){a(t,e);function t(t,a){var n=e.call(this,t,a)||this;n.on(t,"error",n.open);return n}var n=t.prototype;n.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)};n.content=function(){var e=this.player().error();return e?this.localize(e.message):""};return t}(za);Si.prototype.options_=ue(za.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});ra.registerComponent("ErrorDisplay",Si);var ki=["#000","Black"],Ci=["#00F","Blue"],Ei=["#0FF","Cyan"],Li=["#0F0","Green"],Ii=["#F0F","Magenta"],Pi=["#F00","Red"],xi=["#FFF","White"],Di=["#FF0","Yellow"],Ai=["1","Opaque"],wi=["0.5","Semi-Transparent"],Oi=["0","Transparent"],Ui={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[ki,xi,Pi,Li,Ci,Di,Ii,Ei]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Ai,wi,Oi]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[xi,ki,Pi,Li,Ci,Di,Ii,Ei]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:+e}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Ai,wi]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Oi,wi,Ai]}};Ui.windowColor.options=Ui.backgroundColor.options;function dt(e,t){if(t){e=t(e)}if(e&&"none"!==e){return e}}function lt(e,t){var a=e.options[e.options.selectedIndex].value;return dt(a,t)}function pt(e,t,a){if(!t){return}for(var n=0;n<e.options.length;n++){if(dt(e.options[n].value,a)===t){e.selectedIndex=n;break}}}var Ri=function(t){a(n,t);function n(e,a){var n;a.temporary=!1;n=t.call(this,e,a)||this;n.updateDisplay=qt(o(o(n)),n.updateDisplay);n.fill();n.hasBeenOpened_=n.hasBeenFilled_=!0;n.endDialog=E("p",{className:"vjs-control-text",textContent:n.localize("End of dialog window.")});n.el().appendChild(n.endDialog);n.setDefaults();if(a.persistTextTrackSettings===void 0){n.options_.persistTextTrackSettings=n.options_.playerOptions.persistTextTrackSettings}n.on(n.$(".vjs-done-button"),"click",function(){n.saveSettings();n.close()});n.on(n.$(".vjs-default-button"),"click",function(){n.setDefaults();n.updateDisplay()});u(Ui,function(e){n.on(n.$(e.selector),"change",n.updateDisplay)});if(n.options_.persistTextTrackSettings){n.restoreSettings()}return n}var r=n.prototype;r.dispose=function(){this.endDialog=null;t.prototype.dispose.call(this)};r.createElSelect_=function(e,t,a){var n=this;if(void 0===t){t=""}if(void 0===a){a="label"}var r=Ui[e],i=r.id.replace("%s",this.id_),s=[t,i].join(" ").trim();return["<"+a+" id=\""+i+"\" class=\""+("label"===a?"vjs-label":"")+"\">",this.localize(r.label),"</"+a+">","<select aria-labelledby=\""+s+"\">"].concat(r.options.map(function(e){var t=i+"-"+e[1].replace(/\W+/g,"");return["<option id=\""+t+"\" value=\""+e[0]+"\" ","aria-labelledby=\""+s+" "+t+"\">",n.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")};r.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return["<fieldset class=\"vjs-fg-color vjs-track-setting\">","<legend id=\""+e+"\">",this.localize("Text"),"</legend>",this.createElSelect_("color",e),"<span class=\"vjs-text-opacity vjs-opacity\">",this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")};r.createElBgColor_=function(){var e="captions-background-"+this.id_;return["<fieldset class=\"vjs-bg-color vjs-track-setting\">","<legend id=\""+e+"\">",this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),"<span class=\"vjs-bg-opacity vjs-opacity\">",this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")};r.createElWinColor_=function(){var e="captions-window-"+this.id_;return["<fieldset class=\"vjs-window-color vjs-track-setting\">","<legend id=\""+e+"\">",this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),"<span class=\"vjs-window-opacity vjs-opacity\">",this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")};r.createElColors_=function(){return E("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})};r.createElFont_=function(){return E("div",{className:"vjs-track-settings-font",innerHTML:["<fieldset class=\"vjs-font-percent vjs-track-setting\">",this.createElSelect_("fontPercent","","legend"),"</fieldset>","<fieldset class=\"vjs-edge-style vjs-track-setting\">",this.createElSelect_("edgeStyle","","legend"),"</fieldset>","<fieldset class=\"vjs-font-family vjs-track-setting\">",this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})};r.createElControls_=function(){var e=this.localize("restore all settings to the default values");return E("div",{className:"vjs-track-settings-controls",innerHTML:["<button type=\"button\" class=\"vjs-default-button\" title=\""+e+"\">",this.localize("Reset"),"<span class=\"vjs-control-text\"> "+e+"</span>","</button>","<button type=\"button\" class=\"vjs-done-button\">"+this.localize("Done")+"</button>"].join("")})};r.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]};r.label=function(){return this.localize("Caption Settings Dialog")};r.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")};r.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"};r.getValues=function(){var e=this;return c(Ui,function(t,a,n){var r=lt(e.$(a.selector),a.parser);if(r!==void 0){t[n]=r}return t},{})};r.setValues=function(e){var t=this;u(Ui,function(a,n){pt(t.$(a.selector),e[n],a.parser)})};r.setDefaults=function(){var e=this;u(Ui,function(t){var a=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=a})};r.restoreSettings=function(){var t;try{t=JSON.parse(e.localStorage.getItem("vjs-text-track-settings"))}catch(e){Et.warn(e)}if(t){this.setValues(t)}};r.saveSettings=function(){if(!this.options_.persistTextTrackSettings){return}var t=this.getValues();try{if(Object.keys(t).length){e.localStorage.setItem("vjs-text-track-settings",JSON.stringify(t))}else{e.localStorage.removeItem("vjs-text-track-settings")}}catch(e){Et.warn(e)}};r.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");if(e){e.updateDisplay()}};r.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,a=e&&e.captionsButton;if(t){t.focus()}else if(a){a.focus()}};return n}(za);ra.registerComponent("TextTrackSettings",Ri);var Mi=function(t){a(n,t);function n(a,n){var r,i=n.ResizeObserver||e.ResizeObserver;if(null===n.ResizeObserver){i=!1}var s=ue({createEl:!i,reportTouchActivity:!1},n);r=t.call(this,a,s)||this;r.ResizeObserver=n.ResizeObserver||e.ResizeObserver;r.loadListener_=null;r.resizeObserver_=null;r.debouncedHandler_=Gt(function(){r.resizeHandler()},100,!1,o(o(r)));if(i){r.resizeObserver_=new r.ResizeObserver(r.debouncedHandler_);r.resizeObserver_.observe(a.el())}else{r.loadListener_=function(){if(!r.el_||!r.el_.contentWindow){return}var e=r.debouncedHandler_,t=r.unloadListener_=function(){ne(this,"resize",e);ne(this,"unload",t);t=null};ae(r.el_.contentWindow,"unload",t);ae(r.el_.contentWindow,"resize",e)};r.one("load",r.loadListener_)}return r}var r=n.prototype;r.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})};r.resizeHandler=function(){if(!this.player_||!this.player_.trigger){return}this.player_.trigger("playerresize")};r.dispose=function(){if(this.debouncedHandler_){this.debouncedHandler_.cancel()}if(this.resizeObserver_){if(this.player_.el()){this.resizeObserver_.unobserve(this.player_.el())}this.resizeObserver_.disconnect()}if(this.loadListener_){this.off("load",this.loadListener_)}if(this.el_&&this.el_.contentWindow&&this.unloadListener_){this.unloadListener_.call(this.el_.contentWindow)}this.ResizeObserver=null;this.resizeObserver=null;this.debouncedHandler_=null;this.loadListener_=null;t.prototype.dispose.call(this)};return n}(ra);ra.registerComponent("ResizeManager",Mi);var Bi=function(e){a(n,e);function n(a,n){var r,i=ue({createEl:!1},n);r=e.call(this,a,i)||this;r.reset_();r.on(r.player_,"durationchange",r.handleDurationchange);if(Ta&&"hidden"in t&&"visibilityState"in t){r.on(t,"visibilitychange",r.handleVisibilityChange)}return r}var r=n.prototype;r.handleVisibilityChange=function(){if(this.player_.duration()!==1/0){return}if(t.hidden){this.stopTracking()}else{this.startTracking()}};r.isBehind_=function(){if(!this.timeupdateSeen_){return!1}var e=this.liveCurrentTime(),t=this.player_.currentTime(),a=this.seekableIncrement_;return e!==1/0&&e-(2*a+.07)>=t};r.trackLive_=function(){this.pastSeekEnd_=this.pastSeekEnd_;var e=this.player_.seekable();if(!e||!e.length){return}var t=this.seekableEnd();if(t!==this.lastSeekEnd_){if(this.lastSeekEnd_){this.seekableIncrement_=Math.abs(t-this.lastSeekEnd_)}this.pastSeekEnd_=0;this.lastSeekEnd_=t;this.trigger("seekableendchange")}this.pastSeekEnd_=this.pastSeekEnd()+.03;if(this.isBehind_()!==this.behindLiveEdge()){this.behindLiveEdge_=this.isBehind_();this.trigger("liveedgechange")}};r.handleDurationchange=function(){if(this.player_.duration()===1/0){this.startTracking()}else{this.stopTracking()}};r.startTracking=function(){var e=this;if(this.isTracking()){return}this.trackingInterval_=this.setInterval(this.trackLive_,30);this.trackLive_();this.on(this.player_,"play",this.trackLive_);this.on(this.player_,"pause",this.trackLive_);this.one(this.player_,"play",this.handlePlay);if(!this.timeupdateSeen_){this.handleTimeupdate=function(){e.timeupdateSeen_=!0;e.handleTimeupdate=null};this.one(this.player_,"timeupdate",this.handleTimeupdate)}};r.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)};r.reset_=function(){this.pastSeekEnd_=0;this.lastSeekEnd_=null;this.behindLiveEdge_=null;this.timeupdateSeen_=!1;this.clearInterval(this.trackingInterval_);this.trackingInterval_=null;this.seekableIncrement_=12;this.off(this.player_,"play",this.trackLive_);this.off(this.player_,"pause",this.trackLive_);this.off(this.player_,"play",this.handlePlay);this.off(this.player_,"timeupdate",this.seekToLiveEdge);if(this.handleTimeupdate){this.off(this.player_,"timeupdate",this.handleTimeupdate);this.handleTimeupdate=null}};r.stopTracking=function(){if(!this.isTracking()){return}this.reset_()};r.seekableEnd=function(){var e=this.player_.seekable(),t=[],a=e?e.length:0;while(a--){t.push(e.end(a))}return t.length?t.sort()[t.length-1]:1/0};r.seekableStart=function(){var e=this.player_.seekable(),t=[],a=e?e.length:0;while(a--){t.push(e.start(a))}return t.length?t.sort()[0]:0};r.liveWindow=function(){var e=this.liveCurrentTime();if(e===1/0){return 1/0}return e-this.seekableStart()};r.isLive=function(){return this.isTracking()};r.atLiveEdge=function(){return!this.behindLiveEdge()};r.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()};r.pastSeekEnd=function(){return this.pastSeekEnd_};r.behindLiveEdge=function(){return this.behindLiveEdge_};r.isTracking=function(){return"number"==typeof this.trackingInterval_};r.seekToLiveEdge=function(){if(this.atLiveEdge()){return}this.player_.currentTime(this.liveCurrentTime());if(this.player_.paused()){this.player_.play()}};r.dispose=function(){this.stopTracking();e.prototype.dispose.call(this)};return n}(ra);ra.registerComponent("LiveTracker",Bi);var Ni=function(e){var t=e.el();if(t.hasAttribute("src")){e.triggerSourceset(t.src);return!0}var a=e.$$("source"),n=[],r="";if(!a.length){return!1}for(var s=0,o;s<a.length;s++){o=a[s].src;if(o&&-1===n.indexOf(o)){n.push(o)}}if(!n.length){return!1}if(1===n.length){r=n[0]}e.triggerSourceset(r);return!0},ji=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(a){var n=t.createElement(this.nodeName.toLowerCase());n.innerHTML=a;var r=t.createDocumentFragment();while(n.childNodes.length){r.appendChild(n.childNodes[0])}this.innerText="";e.Element.prototype.appendChild.call(this,r);return this.innerHTML}}),Fi=function(e,t){for(var a={},n=0;n<e.length;n++){a=Object.getOwnPropertyDescriptor(e[n],t);if(a&&a.set&&a.get){break}}a.enumerable=!0;a.configurable=!0;return a},Hi=function(t){return Fi([t.el(),e.HTMLMediaElement.prototype,e.Element.prototype,ji],"innerHTML")},Vi=function(e){var t=e.el();if(t.resetSourceWatch_){return}var a={},n=Hi(e),r=function(a){return function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++){r[i]=arguments[i]}var s=a.apply(t,r);Ni(e);return s}};["append","appendChild","insertAdjacentHTML"].forEach(function(e){if(!t[e]){return}a[e]=t[e];t[e]=r(a[e])});Object.defineProperty(t,"innerHTML",ue(n,{set:r(n.set)}));t.resetSourceWatch_=function(){t.resetSourceWatch_=null;Object.keys(a).forEach(function(e){t[e]=a[e]});Object.defineProperty(t,"innerHTML",n)};e.one("sourceset",t.resetSourceWatch_)},qi=Object.defineProperty({},"src",{get:function(){if(this.hasAttribute("src")){return on(e.Element.prototype.getAttribute.call(this,"src"))}return""},set:function(t){e.Element.prototype.setAttribute.call(this,"src",t);return t}}),zi=function(t){return Fi([t.el(),e.HTMLMediaElement.prototype,qi],"src")},Gi=function(e){if(!e.featuresSourceset){return}var t=e.el();if(t.resetSourceset_){return}var a=zi(e),r=t.setAttribute,i=t.load;Object.defineProperty(t,"src",ue(a,{set:function(n){var r=a.set.call(t,n);e.triggerSourceset(t.src);return r}}));t.setAttribute=function(a,n){var i=r.call(t,a,n);if(/src/i.test(a)){e.triggerSourceset(t.src)}return i};t.load=function(){var a=i.call(t);if(!Ni(e)){e.triggerSourceset("");Vi(e)}return a};if(t.currentSrc){e.triggerSourceset(t.currentSrc)}else if(!Ni(e)){Vi(e)}t.resetSourceset_=function(){t.resetSourceset_=null;t.load=i;t.setAttribute=r;Object.defineProperty(t,"src",a);if(t.resetSourceWatch_){t.resetSourceWatch_()}}};function ut(){var e=d(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);ut=function(){return e};return e}var Wi=function(n){a(r,n);function r(e,t){var a=n.call(this,e,t)||this;var r=e.source,s=!1;if(r&&(a.el_.currentSrc!==r.src||e.tag&&3===e.tag.initNetworkState_)){a.setSource(r)}else{a.handleLateInit_(a.el_)}if(e.enableSourceset){a.setupSourcesetHandling_()}if(a.el_.hasChildNodes()){var o=a.el_.childNodes,d=o.length,l=[];while(d--){var p=o[d],u=p.nodeName.toLowerCase();if("track"===u){if(!a.featuresNativeTextTracks){l.push(p)}else{a.remoteTextTrackEls().addTrackElement_(p);a.remoteTextTracks().addTrack(p.track);a.textTracks().addTrack(p.track);if(!s&&!a.el_.hasAttribute("crossorigin")&&ln(p.src)){s=!0}}}}for(var c=0;c<l.length;c++){a.el_.removeChild(l[c])}}a.proxyNativeTracks_();if(a.featuresNativeTextTracks&&s){Et.warn(It(ut()))}a.restoreMetadataTracksInIOSNativePlayer_();if((ka||la||ha)&&!0===e.nativeControlsForTouch){a.setControls(!0)}a.proxyWebkitFullscreen_();a.triggerReady();return a}var i=r.prototype;i.dispose=function(){if(this.el_&&this.el_.resetSourceset_){this.el_.resetSourceset_()}r.disposeMediaElement(this.el_);this.options_=null;n.prototype.dispose.call(this)};i.setupSourcesetHandling_=function(){Gi(this)};i.restoreMetadataTracksInIOSNativePlayer_=function(){var e=this.textTracks(),t,a=function(){t=[];for(var a=0,n;a<e.length;a++){n=e[a];if("metadata"===n.kind){t.push({track:n,storedMode:n.mode})}}};a();e.addEventListener("change",a);this.on("dispose",function(){return e.removeEventListener("change",a)});var n=function a(){for(var n=0,r;n<t.length;n++){r=t[n];if("disabled"===r.track.mode&&r.track.mode!==r.storedMode){r.track.mode=r.storedMode}}e.removeEventListener("change",a)};this.on("webkitbeginfullscreen",function(){e.removeEventListener("change",a);e.removeEventListener("change",n);e.addEventListener("change",n)});this.on("webkitendfullscreen",function(){e.removeEventListener("change",a);e.addEventListener("change",a);e.removeEventListener("change",n)})};i.overrideNative_=function(e,t){var a=this;if(t!==this["featuresNative"+e+"Tracks"]){return}var n=e.toLowerCase();if(this[n+"TracksListeners_"]){Object.keys(this[n+"TracksListeners_"]).forEach(function(e){var t=a.el()[n+"Tracks"];t.removeEventListener(e,a[n+"TracksListeners_"][e])})}this["featuresNative"+e+"Tracks"]=!t;this[n+"TracksListeners_"]=null;this.proxyNativeTracksForType_(n)};i.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)};i.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)};i.proxyNativeTracksForType_=function(e){var t=this,a=Hn[e],n=this.el()[a.getterName],r=this[a.getterName]();if(!this["featuresNative"+a.capitalName+"Tracks"]||!n||!n.addEventListener){return}var i={change:function(){r.trigger({type:"change",target:r,currentTarget:r,srcElement:r})},addtrack:function(t){r.addTrack(t.track)},removetrack:function(t){r.removeTrack(t.track)}},s=function(){for(var e=[],t=0,a;t<r.length;t++){a=!1;for(var s=0;s<n.length;s++){if(n[s]===r[t]){a=!0;break}}if(!a){e.push(r[t])}}while(e.length){r.removeTrack(e.shift())}};this[a.getterName+"Listeners_"]=i;Object.keys(i).forEach(function(e){var a=i[e];n.addEventListener(e,a);t.on("dispose",function(){return n.removeEventListener(e,a)})});this.on("loadstart",s);this.on("dispose",function(){return t.off("loadstart",s)})};i.proxyNativeTracks_=function(){var e=this;Hn.names.forEach(function(t){e.proxyNativeTracksForType_(t)})};i.createEl=function(){var e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){var a=e.cloneNode(!0);if(e.parentNode){e.parentNode.insertBefore(a,e)}r.disposeMediaElement(e);e=a}else{e=t.createElement("video");var n=this.options_.tag&&O(this.options_.tag),s=ue({},n);if(!ka||!0!==this.options_.nativeControlsForTouch){delete s.controls}w(e,m(s,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}if("undefined"!=typeof this.options_.preload){R(e,"preload",this.options_.preload)}for(var o=["loop","muted","playsinline","autoplay"],d=0;d<o.length;d++){var l=o[d],p=this.options_[l];if("undefined"!=typeof p){if(p){R(e,l,l)}else{M(e,l)}e[l]=p}}return e};i.handleLateInit_=function(e){if(0===e.networkState||3===e.networkState){return}if(0===e.readyState){var t=!1,a=function(){t=!0};this.on("loadstart",a);var n=function(){if(!t){this.trigger("loadstart")}};this.on("loadedmetadata",n);this.ready(function(){this.off("loadstart",a);this.off("loadedmetadata",n);if(!t){this.trigger("loadstart")}});return}var r=["loadstart","loadedmetadata"];if(2<=e.readyState){r.push("loadeddata")}if(3<=e.readyState){r.push("canplay")}if(4<=e.readyState){r.push("canplaythrough")}this.ready(function(){r.forEach(function(e){this.trigger(e)},this)})};i.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(t){Et(t,"Video is not ready. (Video.js)")}};i.duration=function(){var e=this;if(this.el_.duration===1/0&&ma&&fa&&0===this.el_.currentTime){var t=function t(){if(0<e.el_.currentTime){if(e.el_.duration===1/0){e.trigger("durationchange")}e.off("timeupdate",t)}};this.on("timeupdate",t);return NaN}return this.el_.duration||NaN};i.width=function(){return this.el_.offsetWidth};i.height=function(){return this.el_.offsetHeight};i.proxyWebkitFullscreen_=function(){var e=this;if(!("webkitDisplayingFullscreen"in this.el_)){return}var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},a=function(){if("webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode){this.one("webkitendfullscreen",t);this.trigger("fullscreenchange",{isFullscreen:!0})}};this.on("webkitbeginfullscreen",a);this.on("dispose",function(){e.off("webkitbeginfullscreen",a);e.off("webkitendfullscreen",t)})};i.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=e.navigator&&e.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t)){return!0}}return!1};i.enterFullScreen=function(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA){this.el_.play();this.setTimeout(function(){e.pause();e.webkitEnterFullScreen()},0)}else{e.webkitEnterFullScreen()}};i.exitFullScreen=function(){this.el_.webkitExitFullScreen()};i.src=function(e){if(e===void 0){return this.el_.src}this.setSrc(e)};i.reset=function(){r.resetMediaElement(this.el_)};i.currentSrc=function(){if(this.currentSource_){return this.currentSource_.src}return this.el_.currentSrc};i.setControls=function(e){this.el_.controls=!!e};i.addTextTrack=function(e,t,a){if(!this.featuresNativeTextTracks){return n.prototype.addTextTrack.call(this,e,t,a)}return this.el_.addTextTrack(e,t,a)};i.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks){return n.prototype.createRemoteTextTrack.call(this,e)}var a=t.createElement("track");if(e.kind){a.kind=e.kind}if(e.label){a.label=e.label}if(e.language||e.srclang){a.srclang=e.language||e.srclang}if(e.default){a.default=e.default}if(e.id){a.id=e.id}if(e.src){a.src=e.src}return a};i.addRemoteTextTrack=function(e,t){var a=n.prototype.addRemoteTextTrack.call(this,e,t);if(this.featuresNativeTextTracks){this.el().appendChild(a)}return a};i.removeRemoteTextTrack=function(e){n.prototype.removeRemoteTextTrack.call(this,e);if(this.featuresNativeTextTracks){var t=this.$$("track"),a=t.length;while(a--){if(e===t[a]||e===t[a].track){this.el().removeChild(t[a])}}}};i.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality){return this.el().getVideoPlaybackQuality()}var t={};if("undefined"!=typeof this.el().webkitDroppedFrameCount&&"undefined"!=typeof this.el().webkitDecodedFrameCount){t.droppedVideoFrames=this.el().webkitDroppedFrameCount;t.totalVideoFrames=this.el().webkitDecodedFrameCount}if(e.performance&&"function"==typeof e.performance.now){t.creationTime=e.performance.now()}else if(e.performance&&e.performance.timing&&"number"==typeof e.performance.timing.navigationStart){t.creationTime=e.Date.now()-e.performance.timing.navigationStart}return t};return r}(rr);if(v()){Wi.TEST_VID=t.createElement("video");var Ki=t.createElement("track");Ki.kind="captions";Ki.srclang="en";Ki.label="English";Wi.TEST_VID.appendChild(Ki)}Wi.isSupported=function(){try{Wi.TEST_VID.volume=.5}catch(t){return!1}return!!(Wi.TEST_VID&&Wi.TEST_VID.canPlayType)};Wi.canPlayType=function(e){return Wi.TEST_VID.canPlayType(e)};Wi.canPlaySource=function(e){return Wi.canPlayType(e.type)};Wi.canControlVolume=function(){try{var e=Wi.TEST_VID.volume;Wi.TEST_VID.volume=e/2+.1;return e!==Wi.TEST_VID.volume}catch(t){return!1}};Wi.canMuteVolume=function(){try{var e=Wi.TEST_VID.muted;Wi.TEST_VID.muted=!e;if(Wi.TEST_VID.muted){R(Wi.TEST_VID,"muted","muted")}else{M(Wi.TEST_VID,"muted","muted")}return e!==Wi.TEST_VID.muted}catch(t){return!1}};Wi.canControlPlaybackRate=function(){if(ma&&fa&&58>ba){return!1}try{var e=Wi.TEST_VID.playbackRate;Wi.TEST_VID.playbackRate=e/2+.1;return e!==Wi.TEST_VID.playbackRate}catch(t){return!1}};Wi.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(t.createElement("video"),"src",{get:e,set:e});Object.defineProperty(t.createElement("audio"),"src",{get:e,set:e});Object.defineProperty(t.createElement("video"),"innerHTML",{get:e,set:e});Object.defineProperty(t.createElement("audio"),"innerHTML",{get:e,set:e})}catch(t){return!1}return!0};Wi.supportsNativeTextTracks=function(){return Sa||ua&&fa};Wi.supportsNativeVideoTracks=function(){return!!(Wi.TEST_VID&&Wi.TEST_VID.videoTracks)};Wi.supportsNativeAudioTracks=function(){return!!(Wi.TEST_VID&&Wi.TEST_VID.audioTracks)};Wi.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];Wi.prototype.featuresVolumeControl=Wi.canControlVolume();Wi.prototype.featuresMuteControl=Wi.canMuteVolume();Wi.prototype.featuresPlaybackRate=Wi.canControlPlaybackRate();Wi.prototype.featuresSourceset=Wi.canOverrideAttributes();Wi.prototype.movingMediaElementInDOM=!ua;Wi.prototype.featuresFullscreenResize=!0;Wi.prototype.featuresProgressEvents=!0;Wi.prototype.featuresTimeupdateEvents=!0;Wi.prototype.featuresNativeTextTracks=Wi.supportsNativeTextTracks();Wi.prototype.featuresNativeVideoTracks=Wi.supportsNativeVideoTracks();Wi.prototype.featuresNativeAudioTracks=Wi.supportsNativeAudioTracks();var Yi=Wi.TEST_VID&&Wi.TEST_VID.constructor.prototype.canPlayType,Xi=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;Wi.patchCanPlayType=function(){if(4<=ga&&!ya&&!fa){Wi.TEST_VID.constructor.prototype.canPlayType=function(e){if(e&&Xi.test(e)){return"maybe"}return Yi.call(this,e)}}};Wi.unpatchCanPlayType=function(){var e=Wi.TEST_VID.constructor.prototype.canPlayType;Wi.TEST_VID.constructor.prototype.canPlayType=Yi;return e};Wi.patchCanPlayType();Wi.disposeMediaElement=function(e){if(!e){return}if(e.parentNode){e.parentNode.removeChild(e)}while(e.hasChildNodes()){e.removeChild(e.firstChild)}e.removeAttribute("src");if("function"==typeof e.load){(function(){try{e.load()}catch(t){}})()}};Wi.resetMediaElement=function(e){if(!e){return}var t=e.querySelectorAll("source"),a=t.length;while(a--){e.removeChild(t[a])}e.removeAttribute("src");if("function"==typeof e.load){(function(){try{e.load()}catch(t){}})()}};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){Wi.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(e){Wi.prototype["set"+le(e)]=function(t){this.el_[e]=t;if(t){this.el_.setAttribute(e,e)}else{this.el_.removeAttribute(e)}}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){Wi.prototype[e]=function(){return this.el_[e]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(e){Wi.prototype["set"+le(e)]=function(t){this.el_[e]=t}});["pause","load","play"].forEach(function(e){Wi.prototype[e]=function(){return this.el_[e]()}});rr.withSourceHandlers(Wi);Wi.nativeSourceHandler={};Wi.nativeSourceHandler.canPlayType=function(e){try{return Wi.TEST_VID.canPlayType(e)}catch(t){return""}};Wi.nativeSourceHandler.canHandleSource=function(e){if(e.type){return Wi.nativeSourceHandler.canPlayType(e.type)}else if(e.src){var t=dn(e.src);return Wi.nativeSourceHandler.canPlayType("video/"+t)}return""};Wi.nativeSourceHandler.handleSource=function(e,t){t.setSrc(e.src)};Wi.nativeSourceHandler.dispose=function(){};Wi.registerSourceHandler(Wi.nativeSourceHandler);rr.registerTech("Html5",Wi);function ct(){var e=d(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);ct=function(){return e};return e}var $i=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Qi={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Ji=["tiny","xsmall","small","medium","large","xlarge","huge"],Zi={};Ji.forEach(function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Zi[e]="vjs-layout-"+t});var es={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},ts=function(n){a(r,n);function r(e,t,a){var i;e.id=e.id||t.id||"vjs_video_"+Y();t=m(r.getTagSettings(e),t);t.initChildren=!1;t.createEl=!1;t.evented=!1;t.reportTouchActivity=!1;if(!t.language){if("function"==typeof e.closest){var s=e.closest("[lang]");if(s&&s.getAttribute){t.language=s.getAttribute("lang")}}else{var d=e;while(d&&1===d.nodeType){if(O(d).hasOwnProperty("lang")){t.language=d.getAttribute("lang");break}d=d.parentNode}}}i=n.call(this,null,t,a)||this;i.boundDocumentFullscreenChange_=qt(o(o(i)),i.documentFullscreenChange_);i.boundFullWindowOnEscKey_=qt(o(o(i)),i.fullWindowOnEscKey);i.log=Lt(i.id_);i.isPosterFromTech_=!1;i.queuedCallbacks_=[];i.isReady_=!1;i.hasStarted_=!1;i.userActive_=!1;if(!i.options_||!i.options_.techOrder||!i.options_.techOrder.length){throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?")}i.tag=e;i.tagAttributes=e&&O(e);i.language(i.options_.language);if(t.languages){var l={};Object.getOwnPropertyNames(t.languages).forEach(function(e){l[e.toLowerCase()]=t.languages[e]});i.languages_=l}else{i.languages_=r.prototype.options_.languages}i.resetCache_();i.poster_=t.poster||"";i.controls_=!!t.controls;e.controls=!1;e.removeAttribute("controls");i.changingSrc_=!1;i.playCallbacks_=[];i.playTerminatedQueue_=[];if(e.hasAttribute("autoplay")){i.autoplay(!0)}else{i.autoplay(i.options_.autoplay)}if(t.plugins){Object.keys(t.plugins).forEach(function(e){if("function"!=typeof i[e]){throw new Error("plugin \""+e+"\" does not exist")}})}i.scrubbing_=!1;i.el_=i.createEl();oe(o(o(i)),{eventBusKey:"el_"});if(i.fluid_){i.on("playerreset",i.updateStyleEl_)}var p=ue(i.options_);if(t.plugins){Object.keys(t.plugins).forEach(function(e){i[e](t.plugins[e])})}i.options_.playerOptions=p;i.middleware_=[];i.initChildren();i.isAudio("audio"===e.nodeName.toLowerCase());if(i.controls()){i.addClass("vjs-controls-enabled")}else{i.addClass("vjs-controls-disabled")}i.el_.setAttribute("role","region");if(i.isAudio()){i.el_.setAttribute("aria-label",i.localize("Audio Player"))}else{i.el_.setAttribute("aria-label",i.localize("Video Player"))}if(i.isAudio()){i.addClass("vjs-audio")}if(i.flexNotSupported_()){i.addClass("vjs-no-flex")}if(ka){i.addClass("vjs-touch-enabled")}if(!ua){i.addClass("vjs-workinghover")}r.players[i.id_]=o(o(i));var u="7.5.5".split(".")[0];i.addClass("vjs-v"+u);i.userActive(!0);i.reportUserActivity();i.one("play",i.listenForUserActivity_);i.on("stageclick",i.handleStageClick_);i.on("keydown",i.handleKeyDown);i.breakpoints(i.options_.breakpoints);i.responsive(i.options_.responsive);return i}var i=r.prototype;i.dispose=function(){var e=this;this.trigger("dispose");this.off("dispose");ne(t,Ea.fullscreenchange,this.boundDocumentFullscreenChange_);ne(t,"keydown",this.boundFullWindowOnEscKey_);if(this.styleEl_&&this.styleEl_.parentNode){this.styleEl_.parentNode.removeChild(this.styleEl_);this.styleEl_=null}r.players[this.id_]=null;if(this.tag&&this.tag.player){this.tag.player=null}if(this.el_&&this.el_.player){this.el_.player=null}if(this.tech_){this.tech_.dispose();this.isPosterFromTech_=!1;this.poster_=""}if(this.playerElIngest_){this.playerElIngest_=null}if(this.tag){this.tag=null}tt(this);qn.names.forEach(function(t){var a=qn[t],n=e[a.getterName]();if(n&&n.off){n.off()}});n.prototype.dispose.call(this)};i.createEl=function(){var a=this.tag,r,s=this.playerElIngest_=a.parentNode&&a.parentNode.hasAttribute&&a.parentNode.hasAttribute("data-vjs-player"),o="video-js"===this.tag.tagName.toLowerCase();if(s){r=this.el_=a.parentNode}else if(!o){r=this.el_=n.prototype.createEl.call(this,"div")}var d=O(a);if(o){r=this.el_=a;a=this.tag=t.createElement("video");while(r.children.length){a.appendChild(r.firstChild)}if(!P(r,"video-js")){x(r,"video-js")}r.appendChild(a);s=this.playerElIngest_=r;Object.keys(r).forEach(function(e){a[e]=r[e]})}a.setAttribute("tabindex","-1");d.tabindex="-1";if(Ta){a.setAttribute("role","application");d.role="application"}a.removeAttribute("width");a.removeAttribute("height");if("width"in d){delete d.width}if("height"in d){delete d.height}Object.getOwnPropertyNames(d).forEach(function(e){if(!(o&&"class"===e)){r.setAttribute(e,d[e])}if(o){a.setAttribute(e,d[e])}});a.playerId=a.id;a.id+="_html5_api";a.className="vjs-tech";a.player=r.player=this;this.addClass("vjs-paused");if(!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Ht("vjs-styles-dimensions");var l=Dt(".vjs-styles-defaults"),p=Dt("head");p.insertBefore(this.styleEl_,l?l.nextSibling:p.firstChild)}this.fill_=!1;this.fluid_=!1;this.width(this.options_.width);this.height(this.options_.height);this.fill(this.options_.fill);this.fluid(this.options_.fluid);this.aspectRatio(this.options_.aspectRatio);for(var u=a.getElementsByTagName("a"),c=0,m;c<u.length;c++){m=u.item(c);x(m,"vjs-hidden");m.setAttribute("hidden","hidden")}a.initNetworkState_=a.networkState;if(a.parentNode&&!s){a.parentNode.insertBefore(r,a)}I(a,r);this.children_.unshift(a);this.el_.setAttribute("lang",this.language_);this.el_=r;return r};i.width=function(e){return this.dimension("width",e)};i.height=function(e){return this.dimension("height",e)};i.dimension=function(e,t){var a=e+"_";if(t===void 0){return this[a]||0}if(""===t){this[a]=void 0;this.updateStyleEl_();return}var n=parseFloat(t);if(isNaN(n)){Et.error("Improper value \""+t+"\" supplied for for "+e);return}this[a]=n;this.updateStyleEl_()};i.fluid=function(e){if(e===void 0){return!!this.fluid_}this.fluid_=!!e;if(Yt(this)){this.off("playerreset",this.updateStyleEl_)}if(e){this.addClass("vjs-fluid");this.fill(!1);Xt(function(){this.on("playerreset",this.updateStyleEl_)})}else{this.removeClass("vjs-fluid")}this.updateStyleEl_()};i.fill=function(e){if(e===void 0){return!!this.fill_}this.fill_=!!e;if(e){this.addClass("vjs-fill");this.fluid(!1)}else{this.removeClass("vjs-fill")}};i.aspectRatio=function(e){if(e===void 0){return this.aspectRatio_}if(!/^\d+\:\d+$/.test(e)){throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.")}this.aspectRatio_=e;this.fluid(!0);this.updateStyleEl_()};i.updateStyleEl_=function(){if(!0===e.VIDEOJS_NO_DYNAMIC_STYLE){var t="number"==typeof this.width_?this.width_:this.options_.width,a="number"==typeof this.height_?this.height_:this.options_.height,n=this.tech_&&this.tech_.el();if(n){if(0<=t){n.width=t}if(0<=a){n.height=a}}return}var r,i,s,o;if(this.aspectRatio_!==void 0&&"auto"!==this.aspectRatio_){s=this.aspectRatio_}else if(0<this.videoWidth()){s=this.videoWidth()+":"+this.videoHeight()}else{s="16:9"}var d=s.split(":"),l=d[1]/d[0];if(this.width_!==void 0){r=this.width_}else if(this.height_!==void 0){r=this.height_/l}else{r=this.videoWidth()||300}if(this.height_!==void 0){i=this.height_}else{i=r*l}if(/^[^a-zA-Z]/.test(this.id())){o="dimensions-"+this.id()}else{o=this.id()+"-dimensions"}this.addClass(o);Vt(this.styleEl_,"\n      ."+o+" {\n        width: "+r+"px;\n        height: "+i+"px;\n      }\n\n      ."+o+".vjs-fluid {\n        padding-top: "+100*l+"%;\n      }\n    ")};i.loadTech_=function(e,t){var a=this;if(this.tech_){this.unloadTech_()}var n=le(e),r=e.charAt(0).toLowerCase()+e.slice(1);if("Html5"!==n&&this.tag){rr.getTech("Html5").disposeMediaElement(this.tag);this.tag.player=null;this.tag=null}this.techName_=n;this.isReady_=!1;var i="string"==typeof this.autoplay()?!1:this.autoplay(),s={source:t,autoplay:i,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+r+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};qn.names.forEach(function(e){var t=qn[e];s[t.getterName]=a[t.privateName]});m(s,this.options_[n]);m(s,this.options_[r]);m(s,this.options_[e.toLowerCase()]);if(this.tag){s.tag=this.tag}if(t&&t.src===this.cache_.src&&0<this.cache_.currentTime){s.startTime=this.cache_.currentTime}var o=rr.getTech(e);if(!o){throw new Error("No Tech named '"+n+"' exists! '"+n+"' should be registered using videojs.registerTech()'")}this.tech_=new o(s);this.tech_.ready(qt(this,this.handleTechReady_),!0);Ra.jsonToTextTracks(this.textTracksJson_||[],this.tech_);$i.forEach(function(e){a.on(a.tech_,e,a["handleTech"+le(e)+"_"])});Object.keys(Qi).forEach(function(e){a.on(a.tech_,e,function(t){if(0===a.tech_.playbackRate()&&a.tech_.seeking()){a.queuedCallbacks_.push({callback:a["handleTech"+Qi[e]+"_"].bind(a),event:t});return}a["handleTech"+Qi[e]+"_"](t)})});this.on(this.tech_,"loadstart",this.handleTechLoadStart_);this.on(this.tech_,"sourceset",this.handleTechSourceset_);this.on(this.tech_,"waiting",this.handleTechWaiting_);this.on(this.tech_,"ended",this.handleTechEnded_);this.on(this.tech_,"seeking",this.handleTechSeeking_);this.on(this.tech_,"play",this.handleTechPlay_);this.on(this.tech_,"firstplay",this.handleTechFirstPlay_);this.on(this.tech_,"pause",this.handleTechPause_);this.on(this.tech_,"durationchange",this.handleTechDurationChange_);this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_);this.on(this.tech_,"error",this.handleTechError_);this.on(this.tech_,"loadedmetadata",this.updateStyleEl_);this.on(this.tech_,"posterchange",this.handleTechPosterChange_);this.on(this.tech_,"textdata",this.handleTechTextData_);this.on(this.tech_,"ratechange",this.handleTechRateChange_);this.usingNativeControls(this.techGet_("controls"));if(this.controls()&&!this.usingNativeControls()){this.addTechControlsListeners_()}if(this.tech_.el().parentNode!==this.el()&&("Html5"!==n||!this.tag)){I(this.tech_.el(),this.el())}if(this.tag){this.tag.player=null;this.tag=null}};i.unloadTech_=function(){var e=this;qn.names.forEach(function(t){var a=qn[t];e[a.privateName]=e[a.getterName]()});this.textTracksJson_=Ra.textTracksToJson(this.tech_);this.isReady_=!1;this.tech_.dispose();this.tech_=!1;if(this.isPosterFromTech_){this.poster_="";this.trigger("posterchange")}this.isPosterFromTech_=!1};i.tech=function(e){if(e===void 0){Et.warn(It(ct()))}return this.tech_};i.addTechControlsListeners_=function(){this.removeTechControlsListeners_();this.on(this.tech_,"mousedown",this.handleTechClick_);this.on(this.tech_,"dblclick",this.handleTechDoubleClick_);this.on(this.tech_,"touchstart",this.handleTechTouchStart_);this.on(this.tech_,"touchmove",this.handleTechTouchMove_);this.on(this.tech_,"touchend",this.handleTechTouchEnd_);this.on(this.tech_,"tap",this.handleTechTap_)};i.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_);this.off(this.tech_,"touchstart",this.handleTechTouchStart_);this.off(this.tech_,"touchmove",this.handleTechTouchMove_);this.off(this.tech_,"touchend",this.handleTechTouchEnd_);this.off(this.tech_,"mousedown",this.handleTechClick_);this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)};i.handleTechReady_=function(){this.triggerReady();if(this.cache_.volume){this.techCall_("setVolume",this.cache_.volume)}this.handleTechPosterChange_();this.handleTechDurationChange_()};i.handleTechLoadStart_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);this.handleTechDurationChange_();if(!this.paused()){this.trigger("loadstart");this.trigger("firstplay")}else{this.hasStarted(!1);this.trigger("loadstart")}this.manualAutoplay_(this.autoplay())};i.manualAutoplay_=function(e){var t=this;if(!this.tech_||"string"!=typeof e){return}var a=function(){var e=t.muted();t.muted(!0);var a=function(){t.muted(e)};t.playTerminatedQueue_.push(a);var n=t.play();if(!fe(n)){return}return n.catch(a)},n;if("any"===e&&!0!==this.muted()){n=this.play();if(fe(n)){n=n.catch(a)}}else if("muted"===e&&!0!==this.muted()){n=a()}else{n=this.play()}if(!fe(n)){return}return n.then(function(){t.trigger({type:"autoplay-success",autoplay:e})}).catch(function(){t.trigger({type:"autoplay-failure",autoplay:e})})};i.updateSourceCaches_=function(e){if(void 0===e){e=""}var t=e,a="";if("string"!=typeof t){t=e.src;a=e.type}this.cache_.source=this.cache_.source||{};this.cache_.sources=this.cache_.sources||[];if(t&&!a){a=mr(this,t)}this.cache_.source=ue({},e,{src:t,type:a});for(var n=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),r=[],s=this.$$("source"),o=[],d=0,l;d<s.length;d++){l=O(s[d]);r.push(l);if(l.src&&l.src===t){o.push(l.src)}}if(o.length&&!n.length){this.cache_.sources=r}else if(!n.length){this.cache_.sources=[this.cache_.source]}this.cache_.src=t};i.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var a=function(e){return t.updateSourceCaches_(e)},n=this.currentSource().src,r=e.src;if(n&&!/^blob:/.test(n)&&/^blob:/.test(r)){if(!this.lastSource_||this.lastSource_.tech!==r&&this.lastSource_.player!==n){a=function(){}}}a(r);if(!e.src){var i=function a(n){if("sourceset"!==n.type){var e=t.techGet("currentSrc");t.lastSource_.tech=e;t.updateSourceCaches_(e)}t.tech_.off(["sourceset","loadstart"],a)};this.tech_.one(["sourceset","loadstart"],i)}}this.lastSource_={player:this.currentSource().src,tech:e.src};this.trigger({src:e.src,type:"sourceset"})};i.hasStarted=function(e){if(e===void 0){return this.hasStarted_}if(e===this.hasStarted_){return}this.hasStarted_=e;if(this.hasStarted_){this.addClass("vjs-has-started");this.trigger("firstplay")}else{this.removeClass("vjs-has-started")}};i.handleTechPlay_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(!0);this.trigger("play")};i.handleTechRateChange_=function(){if(0<this.tech_.playbackRate()&&0===this.cache_.lastPlaybackRate){this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)});this.queuedCallbacks_=[]}this.cache_.lastPlaybackRate=this.tech_.playbackRate();this.trigger("ratechange")};i.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting");this.trigger("waiting");var t=this.currentTime();this.on("timeupdate",function a(){if(t!==e.currentTime()){e.removeClass("vjs-waiting");e.off("timeupdate",a)}})};i.handleTechCanPlay_=function(){this.removeClass("vjs-waiting");this.trigger("canplay")};i.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")};i.handleTechPlaying_=function(){this.removeClass("vjs-waiting");this.trigger("playing")};i.handleTechSeeking_=function(){this.addClass("vjs-seeking");this.trigger("seeking")};i.handleTechSeeked_=function(){this.removeClass("vjs-seeking");this.removeClass("vjs-ended");this.trigger("seeked")};i.handleTechFirstPlay_=function(){if(this.options_.starttime){Et.warn("Passing the `starttime` option to the player will be deprecated in 6.0");this.currentTime(this.options_.starttime)}this.addClass("vjs-has-started");this.trigger("firstplay")};i.handleTechPause_=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause")};i.handleTechEnded_=function(){this.addClass("vjs-ended");if(this.options_.loop){this.currentTime(0);this.play()}else if(!this.paused()){this.pause()}this.trigger("ended")};i.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))};i.handleTechClick_=function(e){if(!K(e)){return}if(!this.controls_){return}if(this.paused()){be(this.play())}else{this.pause()}};i.handleTechDoubleClick_=function(e){if(!this.controls_){return}var t=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(t){return t.contains(e.target)});if(!t){if(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||!1!==this.options_.userActions.doubleClick){if(this.options_!==void 0&&this.options_.userActions!==void 0&&"function"==typeof this.options_.userActions.doubleClick){this.options_.userActions.doubleClick.call(this,e)}else if(this.isFullscreen()){this.exitFullscreen()}else{this.requestFullscreen()}}}};i.handleTechTap_=function(){this.userActive(!this.userActive())};i.handleTechTouchStart_=function(){this.userWasActive=this.userActive()};i.handleTechTouchMove_=function(){if(this.userWasActive){this.reportUserActivity()}};i.handleTechTouchEnd_=function(e){e.preventDefault()};i.handleStageClick_=function(){this.reportUserActivity()};i.toggleFullscreenClass_=function(){if(this.isFullscreen()){this.addClass("vjs-fullscreen")}else{this.removeClass("vjs-fullscreen")}};i.documentFullscreenChange_=function(){var e=Ea,a=this.el(),n=t[e.fullscreenElement]===a;if(!n&&a.matches){n=a.matches(":"+e.fullscreen)}else if(!n&&a.msMatchesSelector){n=a.msMatchesSelector(":"+e.fullscreen)}this.isFullscreen(n);if(!1===this.isFullscreen()){ne(t,e.fullscreenchange,this.boundDocumentFullscreenChange_)}if(!xa){this.trigger("fullscreenchange")}};i.handleTechFullscreenChange_=function(e,t){if(t){this.isFullscreen(t.isFullscreen)}this.trigger("fullscreenchange")};i.handleTechError_=function(){var e=this.tech_.error();this.error(e)};i.handleTechTextData_=function(){var e=null;if(1<arguments.length){e=arguments[1]}this.trigger("textdata",e)};i.getCache=function(){return this.cache_};i.resetCache_=function(){this.cache_={currentTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}};i.techCall_=function(e,t){this.ready(function(){if(e in lr){return Qe(this.middleware_,this.tech_,e,t)}else if(e in pr){return Je(this.middleware_,this.tech_,e,t)}try{if(this.tech_){this.tech_[e](t)}}catch(t){Et(t);throw t}},!0)};i.techGet_=function(t){if(!this.tech_||!this.tech_.isReady_){return}if(t in dr){return $e(this.middleware_,this.tech_,t)}else if(t in pr){return Je(this.middleware_,this.tech_,t)}try{return this.tech_[t]()}catch(a){if(this.tech_[t]===void 0){Et("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",a);throw a}if("TypeError"===a.name){Et("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",a);this.tech_.isReady_=!1;throw a}Et(a);throw a}};i.play=function(){var t=this,a=this.options_.Promise||e.Promise;if(a){return new a(function(e){t.play_(e)})}return this.play_()};i.play_=function(e){var t=this;if(void 0===e){e=be}this.playCallbacks_.push(e);var a=!!(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_){this.off(["ready","loadstart"],this.waitToPlay_);this.waitToPlay_=null}if(!this.isReady_||!a){this.waitToPlay_=function(){t.play_()};this.one(["ready","loadstart"],this.waitToPlay_);if(!a&&(Sa||ua)){this.load()}return}var n=this.techGet_("play");if(null===n){this.runPlayTerminatedQueue_()}else{this.runPlayCallbacks_(n)}};i.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[];e.forEach(function(e){e()})};i.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[];this.playTerminatedQueue_=[];t.forEach(function(t){t(e)})};i.pause=function(){this.techCall_("pause")};i.paused=function(){return!1===this.techGet_("paused")?!1:!0};i.played=function(){return this.techGet_("played")||he(0,0)};i.scrubbing=function(e){if("undefined"==typeof e){return this.scrubbing_}this.scrubbing_=!!e;if(e){this.addClass("vjs-scrubbing")}else{this.removeClass("vjs-scrubbing")}};i.currentTime=function(e){if("undefined"!=typeof e){if(0>e){e=0}this.techCall_("setCurrentTime",e);return}this.cache_.currentTime=this.techGet_("currentTime")||0;return this.cache_.currentTime};i.duration=function(e){if(e===void 0){return this.cache_.duration!==void 0?this.cache_.duration:NaN}e=parseFloat(e);if(0>e){e=1/0}if(e!==this.cache_.duration){this.cache_.duration=e;if(e===1/0){this.addClass("vjs-live");if(this.options_.liveui&&this.player_.liveTracker){this.addClass("vjs-liveui")}}else{this.removeClass("vjs-live");this.removeClass("vjs-liveui")}if(!isNaN(e)){this.trigger("durationchange")}}};i.remainingTime=function(){return this.duration()-this.currentTime()};i.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())};i.buffered=function e(){var e=this.techGet_("buffered");if(!e||!e.length){e=he(0,0)}return e};i.bufferedPercent=function(){return ye(this.buffered(),this.duration())};i.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),a=e.end(e.length-1);if(a>t){a=t}return a};i.volume=function(e){var t;if(e!==void 0){t=Math.max(0,Math.min(1,parseFloat(e)));this.cache_.volume=t;this.techCall_("setVolume",t);if(0<t){this.lastVolume_(t)}return}t=parseFloat(this.techGet_("volume"));return isNaN(t)?1:t};i.muted=function(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1};i.defaultMuted=function(e){if(e!==void 0){return this.techCall_("setDefaultMuted",e)}return this.techGet_("defaultMuted")||!1};i.lastVolume_=function(e){if(e!==void 0&&0!==e){this.cache_.lastVolume=e;return}return this.cache_.lastVolume};i.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1};i.isFullscreen=function(e){if(e!==void 0){this.isFullscreen_=!!e;this.toggleFullscreenClass_();return}if(xa){var a=Ea,n=this.el(),r=t[a.fullscreenElement]===n;if(!r&&n.matches){r=n.matches(":"+a.fullscreen)}else if(!r&&n.msMatchesSelector){r=n.msMatchesSelector(":"+a.fullscreen)}return r}return!!this.isFullscreen_};i.requestFullscreen=function(){var e=Ea;this.isFullscreen(!0);if(e.requestFullscreen){ae(t,e.fullscreenchange,this.boundDocumentFullscreenChange_);this.el_[e.requestFullscreen]()}else if(this.tech_.supportsFullScreen()){this.techCall_("enterFullScreen")}else{this.enterFullWindow();this.trigger("fullscreenchange")}};i.exitFullscreen=function(){var e=Ea;this.isFullscreen(!1);if(e.requestFullscreen){t[e.exitFullscreen]()}else if(this.tech_.supportsFullScreen()){this.techCall_("exitFullScreen")}else{this.exitFullWindow();this.trigger("fullscreenchange")}};i.enterFullWindow=function(){this.isFullWindow=!0;this.docOrigOverflow=t.documentElement.style.overflow;ae(t,"keydown",this.boundFullWindowOnEscKey_);t.documentElement.style.overflow="hidden";x(t.body,"vjs-full-window");this.trigger("enterFullWindow")};i.fullWindowOnEscKey=function(e){if(Ba.isEventKey(e,"Esc")){if(!0===this.isFullscreen()){this.exitFullscreen()}else{this.exitFullWindow()}}};i.exitFullWindow=function(){this.isFullWindow=!1;ne(t,"keydown",this.boundFullWindowOnEscKey_);t.documentElement.style.overflow=this.docOrigOverflow;D(t.body,"vjs-full-window");this.trigger("exitFullWindow")};i.handleKeyDown=function(e){var t=this.options_.userActions;if(!t||!t.hotkeys){return}if(function(e){var t=e.tagName.toLowerCase();if("input"===t){return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(e.type)}return-1!==["textarea"].indexOf(t)}(this.el_.ownerDocument.activeElement)){return}if("function"==typeof t.hotkeys){t.hotkeys.call(this,e)}else{this.handleHotkeys(e)}};i.handleHotkeys=function(e){var a=this.options_.userActions?this.options_.userActions.hotkeys:{},n=a.fullscreenKey,r=void 0===n?function(e){return Ba.isEventKey(e,"f")}:n,i=a.muteKey,s=void 0===i?function(e){return Ba.isEventKey(e,"m")}:i,o=a.playPauseKey,d=void 0===o?function(e){return Ba.isEventKey(e,"k")||Ba.isEventKey(e,"Space")}:o;if(r.call(this,e)){e.preventDefault();e.stopPropagation();var l=ra.getComponent("FullscreenToggle");if(!1!==t[Ea.fullscreenEnabled]){l.prototype.handleClick.call(this)}}else if(s.call(this,e)){e.preventDefault();e.stopPropagation();var p=ra.getComponent("MuteToggle");p.prototype.handleClick.call(this)}else if(d.call(this,e)){e.preventDefault();e.stopPropagation();var u=ra.getComponent("PlayToggle");u.prototype.handleClick.call(this)}};i.canPlayType=function(e){for(var t,a=0,n=this.options_.techOrder;a<n.length;a++){var r=n[a],s=rr.getTech(r);if(!s){s=ra.getComponent(r)}if(!s){Et.error("The \""+r+"\" tech is undefined. Skipped browser support check for that tech.");continue}if(s.isSupported()){t=s.canPlayType(e);if(t){return t}}}return""};i.selectSource=function(e){var t=this,a=this.options_.techOrder.map(function(e){return[e,rr.getTech(e)]}).filter(function(e){var t=e[0],a=e[1];if(a){return a.isSupported()}Et.error("The \""+t+"\" tech is undefined. Skipped browser support check for that tech.");return!1}),n=function(e,t,a){var n;e.some(function(e){return t.some(function(t){n=a(e,t);if(n){return!0}})});return n},r,i=function(e){return function(t,a){return e(a,t)}},s=function(e,a){var n=e[0],r=e[1];if(r.canPlaySource(a,t.options_[n.toLowerCase()])){return{source:a,tech:n}}};if(this.options_.sourceOrder){r=n(e,a,i(s))}else{r=n(a,e,s)}return r||!1};i.src=function(e){var t=this;if("undefined"==typeof e){return this.cache_.src||""}var a=gr(e);if(!a.length){this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);return}this.changingSrc_=!0;this.cache_.sources=a;this.updateSourceCaches_(a[0]);Ye(this,a[0],function(e,n){t.middleware_=n;t.cache_.sources=a;t.updateSourceCaches_(e);var r=t.src_(e);if(r){if(1<a.length){return t.src(a.slice(1))}t.changingSrc_=!1;t.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);t.triggerReady();return}Xe(n,t.tech_)})};i.src_=function(e){var t=this,a=this.selectSource([e]);if(!a){return!0}if(!pe(a.tech,this.techName_)){this.changingSrc_=!0;this.loadTech_(a.tech,a.source);this.tech_.ready(function(){t.changingSrc_=!1});return!1}this.ready(function(){if(this.tech_.constructor.prototype.hasOwnProperty("setSource")){this.techCall_("setSource",e)}else{this.techCall_("src",e.src)}this.changingSrc_=!1},!0);return!1};i.load=function(){this.techCall_("load")};i.reset=function(){var t=this,a=this.options_.Promise||e.Promise;if(this.paused()||!a){this.doReset_()}else{var n=this.play();be(n.then(function(){return t.doReset_()}))}};i.doReset_=function(){if(this.tech_){this.tech_.clearTracks("text")}this.resetCache_();this.poster("");this.loadTech_(this.options_.techOrder[0],null);this.techCall_("reset");this.resetControlBarUI_();if(Yt(this)){this.trigger("playerreset")}};i.resetControlBarUI_=function(){this.resetProgressBar_();this.resetPlaybackRate_();this.resetVolumeBar_()};i.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,a=e.remainingTimeDisplay;if(t){t.updateContent()}if(a){a.updateContent()}};i.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate());this.handleTechRateChange_()};i.resetVolumeBar_=function(){this.volume(1);this.trigger("volumechange")};i.currentSources=function(){var e=this.currentSource(),t=[];if(0!==Object.keys(e).length){t.push(e)}return this.cache_.sources||t};i.currentSource=function(){return this.cache_.source||{}};i.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""};i.currentType=function(){return this.currentSource()&&this.currentSource().type||""};i.preload=function(e){if(e!==void 0){this.techCall_("setPreload",e);this.options_.preload=e;return}return this.techGet_("preload")};i.autoplay=function(e){if(e===void 0){return this.options_.autoplay||!1}var t;if("string"==typeof e&&/(any|play|muted)/.test(e)){this.options_.autoplay=e;this.manualAutoplay_(e);t=!1}else if(!e){this.options_.autoplay=!1}else{this.options_.autoplay=!0}t="undefined"==typeof t?this.options_.autoplay:t;if(this.tech_){this.techCall_("setAutoplay",t)}};i.playsinline=function(e){if(e!==void 0){this.techCall_("setPlaysinline",e);this.options_.playsinline=e;return this}return this.techGet_("playsinline")};i.loop=function(e){if(e!==void 0){this.techCall_("setLoop",e);this.options_.loop=e;return}return this.techGet_("loop")};i.poster=function(e){if(e===void 0){return this.poster_}if(!e){e=""}if(e===this.poster_){return}this.poster_=e;this.techCall_("setPoster",e);this.isPosterFromTech_=!1;this.trigger("posterchange")};i.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";if(e!==this.poster_){this.poster_=e;this.isPosterFromTech_=!0;this.trigger("posterchange")}}};i.controls=function(e){if(e===void 0){return!!this.controls_}e=!!e;if(this.controls_===e){return}this.controls_=e;if(this.usingNativeControls()){this.techCall_("setControls",e)}if(this.controls_){this.removeClass("vjs-controls-disabled");this.addClass("vjs-controls-enabled");this.trigger("controlsenabled");if(!this.usingNativeControls()){this.addTechControlsListeners_()}}else{this.removeClass("vjs-controls-enabled");this.addClass("vjs-controls-disabled");this.trigger("controlsdisabled");if(!this.usingNativeControls()){this.removeTechControlsListeners_()}}};i.usingNativeControls=function(e){if(e===void 0){return!!this.usingNativeControls_}e=!!e;if(this.usingNativeControls_===e){return}this.usingNativeControls_=e;if(this.usingNativeControls_){this.addClass("vjs-using-native-controls");this.trigger("usingnativecontrols")}else{this.removeClass("vjs-using-native-controls");this.trigger("usingcustomcontrols")}};i.error=function(e){if(e===void 0){return this.error_||null}if(null===e){this.error_=e;this.removeClass("vjs-error");if(this.errorDisplay){this.errorDisplay.close()}return}this.error_=new _e(e);this.addClass("vjs-error");Et.error("(CODE:"+this.error_.code+" "+_e.errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error")};i.reportUserActivity=function(){this.userActivity_=!0};i.userActive=function(e){if(e===void 0){return this.userActive_}e=!!e;if(e===this.userActive_){return}this.userActive_=e;if(this.userActive_){this.userActivity_=!0;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive");return}if(this.tech_){this.tech_.one("mousemove",function(t){t.stopPropagation();t.preventDefault()})}this.userActivity_=!1;this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")};i.listenForUserActivity_=function(){var e,t,a,n=qt(this,this.reportUserActivity),r=function(r){if(r.screenX!==t||r.screenY!==a){t=r.screenX;a=r.screenY;n()}},i=function(){n();this.clearInterval(e);e=this.setInterval(n,250)},s=function(){n();this.clearInterval(e)};this.on("mousedown",i);this.on("mousemove",r);this.on("mouseup",s);var o=this.getChild("controlBar");if(o&&!ua&&!ma){o.on("mouseenter",function(){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout;this.player().options_.inactivityTimeout=0});o.on("mouseleave",function(){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})}this.on("keydown",n);this.on("keyup",n);var d;this.setInterval(function(){if(!this.userActivity_){return}this.userActivity_=!1;this.userActive(!0);this.clearTimeout(d);var e=this.options_.inactivityTimeout;if(0>=e){return}d=this.setTimeout(function(){if(!this.userActivity_){this.userActive(!1)}},e)},250)};i.playbackRate=function(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}if(this.tech_&&this.tech_.featuresPlaybackRate){return this.cache_.lastPlaybackRate||this.techGet_("playbackRate")}return 1};i.defaultPlaybackRate=function(e){if(e!==void 0){return this.techCall_("setDefaultPlaybackRate",e)}if(this.tech_&&this.tech_.featuresPlaybackRate){return this.techGet_("defaultPlaybackRate")}return 1};i.isAudio=function(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_};i.addTextTrack=function(e,t,a){if(this.tech_){return this.tech_.addTextTrack(e,t,a)}};i.addRemoteTextTrack=function(e,t){if(this.tech_){return this.tech_.addRemoteTextTrack(e,t)}};i.removeRemoteTextTrack=function(e){if(void 0===e){e={}}var t=e,a=t.track;if(!a){a=e}if(this.tech_){return this.tech_.removeRemoteTextTrack(a)}};i.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")};i.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0};i.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0};i.language=function(e){if(e===void 0){return this.language_}this.language_=(e+"").toLowerCase()};i.languages=function(){return ue(r.prototype.options_.languages,this.languages_)};i.toJSON=function(){var e=ue(this.options_),t=e.tracks;e.tracks=[];for(var a=0,n;a<t.length;a++){n=t[a];n=ue(n);n.player=void 0;e.tracks[a]=n}return e};i.createModal=function(e,t){var a=this;t=t||{};t.content=e||"";var n=new za(this,t);this.addChild(n);n.on("dispose",function(){a.removeChild(n)});n.open();return n};i.updateCurrentBreakpoint_=function(){if(!this.responsive()){return}for(var e=this.currentBreakpoint(),t=this.currentWidth(),a=0;a<Ji.length;a++){var n=Ji[a],r=this.breakpoints_[n];if(t<=r){if(e===n){return}if(e){this.removeClass(Zi[e])}this.addClass(Zi[n]);this.breakpoint_=n;break}}};i.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="";if(e){this.removeClass(e)}};i.breakpoints=function(e){if(e===void 0){return m(this.breakpoints_)}this.breakpoint_="";this.breakpoints_=m({},es,e);this.updateCurrentBreakpoint_();return m(this.breakpoints_)};i.responsive=function(e){if(e===void 0){return this.responsive_}e=!!e;var t=this.responsive_;if(e===t){return}this.responsive_=e;if(e){this.on("playerresize",this.updateCurrentBreakpoint_);this.updateCurrentBreakpoint_()}else{this.off("playerresize",this.updateCurrentBreakpoint_);this.removeCurrentBreakpoint_()}return e};i.currentBreakpoint=function(){return this.breakpoint_};i.currentBreakpointClass=function(){return Zi[this.breakpoint_]||""};i.loadMedia=function(e,t){var a=this;if(!e||"object"!==_typeof(e)){return}this.reset();this.cache_.media=ue(e);var n=this.cache_.media,r=n.artwork,i=n.poster,s=n.src,o=n.textTracks;if(!r&&i){this.cache_.media.artwork=[{src:i,type:cr(i)}]}if(s){this.src(s)}if(i){this.poster(i)}if(Array.isArray(o)){o.forEach(function(e){return a.addRemoteTextTrack(e,!1)})}this.ready(t)};i.getMedia=function(){if(!this.cache_.media){var e=this.poster(),t=this.currentSources(),a=Array.prototype.map.call(this.remoteTextTracks(),function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}}),n={src:t,textTracks:a};if(e){n.poster=e;n.artwork=[{src:n.poster,type:cr(n.poster)}]}return n}return ue(this.cache_.media)};r.getTagSettings=function(e){var t={sources:[],tracks:[]},a=O(e),n=a["data-setup"];if(P(e,"vjs-fill")){a.fill=!0}if(P(e,"vjs-fluid")){a.fluid=!0}if(null!==n){var r=Oa(n||"{}"),s=r[0],o=r[1];if(s){Et.error(s)}m(a,o)}m(t,a);if(e.hasChildNodes()){for(var d=e.childNodes,l=0,p=d.length;l<p;l++){var u=d[l],c=u.nodeName.toLowerCase();if("source"===c){t.sources.push(O(u))}else if("track"===c){t.tracks.push(O(u))}}}return t};i.flexNotSupported_=function(){var e=t.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)};return r}(ra);qn.names.forEach(function(e){var t=qn[e];ts.prototype[t.getterName]=function(){if(this.tech_){return this.tech_[t.getterName]()}this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}});ts.players={};var as=e.navigator;ts.prototype.options_={techOrder:rr.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:as&&(as.languages&&as.languages[0]||as.userLanguage||as.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",breakpoints:{},responsive:!1};["ended","seeking","seekable","networkState","readyState"].forEach(function(e){ts.prototype[e]=function(){return this.techGet_(e)}});$i.forEach(function(e){ts.prototype["handleTech"+le(e)+"_"]=function(){return this.trigger(e)}});ra.registerComponent("Player",ts);var ns="activePlugins_",rs={},is=function(e){return rs.hasOwnProperty(e)},ss=function(e){return is(e)?rs[e]:void 0},os=function(e,t){e[ns]=e[ns]||{};e[ns][t]=!0},ds=function(e,t,a){var n=(a?"before":"")+"pluginsetup";e.trigger(n,t);e.trigger(n+":"+t.name,t)},ls=function(e,t){var a=function(){ds(this,{name:e,plugin:t,instance:null},!0);var a=t.apply(this,arguments);os(this,e);ds(this,{name:e,plugin:t,instance:a});return a};Object.keys(t).forEach(function(e){a[e]=t[e]});return a},ps=function(e,t){t.prototype.name=e;return function(){ds(this,{name:e,plugin:t,instance:null},!0);for(var a=arguments.length,n=Array(a),r=0;r<a;r++){n[r]=arguments[r]}var i=s(t,[this].concat(n));this[e]=function(){return i};ds(this,i.getEventHash());return i}},us=function(){function e(t){if(this.constructor===e){throw new Error("Plugin must be sub-classed; not directly instantiated.")}this.player=t;oe(this);delete this.trigger;de(this,this.constructor.defaultState);os(t,this.name);this.dispose=qt(this,this.dispose);t.on("dispose",this.dispose)}var t=e.prototype;t.version=function(){return this.constructor.VERSION};t.getEventHash=function(e){if(void 0===e){e={}}e.name=this.name;e.plugin=this.constructor;e.instance=this;return e};t.trigger=function(e,t){if(void 0===t){t={}}return re(this.eventBusEl_,e,this.getEventHash(t))};t.handleStateChanged=function(){};t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose");this.off();t.off("dispose",this.dispose);t[ns][e]=!1;this.player=this.state=null;t[e]=ps(e,rs[e])};e.isBasic=function(t){var a="string"==typeof t?ss(t):t;return"function"==typeof a&&!e.prototype.isPrototypeOf(a.prototype)};e.registerPlugin=function(t,a){if("string"!=typeof t){throw new Error("Illegal plugin name, \""+t+"\", must be a string, was "+_typeof(t)+".")}if(is(t)){Et.warn("A plugin named \""+t+"\" already exists. You may want to avoid re-registering plugins!")}else if(ts.prototype.hasOwnProperty(t)){throw new Error("Illegal plugin name, \""+t+"\", cannot share a name with an existing player method!")}if("function"!=typeof a){throw new Error("Illegal plugin for \""+t+"\", must be a function, was "+_typeof(a)+".")}rs[t]=a;if(t!=="plugin"){if(e.isBasic(a)){ts.prototype[t]=ls(t,a)}else{ts.prototype[t]=ps(t,a)}}return a};e.deregisterPlugin=function(e){if(e==="plugin"){throw new Error("Cannot de-register base plugin.")}if(is(e)){delete rs[e];delete ts.prototype[e]}};e.getPlugins=function(e){if(void 0===e){e=Object.keys(rs)}var t;e.forEach(function(e){var a=ss(e);if(a){t=t||{};t[e]=a}});return t};e.getPluginVersion=function(e){var t=ss(e);return t&&t.VERSION||""};return e}();us.getPlugin=ss;us.BASE_PLUGIN_NAME="plugin";us.registerPlugin("plugin",us);ts.prototype.usingPlugin=function(e){return!!this[ns]&&!0===this[ns][e]};ts.prototype.hasPlugin=function(e){return!!is(e)};var cs=function(e,t){if("function"!=typeof t&&null!==t){throw new TypeError("Super expression must either be null or a function, not "+_typeof(t))}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});if(t){e.super_=t}},ms=function(e,t){if(void 0===t){t={}}var a=function(){e.apply(this,arguments)},n={};if("object"===_typeof(t)){if(t.constructor!==Object.prototype.constructor){a=t.constructor}n=t}else if("function"==typeof t){a=t}cs(a,e);for(var r in n){if(n.hasOwnProperty(r)){a.prototype[r]=n[r]}}return a},gs=function(e){return 0===e.indexOf("#")?e.slice(1):e};function mt(e,t,a){var n=mt.getPlayer(e);if(n){if(t){Et.warn("Player \""+e+"\" is already initialised. Options will not be applied.")}if(a){n.ready(a)}return n}var r="string"==typeof e?Dt("#"+gs(e)):e;if(!S(r)){throw new TypeError("The element or ID supplied is not valid. (videojs)")}if(!r.ownerDocument.defaultView||!r.ownerDocument.body.contains(r)){Et.warn("The element supplied is not included in the DOM")}t=t||{};mt.hooks("beforesetup").forEach(function(e){var a=e(r,ue(t));if(!g(a)||Array.isArray(a)){Et.error("please return an object in beforesetup hooks");return}t=ue(t,a)});var i=ra.getComponent("Player");n=new i(r,t,a);mt.hooks("setup").forEach(function(e){return e(n)});return n}mt.hooks_={};mt.hooks=function(e,t){mt.hooks_[e]=mt.hooks_[e]||[];if(t){mt.hooks_[e]=mt.hooks_[e].concat(t)}return mt.hooks_[e]};mt.hook=function(e,t){mt.hooks(e,t)};mt.hookOnce=function(e,t){mt.hooks(e,[].concat(t).map(function(t){return function a(){mt.removeHook(e,a);return t.apply(void 0,arguments)}}))};mt.removeHook=function(e,t){var a=mt.hooks(e).indexOf(t);if(-1>=a){return!1}mt.hooks_[e]=mt.hooks_[e].slice();mt.hooks_[e].splice(a,1);return!0};if(!0!==e.VIDEOJS_NO_DYNAMIC_STYLE&&v()){var hs=Dt(".vjs-styles-defaults");if(!hs){hs=Ht("vjs-styles-defaults");var ys=Dt("head");if(ys){ys.insertBefore(hs,ys.firstChild)}Vt(hs,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}se(1,mt);mt.VERSION="7.5.5";mt.options=ts.prototype.options_;mt.getPlayers=function(){return ts.players};mt.getPlayer=function(e){var t=ts.players,a;if("string"==typeof e){var n=gs(e),r=t[n];if(r){return r}a=Dt("#"+n)}else{a=e}if(S(a)){var i=a,s=i.player,o=i.playerId;if(s||t[o]){return s||t[o]}}};mt.getAllPlayers=function(){return Object.keys(ts.players).map(function(e){return ts.players[e]}).filter(Boolean)};mt.players=ts.players;mt.getComponent=ra.getComponent;mt.registerComponent=function(e,t){if(rr.isTech(t)){Et.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)")}ra.registerComponent.call(ra,e,t)};mt.getTech=rr.getTech;mt.registerTech=rr.registerTech;mt.use=function(e,t){ir[e]=ir[e]||[];ir[e].push(t)};Object.defineProperty(mt,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(mt.middleware,"TERMINATOR",{value:or,writeable:!1,enumerable:!0});mt.browser=Ca;mt.TOUCH_ENABLED=ka;mt.extend=ms;mt.mergeOptions=ue;mt.bind=qt;mt.registerPlugin=us.registerPlugin;mt.deregisterPlugin=us.deregisterPlugin;mt.plugin=function(e,t){Et.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead");return us.registerPlugin(e,t)};mt.getPlugins=us.getPlugins;mt.getPlugin=us.getPlugin;mt.getPluginVersion=us.getPluginVersion;mt.addLanguage=function(e,t){var a;e=(""+e).toLowerCase();mt.options.languages=ue(mt.options.languages,(a={},a[e]=t,a));return mt.options.languages[e]};mt.log=Et;mt.createLogger=Lt;mt.createTimeRange=mt.createTimeRanges=he;mt.formatTime=ot;mt.setFormatTime=function(e){Ir=e};mt.resetFormatTime=function(){Ir=Lr};mt.parseUrl=sn;mt.isCrossOrigin=ln;mt.EventTarget=Wt;mt.on=ae;mt.one=ie;mt.off=ne;mt.trigger=re;mt.xhr=wn;mt.TextTrack=Rn;mt.AudioTrack=Mn;mt.VideoTrack=Bn;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){mt[e]=function(){Et.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead");return At[e].apply(null,arguments)}});mt.computedStyle=y;mt.dom=At;mt.url=pn;var _s=Te(function(e){(function(){var t=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,a=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,i={buildAbsoluteURL:function(e,t,n){n=n||{};e=e.trim();t=t.trim();if(!t){if(!n.alwaysNormalize){return e}var r=i.parseURL(e);if(!r){throw new Error("Error trying to parse base URL.")}r.path=i.normalizePath(r.path);return i.buildURLFromParts(r)}var s=i.parseURL(t);if(!s){throw new Error("Error trying to parse relative URL.")}if(s.scheme){if(!n.alwaysNormalize){return t}s.path=i.normalizePath(s.path);return i.buildURLFromParts(s)}var o=i.parseURL(e);if(!o){throw new Error("Error trying to parse base URL.")}if(!o.netLoc&&o.path&&"/"!==o.path[0]){var d=a.exec(o.path);o.netLoc=d[1];o.path=d[2]}if(o.netLoc&&!o.path){o.path="/"}var l={scheme:o.scheme,netLoc:s.netLoc,path:null,params:s.params,query:s.query,fragment:s.fragment};if(!s.netLoc){l.netLoc=o.netLoc;if("/"!==s.path[0]){if(!s.path){l.path=o.path;if(!s.params){l.params=o.params;if(!s.query){l.query=o.query}}}else{var p=o.path,u=p.substring(0,p.lastIndexOf("/")+1)+s.path;l.path=i.normalizePath(u)}}}if(null===l.path){l.path=n.alwaysNormalize?i.normalizePath(s.path):s.path}return i.buildURLFromParts(l)},parseURL:function(e){var a=t.exec(e);if(!a){return null}return{scheme:a[1]||"",netLoc:a[2]||"",path:a[3]||"",params:a[4]||"",query:a[5]||"",fragment:a[6]||""}},normalizePath:function(e){e=e.split("").reverse().join("").replace(n,"");while(e.length!==(e=e.replace(r,"")).length){}return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=i})(Ma)});function gt(){gt=Object.assign||function(e){for(var t=1,a;t<arguments.length;t++){a=arguments[t];for(var n in a){if(Object.prototype.hasOwnProperty.call(a,n)){e[n]=a[n]}}}return e};return gt.apply(this,arguments)}function ht(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}function yt(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var fs=function(){function e(){this.listeners={}}var t=e.prototype;t.on=function(e,t){if(!this.listeners[e]){this.listeners[e]=[]}this.listeners[e].push(t)};t.off=function(e,t){if(!this.listeners[e]){return!1}var a=this.listeners[e].indexOf(t);this.listeners[e].splice(a,1);return-1<a};t.trigger=function(e){var t=this.listeners[e],a,n,r;if(!t){return}if(2===arguments.length){n=t.length;for(a=0;a<n;++a){t[a].call(this,arguments[1])}}else{r=Array.prototype.slice.call(arguments,1);n=t.length;for(a=0;a<n;++a){t[a].apply(this,r)}}};t.dispose=function(){this.listeners={}};t.pipe=function(e){this.on("data",function(t){e.push(t)})};return e}(),bs=function(e){ht(t,e);function t(){var t=e.call(this)||this;t.buffer="";return t}var a=t.prototype;a.push=function(e){var t;this.buffer+=e;t=this.buffer.indexOf("\n");for(;-1<t;t=this.buffer.indexOf("\n")){this.trigger("data",this.buffer.substring(0,t));this.buffer=this.buffer.substring(t+1)}};return t}(fs),Ts=function(){return new RegExp("(?:^|,)("+("(?:[^=]*)=(?:"+"\"[^\"]*\"|[^,]*"+")")+")")},vs=function(e){var t=e.split(Ts()),a={},n=t.length,r;while(n--){if(""===t[n]){continue}r=/([^=]*)=(.*)/.exec(t[n]).slice(1);r[0]=r[0].replace(/^\s+|\s+$/g,"");r[1]=r[1].replace(/^\s+|\s+$/g,"");r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1");a[r[0]]=r[1]}return a},Ss=function(e){ht(t,e);function t(){var t=e.call(this)||this;t.customParsers=[];t.tagMappers=[];return t}var a=t.prototype;a.push=function(e){var t=this,a,n;e=e.trim();if(0===e.length){return}if("#"!==e[0]){this.trigger("data",{type:"uri",uri:e});return}var r=this.tagMappers.reduce(function(t,a){var n=a(e);if(n===e){return t}return t.concat([n])},[e]);r.forEach(function(e){for(var r=0;r<t.customParsers.length;r++){if(t.customParsers[r].call(t,e)){return}}if(0!==e.indexOf("#EXT")){t.trigger("data",{type:"comment",text:e.slice(1)});return}e=e.replace("\r","");a=/^#EXTM3U/.exec(e);if(a){t.trigger("data",{type:"tag",tagType:"m3u"});return}a=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e);if(a){n={type:"tag",tagType:"inf"};if(a[1]){n.duration=parseFloat(a[1])}if(a[2]){n.title=a[2]}t.trigger("data",n);return}a=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e);if(a){n={type:"tag",tagType:"targetduration"};if(a[1]){n.duration=parseInt(a[1],10)}t.trigger("data",n);return}a=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e);if(a){n={type:"tag",tagType:"totalduration"};if(a[1]){n.duration=parseInt(a[1],10)}t.trigger("data",n);return}a=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e);if(a){n={type:"tag",tagType:"version"};if(a[1]){n.version=parseInt(a[1],10)}t.trigger("data",n);return}a=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e);if(a){n={type:"tag",tagType:"media-sequence"};if(a[1]){n.number=parseInt(a[1],10)}t.trigger("data",n);return}a=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e);if(a){n={type:"tag",tagType:"discontinuity-sequence"};if(a[1]){n.number=parseInt(a[1],10)}t.trigger("data",n);return}a=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e);if(a){n={type:"tag",tagType:"playlist-type"};if(a[1]){n.playlistType=a[1]}t.trigger("data",n);return}a=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e);if(a){n={type:"tag",tagType:"byterange"};if(a[1]){n.length=parseInt(a[1],10)}if(a[2]){n.offset=parseInt(a[2],10)}t.trigger("data",n);return}a=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e);if(a){n={type:"tag",tagType:"allow-cache"};if(a[1]){n.allowed=!/NO/.test(a[1])}t.trigger("data",n);return}a=/^#EXT-X-MAP:?(.*)$/.exec(e);if(a){n={type:"tag",tagType:"map"};if(a[1]){var s=vs(a[1]);if(s.URI){n.uri=s.URI}if(s.BYTERANGE){var o=s.BYTERANGE.split("@"),d=o[0],l=o[1];n.byterange={};if(d){n.byterange.length=parseInt(d,10)}if(l){n.byterange.offset=parseInt(l,10)}}}t.trigger("data",n);return}a=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e);if(a){n={type:"tag",tagType:"stream-inf"};if(a[1]){n.attributes=vs(a[1]);if(n.attributes.RESOLUTION){var p=n.attributes.RESOLUTION.split("x"),u={};if(p[0]){u.width=parseInt(p[0],10)}if(p[1]){u.height=parseInt(p[1],10)}n.attributes.RESOLUTION=u}if(n.attributes.BANDWIDTH){n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)}if(n.attributes["PROGRAM-ID"]){n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10)}}t.trigger("data",n);return}a=/^#EXT-X-MEDIA:?(.*)$/.exec(e);if(a){n={type:"tag",tagType:"media"};if(a[1]){n.attributes=vs(a[1])}t.trigger("data",n);return}a=/^#EXT-X-ENDLIST/.exec(e);if(a){t.trigger("data",{type:"tag",tagType:"endlist"});return}a=/^#EXT-X-DISCONTINUITY/.exec(e);if(a){t.trigger("data",{type:"tag",tagType:"discontinuity"});return}a=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e);if(a){n={type:"tag",tagType:"program-date-time"};if(a[1]){n.dateTimeString=a[1];n.dateTimeObject=new Date(a[1])}t.trigger("data",n);return}a=/^#EXT-X-KEY:?(.*)$/.exec(e);if(a){n={type:"tag",tagType:"key"};if(a[1]){n.attributes=vs(a[1]);if(n.attributes.IV){if("0x"===n.attributes.IV.substring(0,2).toLowerCase()){n.attributes.IV=n.attributes.IV.substring(2)}n.attributes.IV=n.attributes.IV.match(/.{8}/g);n.attributes.IV[0]=parseInt(n.attributes.IV[0],16);n.attributes.IV[1]=parseInt(n.attributes.IV[1],16);n.attributes.IV[2]=parseInt(n.attributes.IV[2],16);n.attributes.IV[3]=parseInt(n.attributes.IV[3],16);n.attributes.IV=new Uint32Array(n.attributes.IV)}}t.trigger("data",n);return}a=/^#EXT-X-START:?(.*)$/.exec(e);if(a){n={type:"tag",tagType:"start"};if(a[1]){n.attributes=vs(a[1]);n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]);n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)}t.trigger("data",n);return}a=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e);if(a){n={type:"tag",tagType:"cue-out-cont"};if(a[1]){n.data=a[1]}else{n.data=""}t.trigger("data",n);return}a=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e);if(a){n={type:"tag",tagType:"cue-out"};if(a[1]){n.data=a[1]}else{n.data=""}t.trigger("data",n);return}a=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e);if(a){n={type:"tag",tagType:"cue-in"};if(a[1]){n.data=a[1]}else{n.data=""}t.trigger("data",n);return}t.trigger("data",{type:"tag",data:e.slice(4)})})};a.addParser=function(e){var t=this,a=e.expression,n=e.customType,r=e.dataParser,i=e.segment;if("function"!=typeof r){r=function(e){return e}}this.customParsers.push(function(e){var s=a.exec(e);if(s){t.trigger("data",{type:"custom",data:r(e),customType:n,segment:i});return!0}})};a.addTagMapper=function(e){var t=e.expression,a=e.map;this.tagMappers.push(function(e){if(t.test(e)){return a(e)}return e})};return t}(fs),ks=function(e){ht(t,e);function t(){var t=e.call(this)||this;t.lineStream=new bs;t.parseStream=new Ss;t.lineStream.pipe(t.parseStream);var a=yt(yt(t)),n=[],r={},i,s,o=function(){},d={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l=0;t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};t.parseStream.on("data",function(e){var t,p;({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=e.allowed;if(!("allowed"in e)){this.trigger("info",{message:"defaulting allowCache to YES"});this.manifest.allowCache=!0}},byterange:function t(){var t={};if("length"in e){r.byterange=t;t.length=e.length;if(!("offset"in e)){this.trigger("info",{message:"defaulting offset to zero"});e.offset=0}}if("offset"in e){r.byterange=t;t.offset=e.offset}},endlist:function(){this.manifest.endList=!0},inf:function(){if(!("mediaSequence"in this.manifest)){this.manifest.mediaSequence=0;this.trigger("info",{message:"defaulting media sequence to zero"})}if(!("discontinuitySequence"in this.manifest)){this.manifest.discontinuitySequence=0;this.trigger("info",{message:"defaulting discontinuity sequence to zero"})}if(0<e.duration){r.duration=e.duration}if(0===e.duration){r.duration=.01;this.trigger("info",{message:"updating zero segment duration to a small value"})}this.manifest.segments=n},key:function(){if(!e.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if("NONE"===e.attributes.METHOD){s=null;return}if(!e.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(!e.attributes.METHOD){this.trigger("warn",{message:"defaulting key method to AES-128"})}s={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI};if("undefined"!=typeof e.attributes.IV){s.iv=e.attributes.IV}},"media-sequence":function(){if(!isFinite(e.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number});return}this.manifest.mediaSequence=e.number},"discontinuity-sequence":function(){if(!isFinite(e.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number});return}this.manifest.discontinuitySequence=e.number;l=e.number},"playlist-type":function(){if(!/VOD|EVENT/.test(e.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist});return}this.manifest.playlistType=e.playlistType},map:function(){i={};if(e.uri){i.uri=e.uri}if(e.byterange){i.byterange=e.byterange}},"stream-inf":function(){this.manifest.playlists=n;this.manifest.mediaGroups=this.manifest.mediaGroups||d;if(!e.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}if(!r.attributes){r.attributes={}}gt(r.attributes,e.attributes)},media:function(){this.manifest.mediaGroups=this.manifest.mediaGroups||d;if(!(e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var a=this.manifest.mediaGroups[e.attributes.TYPE];a[e.attributes["GROUP-ID"]]=a[e.attributes["GROUP-ID"]]||{};t=a[e.attributes["GROUP-ID"]];p={default:/yes/i.test(e.attributes.DEFAULT)};if(p.default){p.autoselect=!0}else{p.autoselect=/yes/i.test(e.attributes.AUTOSELECT)}if(e.attributes.LANGUAGE){p.language=e.attributes.LANGUAGE}if(e.attributes.URI){p.uri=e.attributes.URI}if(e.attributes["INSTREAM-ID"]){p.instreamId=e.attributes["INSTREAM-ID"]}if(e.attributes.CHARACTERISTICS){p.characteristics=e.attributes.CHARACTERISTICS}if(e.attributes.FORCED){p.forced=/yes/i.test(e.attributes.FORCED)}t[e.attributes.NAME]=p},discontinuity:function(){l+=1;r.discontinuity=!0;this.manifest.discontinuityStarts.push(n.length)},"program-date-time":function(){if("undefined"==typeof this.manifest.dateTimeString){this.manifest.dateTimeString=e.dateTimeString;this.manifest.dateTimeObject=e.dateTimeObject}r.dateTimeString=e.dateTimeString;r.dateTimeObject=e.dateTimeObject},targetduration:function(){if(!isFinite(e.duration)||0>e.duration){this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration});return}this.manifest.targetDuration=e.duration},totalduration:function(){if(!isFinite(e.duration)||0>e.duration){this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration});return}this.manifest.totalDuration=e.duration},start:function(){if(!e.attributes||isNaN(e.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}},"cue-out":function(){r.cueOut=e.data},"cue-out-cont":function(){r.cueOutCont=e.data},"cue-in":function(){r.cueIn=e.data}})[e.tagType]||o).call(a)},uri:function(){r.uri=e.uri;n.push(r);if(this.manifest.targetDuration&&!("duration"in r)){this.trigger("warn",{message:"defaulting segment duration to the target duration"});r.duration=this.manifest.targetDuration}if(s){r.key=s}r.timeline=l;if(i){r.map=i}r={}},comment:function(){},custom:function(){if(e.segment){r.custom=r.custom||{};r.custom[e.customType]=e.data}else{this.manifest.custom=this.manifest.custom||{};this.manifest.custom[e.customType]=e.data}}})[e.type].call(a)});return t}var a=t.prototype;a.push=function(e){this.lineStream.push(e)};a.end=function(){this.lineStream.push("\n")};a.addParser=function(e){this.parseStream.addParser(e)};a.addTagMapper=function(e){this.parseStream.addTagMapper(e)};return t}(fs),Cs=function(e){return!!e&&"object"===_typeof(e)},Es=function e(){for(var t=arguments.length,a=Array(t),n=0;n<t;n++){a[n]=arguments[n]}return a.reduce(function(t,a){Object.keys(a).forEach(function(n){if(Array.isArray(t[n])&&Array.isArray(a[n])){t[n]=t[n].concat(a[n])}else if(Cs(t[n])&&Cs(a[n])){t[n]=e(t[n],a[n])}else{t[n]=a[n]}});return t},{})},Ls=function(e){return Object.keys(e).map(function(t){return e[t]})},Is=function(e,t){for(var a=[],n=e;n<t;n++){a.push(n)}return a},Ps=function(e){return e.reduce(function(e,t){return e.concat(t)},[])},xs=function(e){if(!e.length){return[]}for(var t=[],a=0;a<e.length;a++){t.push(e[a])}return t},Ds=function(e,t){return e.reduce(function(n,a,e){if(a[t]){n.push(e)}return n},[])},As=function(e){var t=Ls(e.reduce(function(e,t){var a=t.attributes.id+(t.attributes.lang||"");if(e[a]){var n;t.segments[0].discontinuity=!0;(n=e[a].segments).push.apply(n,t.segments);if(t.attributes.contentProtection){e[a].attributes.contentProtection=t.attributes.contentProtection}}else{e[a]=t}return e},{}));return t.map(function(e){e.discontinuityStarts=Ds(e.segments,"discontinuity");return e})},ws=function(e){var t,a=e.attributes,n=e.segments,r={attributes:(t={NAME:a.id,BANDWIDTH:a.bandwidth,CODECS:a.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:"",targetDuration:a.duration,segments:n,mediaSequence:n.length?n[0].number:1};if(a.contentProtection){r.contentProtection=a.contentProtection}return r},Os=function(e){var t,a=e.attributes,n=e.segments;if("undefined"==typeof n){n=[{uri:a.baseUrl,timeline:a.periodIndex,resolvedUri:a.baseUrl||"",duration:a.sourceDuration,number:0}];a.duration=a.sourceDuration}return{attributes:(t={NAME:a.id,BANDWIDTH:a.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:a.baseUrl||"",targetDuration:a.duration,segments:n,mediaSequence:n.length?n[0].number:1}},Us=function(e){return e.reduce(function(e,t){var a=t.attributes.role&&t.attributes.role.value||"main",n=t.attributes.lang||"",r="main";if(n){r=t.attributes.lang+" ("+a+")"}if(e[r]&&e[r].playlists[0].attributes.BANDWIDTH>t.attributes.bandwidth){return e}e[r]={language:n,autoselect:!0,default:"main"===a,playlists:[ws(t)],uri:""};return e},{})},Rs=function(e){return e.reduce(function(e,t){var a=t.attributes.lang||"text";if(e[a]){return e}e[a]={language:a,default:!1,autoselect:!1,playlists:[Os(t)],uri:""};return e},{})},Ms=function(e){var t,a=e.attributes,n=e.segments,r={attributes:(t={NAME:a.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:a.width,height:a.height},CODECS:a.codecs,BANDWIDTH:a.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:"",targetDuration:a.duration,segments:n,mediaSequence:n.length?n[0].number:1};if(a.contentProtection){r.contentProtection=a.contentProtection}return r},Bs=function(e){var t;if(!e.length){return{}}var a=e[0].attributes,n=a.sourceDuration,r=a.minimumUpdatePeriod,i=void 0===r?0:r,s=As(e.filter(function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType})).map(Ms),o=As(e.filter(function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType})),d=e.filter(function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType}),l={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(t={AUDIO:{},VIDEO:{}},t["CLOSED-CAPTIONS"]={},t.SUBTITLES={},t),uri:"",duration:n,playlists:s,minimumUpdatePeriod:1e3*i};if(o.length){l.mediaGroups.AUDIO.audio=Us(o)}if(d.length){l.mediaGroups.SUBTITLES.subs=Rs(d)}return l},Ns="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var js=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){(function(){var t=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,a=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,i={buildAbsoluteURL:function(e,t,n){n=n||{};e=e.trim();t=t.trim();if(!t){if(!n.alwaysNormalize){return e}var r=i.parseURL(e);if(!r){throw new Error("Error trying to parse base URL.")}r.path=i.normalizePath(r.path);return i.buildURLFromParts(r)}var s=i.parseURL(t);if(!s){throw new Error("Error trying to parse relative URL.")}if(s.scheme){if(!n.alwaysNormalize){return t}s.path=i.normalizePath(s.path);return i.buildURLFromParts(s)}var o=i.parseURL(e);if(!o){throw new Error("Error trying to parse base URL.")}if(!o.netLoc&&o.path&&"/"!==o.path[0]){var d=a.exec(o.path);o.netLoc=d[1];o.path=d[2]}if(o.netLoc&&!o.path){o.path="/"}var l={scheme:o.scheme,netLoc:s.netLoc,path:null,params:s.params,query:s.query,fragment:s.fragment};if(!s.netLoc){l.netLoc=o.netLoc;if("/"!==s.path[0]){if(!s.path){l.path=o.path;if(!s.params){l.params=o.params;if(!s.query){l.query=o.query}}}else{var p=o.path,u=p.substring(0,p.lastIndexOf("/")+1)+s.path;l.path=i.normalizePath(u)}}}if(null===l.path){l.path=n.alwaysNormalize?i.normalizePath(s.path):s.path}return i.buildURLFromParts(l)},parseURL:function(e){var a=t.exec(e);if(!a){return null}return{scheme:a[1]||"",netLoc:a[2]||"",path:a[3]||"",params:a[4]||"",query:a[5]||"",fragment:a[6]||""}},normalizePath:function(e){e=e.split("").reverse().join("").replace(n,"");while(e.length!==(e=e.replace(r,"")).length){}return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=i})(Ns)}),Fs=function(t,a){if(/^[a-z]+:/i.test(a)){return a}if(!/\/\//i.test(t)){t=js.buildAbsoluteURL(e.location.href,t)}return js.buildAbsoluteURL(t,a)},Hs=function(e){var t=e.baseUrl,a=void 0===t?"":t,n=e.source,r=void 0===n?"":n,i=e.range,s=void 0===i?"":i,o={uri:r,resolvedUri:Fs(a||"",r)};if(s){var d=s.split("-"),l=parseInt(d[0],10),p=parseInt(d[1],10);o.byterange={length:p-l,offset:l}}return o},Vs=function(e,t,a){var n=e.NOW,r=e.clientOffset,i=e.availabilityStartTime,s=e.timescale,o=void 0===s?1:s,d=e.start,l=void 0===d?0:d,p=e.minimumUpdatePeriod,u=void 0===p?0:p;return Math.ceil((((n+r)/1e3+u-(i+l))*o-t)/a)},qs=function(e,t){for(var a=e.type,n=void 0===a?"static":a,r=e.minimumUpdatePeriod,i=void 0===r?0:r,s=e.media,o=void 0===s?"":s,d=e.sourceDuration,l=e.timescale,p=void 0===l?1:l,u=e.startNumber,c=void 0===u?1:u,m=e.periodIndex,g=[],h=-1,y=0;y<t.length;y++){var _=t[y],f=_.d,b=_.r||0,T=_.t||0;if(0>h){h=T}if(T&&T>h){h=T}var v=void 0;if(0>b){var S=y+1;if(S===t.length){if("dynamic"===n&&0<i&&0<o.indexOf("$Number$")){v=Vs(e,h,f)}else{v=(d*p-h)/f}}else{v=(t[S].t-h)/f}}else{v=b+1}var k=c+g.length+v,C=c+g.length;while(C<k){g.push({number:C,duration:f/p,time:h,timeline:m});h+=f;C++}}return g},zs={static:function(e){var t=e.duration,a=e.timescale,n=void 0===a?1:a,r=e.sourceDuration;return{start:0,end:Math.ceil(r/(t/n))}},dynamic:function(e){var t=e.NOW,a=e.clientOffset,n=e.availabilityStartTime,r=e.timescale,i=void 0===r?1:r,s=e.duration,o=e.start,d=void 0===o?0:o,l=e.minimumUpdatePeriod,p=void 0===l?0:l,u=e.timeShiftBufferDepth,c=void 0===u?1/0:u,m=(t+a)/1e3,g=n+d,h=Math.ceil((m+p-g)*i/s),y=Math.floor((m-g-c)*i/s),_=Math.floor((m-g)*i/s);return{start:Math.max(0,y),end:Math.min(h,_)}}},Gs=function(e){return function(t,a){var n=e.duration,r=e.timescale,i=void 0===r?1:r,s=e.periodIndex,o=e.startNumber,d=void 0===o?1:o;return{number:d+t,duration:n/i,timeline:s,time:a*n}}},Ws=function(e){var t=e.type,a=void 0===t?"static":t,n=e.duration,r=e.timescale,i=void 0===r?1:r,s=e.sourceDuration,o=zs[a](e),d=o.start,l=o.end,p=Is(d,l).map(Gs(e));if("static"===a){var u=p.length-1;p[u].duration=s-n/i*u}return p},Ks=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Ys=function(e){return function(t,a,n,r){if("$$"===t){return"$"}if("undefined"==typeof e[a]){return t}var i=""+e[a];if("RepresentationID"===a){return i}if(!n){r=1}else{r=parseInt(r,10)}if(i.length>=r){return i}return""+Array(r-i.length+1).join("0")+i}},Xs=function(e,t){return e.replace(Ks,Ys(t))},$s=function(e,t){if(!e.duration&&!t){return[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}if(e.duration){return Ws(e)}return qs(e,t)},Qs=function(e,t){var a={RepresentationID:e.id,Bandwidth:e.bandwidth||0},n=e.initialization,r=void 0===n?{sourceURL:"",range:""}:n,i=Hs({baseUrl:e.baseUrl,source:Xs(r.sourceURL,a),range:r.range}),s=$s(e,t);return s.map(function(t){a.Number=t.number;a.Time=t.time;var n=Xs(e.media||"",a);return{uri:n,timeline:t.timeline,duration:t.duration,resolvedUri:Fs(e.baseUrl||"",n),map:i,number:t.number}})},Js={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},Zs=function(e,t){var a=e.baseUrl,n=e.initialization,r=void 0===n?{}:n,i=Hs({baseUrl:a,source:r.sourceURL,range:r.range}),s=Hs({baseUrl:a,source:t.media,range:t.mediaRange});s.map=i;return s},eo=function(e,t){var a=e.duration,n=e.segmentUrls,r=void 0===n?[]:n;if(!a&&!t||a&&t){throw new Error(Js.SEGMENT_TIME_UNSPECIFIED)}var i=r.map(function(t){return Zs(e,t)}),s;if(a){s=Ws(e)}if(t){s=qs(e,t)}var o=s.map(function(e,t){if(i[t]){var a=i[t];a.timeline=e.timeline;a.duration=e.duration;a.number=e.number;return a}}).filter(function(e){return e});return o},to=function(e){var t=e.baseUrl,a=e.initialization,n=void 0===a?{}:a,r=e.sourceDuration,i=e.timescale,s=void 0===i?1:i,o=e.indexRange,d=void 0===o?"":o,l=e.duration;if(!t){throw new Error(Js.NO_BASE_URL)}var p=Hs({baseUrl:t,source:n.sourceURL,range:n.range}),u=Hs({baseUrl:t,source:t,range:d});u.map=p;if(l){var c=Ws(e);if(c.length){u.duration=c[0].duration;u.timeline=c[0].timeline}}else if(r){u.duration=r/s;u.timeline=0}u.number=0;return[u]},ao=function(e){var t=e.attributes,a=e.segmentInfo,n,r;if(a.template){r=Qs;n=Es(t,a.template)}else if(a.base){r=to;n=Es(t,a.base)}else if(a.list){r=eo;n=Es(t,a.list)}if(!r){return{attributes:t}}var i=r(n,a.timeline);if(n.duration){var s=n,o=s.duration,d=s.timescale,l=void 0===d?1:d;n.duration=o/l}else if(i.length){n.duration=i.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0)}else{n.duration=0}return{attributes:n,segments:i}},no=function(e){return e.map(ao)},ro=function(e,t){return xs(e.childNodes).filter(function(e){var a=e.tagName;return a===t})},io=function(e){return e.textContent.trim()},so=function(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/,a=t.exec(e);if(!a){return 0}var n=a.slice(1),r=n[0],i=n[1],s=n[2],o=n[3],d=n[4],l=n[5];return parseFloat(r||0)*31536000+parseFloat(i||0)*2592000+parseFloat(s||0)*86400+parseFloat(o||0)*3600+parseFloat(d||0)*60+parseFloat(l||0)},oo=function(e){var t=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;if(t.test(e)){e+="Z"}return Date.parse(e)},lo={mediaPresentationDuration:function(e){return so(e)},availabilityStartTime:function(e){return oo(e)/1e3},minimumUpdatePeriod:function(e){return so(e)},timeShiftBufferDepth:function(e){return so(e)},start:function(e){return so(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);if(isNaN(t)){return so(e)}return t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},po=function(e){if(!(e&&e.attributes)){return{}}return xs(e.attributes).reduce(function(t,a){var e=lo[a.name]||lo.DEFAULT;t[a.name]=e(a.value);return t},{})};function _t(t){for(var a=e.atob(t),n=new Uint8Array(a.length),r=0;r<a.length;r++){n[r]=a.charCodeAt(r)}return n}var uo={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},co=function(e,t){if(!t.length){return e}return Ps(e.map(function(e){return t.map(function(t){return Fs(e,io(t))})}))},mo=function(e){var t=ro(e,"SegmentTemplate")[0],a=ro(e,"SegmentList")[0],n=a&&ro(a,"SegmentURL").map(function(e){return Es({tag:"SegmentURL"},po(e))}),r=ro(e,"SegmentBase")[0],i=a||t,s=i&&ro(i,"SegmentTimeline")[0],o=a||r||t,d=o&&ro(o,"Initialization")[0],l=t&&po(t);if(l&&d){l.initialization=d&&po(d)}else if(l&&l.initialization){l.initialization={sourceURL:l.initialization}}var p={template:l,timeline:s&&ro(s,"S").map(function(e){return po(e)}),list:a&&Es(po(a),{segmentUrls:n,initialization:po(d)}),base:r&&Es(po(r),{initialization:po(d)})};Object.keys(p).forEach(function(e){if(!p[e]){delete p[e]}});return p},go=function(e,t,a){return function(n){var r=ro(n,"BaseURL"),i=co(t,r),s=Es(e,po(n)),o=mo(n);return i.map(function(e){return{segmentInfo:Es(a,o),attributes:Es(s,{baseUrl:e})}})}},ho=function(e){return e.reduce(function(e,t){var a=po(t),n=uo[a.schemeIdUri];if(n){e[n]={attributes:a};var r=ro(t,"cenc:pssh")[0];if(r){var i=io(r),s=i&&_t(i);e[n].pssh=s}}return e},{})},yo=function(e,t,a){return function(n){var r=po(n),i=co(t,ro(n,"BaseURL")),s=ro(n,"Role")[0],o={role:po(s)},d=Es(e,r,o),l=ho(ro(n,"ContentProtection"));if(Object.keys(l).length){d=Es(d,{contentProtection:l})}var p=mo(n),u=ro(n,"Representation"),c=Es(a,p);return Ps(u.map(go(d,i,c)))}},_o=function(t,a){return function(n,r){var i=co(a,ro(n,"BaseURL")),s=po(n),o=parseInt(s.id,10),d=e.isNaN(o)?r:o,l=Es(t,{periodIndex:d}),p=ro(n,"AdaptationSet"),u=mo(n);return Ps(p.map(yo(l,i,u)))}},fo=function(e,t){if(void 0===t){t={}}var a=t,n=a.manifestUri,r=void 0===n?"":n,i=a.NOW,s=void 0===i?Date.now():i,o=a.clientOffset,d=void 0===o?0:o,l=ro(e,"Period");if(!l.length){throw new Error(Js.INVALID_NUMBER_OF_PERIOD)}var p=po(e),u=co([r],ro(e,"BaseURL"));p.sourceDuration=p.mediaPresentationDuration||0;p.NOW=s;p.clientOffset=d;return Ps(l.map(_o(p,u)))},bo=function(t){if(""===t){throw new Error(Js.DASH_EMPTY_MANIFEST)}var a=new e.DOMParser,n=a.parseFromString(t,"application/xml"),r=n&&"MPD"===n.documentElement.tagName?n.documentElement:null;if(!r||r&&0<r.getElementsByTagName("parsererror").length){throw new Error(Js.DASH_INVALID_XML)}return r},To=function(e){var t=ro(e,"UTCTiming")[0];if(!t){return null}var a=po(t);switch(a.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":a.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":a.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":a.method="DIRECT";a.value=Date.parse(a.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(Js.UNSUPPORTED_UTC_TIMING_SCHEME);}return a},vo=function(e,t){return Bs(no(fo(bo(e),t)))},So=function(e){return To(bo(e))},ko={toUnsigned:function(e){return e>>>0}}.toUnsigned,Co,Eo,Lo,Io,Po;Co=function(e,t){var a=[],n,r,s,o,d;if(!t.length){return null}for(n=0;n<e.byteLength;){r=ko(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]);s=Eo(e.subarray(n+4,n+8));o=1<r?n+r:e.byteLength;if(s===t[0]){if(1===t.length){a.push(e.subarray(n+8,o))}else{d=Co(e.subarray(n+8,o),t.slice(1));if(d.length){a=a.concat(d)}}}n=o}return a};Eo=function(e){var t="";t+=String.fromCharCode(e[0]);t+=String.fromCharCode(e[1]);t+=String.fromCharCode(e[2]);t+=String.fromCharCode(e[3]);return t};Lo=function(e){var t=Co(e,["moov","trak"]);return t.reduce(function(e,t){var a,n,r,i,s;a=Co(t,["tkhd"])[0];if(!a){return null}n=a[0];r=0===n?12:20;i=ko(a[r]<<24|a[r+1]<<16|a[r+2]<<8|a[r+3]);s=Co(t,["mdia","mdhd"])[0];if(!s){return null}n=s[0];r=0===n?12:20;e[i]=ko(s[r]<<24|s[r+1]<<16|s[r+2]<<8|s[r+3]);return e},{})};Io=function(e,t){var a,n,r;a=Co(t,["moof","traf"]);n=[].concat.apply([],a.map(function(t){return Co(t,["tfhd"]).map(function(a){var n,r,i;n=ko(a[4]<<24|a[5]<<16|a[6]<<8|a[7]);r=e[n]||9e4;i=Co(t,["tfdt"]).map(function(e){var t,a;t=e[0];a=ko(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);if(1===t){a*=Math.pow(2,32);a+=ko(e[8]<<24|e[9]<<16|e[10]<<8|e[11])}return a})[0];i=i||1/0;return i/r})}));r=Math.min.apply(null,n);return isFinite(r)?r:0};Po=function(e){var t=Co(e,["moov","trak"]),a=[];t.forEach(function(e){var t=Co(e,["mdia","hdlr"]),n=Co(e,["tkhd"]);t.forEach(function(e,t){var r=Eo(e.subarray(8,12)),i=n[t],s,o;if("vide"===r){s=new DataView(i.buffer,i.byteOffset,i.byteLength);s.getUint8(0);o=s.getUint32(20);a.push(o)}})});return a};var xo={findBox:Co,parseType:Eo,timescale:Lo,startTime:Io,videoTrackIds:Po},Do=Math.pow(2,32)-1,Ao,wo,Oo,Uo,Ro,Mo,Bo,No,jo,Fo,Ho,Vo,qo,zo,Go,Wo,Ko,Yo,Xo,$o,Qo,Jo,Zo,ed,td,ad,nd,rd,id,sd,od,dd,ld,pd,ud,cd;(function(){Zo={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if("undefined"==typeof Uint8Array){return}for(var e in Zo){if(Zo.hasOwnProperty(e)){Zo[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]}}ed=new Uint8Array([105,115,111,109]);ad=new Uint8Array([97,118,99,49]);td=new Uint8Array([0,0,0,1]);nd=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);rd=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);id={video:nd,audio:rd};dd=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);od=new Uint8Array([0,0,0,0,0,0,0,0]);ld=new Uint8Array([0,0,0,0,0,0,0,0]);pd=ld;ud=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);cd=ld;sd=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();Ao=function(e){var t=[],a=0,n,r,s;for(n=1;n<arguments.length;n++){t.push(arguments[n])}n=t.length;while(n--){a+=t[n].byteLength}r=new Uint8Array(a+8);s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setUint32(0,r.byteLength);r.set(e,4);for(n=0,a=8;n<t.length;n++){r.set(t[n],a);a+=t[n].byteLength}return r};wo=function(){return Ao(Zo.dinf,Ao(Zo.dref,dd))};Oo=function(e){return Ao(Zo.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))};Uo=function(){return Ao(Zo.ftyp,ed,td,ed,ad)};Wo=function(e){return Ao(Zo.hdlr,id[e])};Ro=function(e){return Ao(Zo.mdat,e)};Go=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,255&e.duration>>>24,255&e.duration>>>16,255&e.duration>>>8,255&e.duration,85,196,0,0]);if(e.samplerate){t[12]=255&e.samplerate>>>24;t[13]=255&e.samplerate>>>16;t[14]=255&e.samplerate>>>8;t[15]=255&e.samplerate}return Ao(Zo.mdhd,t)};zo=function(e){return Ao(Zo.mdia,Go(e),Wo(e.type),Bo(e))};Mo=function(e){return Ao(Zo.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))};Bo=function(e){return Ao(Zo.minf,"video"===e.type?Ao(Zo.vmhd,sd):Ao(Zo.smhd,od),wo(),Yo(e))};No=function(e,t){var a=[],n=t.length;while(n--){a[n]=$o(t[n])}return Ao.apply(null,[Zo.moof,Mo(e)].concat(a))};jo=function(e){var t=e.length,a=[];while(t--){a[t]=Vo(e[t])}return Ao.apply(null,[Zo.moov,Ho(4294967295)].concat(a).concat(Fo(e)))};Fo=function(e){var t=e.length,a=[];while(t--){a[t]=Qo(e[t])}return Ao.apply(null,[Zo.mvex].concat(a))};Ho=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ao(Zo.mvhd,t)};Ko=function(e){var t=e.samples||[],a=new Uint8Array(4+t.length),n,r;for(r=0;r<t.length;r++){n=t[r].flags;a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy}return Ao(Zo.sdtp,a)};Yo=function(e){return Ao(Zo.stbl,Xo(e),Ao(Zo.stts,cd),Ao(Zo.stsc,pd),Ao(Zo.stsz,ud),Ao(Zo.stco,ld))};(function(){var e,t;Xo=function(a){return Ao(Zo.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===a.type?e(a):t(a))};e=function(e){var t=e.sps||[],a=e.pps||[],n=[],r=[],s;for(s=0;s<t.length;s++){n.push((65280&t[s].byteLength)>>>8);n.push(255&t[s].byteLength);n=n.concat(Array.prototype.slice.call(t[s]))}for(s=0;s<a.length;s++){r.push((65280&a[s].byteLength)>>>8);r.push(255&a[s].byteLength);r=r.concat(Array.prototype.slice.call(a[s]))}return Ao(Zo.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),Ao(Zo.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([t.length]).concat(n).concat([a.length]).concat(r))),Ao(Zo.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))};t=function(e){return Ao(Zo.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),Oo(e))}})();qo=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return Ao(Zo.tkhd,t)};$o=function(e){var t,a,n,r,i,s,o;t=Ao(Zo.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));s=Math.floor(e.baseMediaDecodeTime/(Do+1));o=Math.floor(e.baseMediaDecodeTime%(Do+1));a=Ao(Zo.tfdt,new Uint8Array([1,0,0,0,255&s>>>24,255&s>>>16,255&s>>>8,255&s,255&o>>>24,255&o>>>16,255&o>>>8,255&o]));i=92;if("audio"===e.type){n=Jo(e,i);return Ao(Zo.traf,t,a,n)}r=Ko(e);n=Jo(e,r.length+i);return Ao(Zo.traf,t,a,n,r)};Vo=function(e){e.duration=e.duration||4294967295;return Ao(Zo.trak,qo(e),zo(e))};Qo=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if("video"!==e.type){t[t.length-1]=0}return Ao(Zo.trex,t)};(function(){var e,t,a;a=function(e,t){var a=0,n=0,r=0,i=0;if(e.length){if(e[0].duration!==void 0){a=1}if(e[0].size!==void 0){n=2}if(e[0].flags!==void 0){r=4}if(e[0].compositionTimeOffset!==void 0){i=8}}return[0,0,a|n|r|i,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]};t=function(e,t){var n,r,s,o;r=e.samples||[];t+=20+16*r.length;n=a(r,t);for(o=0;o<r.length;o++){s=r[o];n=n.concat([(4278190080&s.duration)>>>24,(16711680&s.duration)>>>16,(65280&s.duration)>>>8,255&s.duration,(4278190080&s.size)>>>24,(16711680&s.size)>>>16,(65280&s.size)>>>8,255&s.size,s.flags.isLeading<<2|s.flags.dependsOn,s.flags.isDependedOn<<6|s.flags.hasRedundancy<<4|s.flags.paddingValue<<1|s.flags.isNonSyncSample,s.flags.degradationPriority&61440,15&s.flags.degradationPriority,(4278190080&s.compositionTimeOffset)>>>24,(16711680&s.compositionTimeOffset)>>>16,(65280&s.compositionTimeOffset)>>>8,255&s.compositionTimeOffset])}return Ao(Zo.trun,new Uint8Array(n))};e=function(e,t){var n,r,s,o;r=e.samples||[];t+=20+8*r.length;n=a(r,t);for(o=0;o<r.length;o++){s=r[o];n=n.concat([(4278190080&s.duration)>>>24,(16711680&s.duration)>>>16,(65280&s.duration)>>>8,255&s.duration,(4278190080&s.size)>>>24,(16711680&s.size)>>>16,(65280&s.size)>>>8,255&s.size])}return Ao(Zo.trun,new Uint8Array(n))};Jo=function(a,n){if("audio"===a.type){return e(a,n)}return t(a,n)}})();var md={ftyp:Uo,mdat:Ro,moof:No,moov:jo,initSegment:function(e){var t=Uo(),a=jo(e),n;n=new Uint8Array(t.byteLength+a.byteLength);n.set(t);n.set(a,t.byteLength);return n}},gd=function(){this.init=function(){var e={};this.on=function(t,a){if(!e[t]){e[t]=[]}e[t]=e[t].concat(a)};this.off=function(t,a){var n;if(!e[t]){return!1}n=e[t].indexOf(a);e[t]=e[t].slice();e[t].splice(n,1);return-1<n};this.trigger=function(t){var a,n,r,s;a=e[t];if(!a){return}if(2===arguments.length){r=a.length;for(n=0;n<r;++n){a[n].call(this,arguments[1])}}else{s=[];n=arguments.length;for(n=1;n<arguments.length;++n){s.push(arguments[n])}r=a.length;for(n=0;n<r;++n){a[n].apply(this,s)}}};this.dispose=function(){e={}}}};gd.prototype.pipe=function(e){this.on("data",function(t){e.push(t)});this.on("done",function(t){e.flush(t)});return e};gd.prototype.push=function(e){this.trigger("data",e)};gd.prototype.flush=function(e){this.trigger("done",e)};var hd=gd,yd=function(e){var t,a,n=[],r=[];n.byteLength=0;for(t=0;t<e.length;t++){a=e[t];if("access_unit_delimiter_rbsp"===a.nalUnitType){if(n.length){n.duration=a.dts-n.dts;r.push(n)}n=[a];n.byteLength=a.data.byteLength;n.pts=a.pts;n.dts=a.dts}else{if("slice_layer_without_partitioning_rbsp_idr"===a.nalUnitType){n.keyFrame=!0}n.duration=a.dts-n.dts;n.byteLength+=a.data.byteLength;n.push(a)}}if(r.length&&(!n.duration||0>=n.duration)){n.duration=r[r.length-1].duration}r.push(n);return r},_d=function(e){var t,a,n=[],r=[];n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=e[0].pts;n.dts=e[0].dts;r.byteLength=0;r.nalCount=0;r.duration=0;r.pts=e[0].pts;r.dts=e[0].dts;for(t=0;t<e.length;t++){a=e[t];if(a.keyFrame){if(n.length){r.push(n);r.byteLength+=n.byteLength;r.nalCount+=n.nalCount;r.duration+=n.duration}n=[a];n.nalCount=a.length;n.byteLength=a.byteLength;n.pts=a.pts;n.dts=a.dts;n.duration=a.duration}else{n.duration+=a.duration;n.nalCount+=a.length;n.byteLength+=a.byteLength;n.push(a)}}if(r.length&&0>=n.duration){n.duration=r[r.length-1].duration}r.byteLength+=n.byteLength;r.nalCount+=n.nalCount;r.duration+=n.duration;r.push(n);return r},fd=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},bd=function(e,t){var a=fd();a.dataOffset=t;a.compositionTimeOffset=e.pts-e.dts;a.duration=e.duration;a.size=4*e.length;a.size+=e.byteLength;if(e.keyFrame){a.flags.dependsOn=2;a.flags.isNonSyncSample=0}return a},Td=function(e,t){var a,n,r,s,o,d=t||0,l=[];for(a=0;a<e.length;a++){s=e[a];for(n=0;n<s.length;n++){o=s[n];r=bd(o,d);d+=r.size;l.push(r)}}return l},vd=function(e){var t,a,n,r,s,o,d=0,l=e.byteLength,p=e.nalCount,u=new Uint8Array(l+4*p),c=new DataView(u.buffer);for(t=0;t<e.length;t++){r=e[t];for(a=0;a<r.length;a++){s=r[a];for(n=0;n<s.length;n++){o=s[n];c.setUint32(d,o.data.byteLength);d+=4;u.set(o.data,d);d+=o.data.byteLength}}}return u},Sd={groupNalsIntoFrames:yd,groupFramesIntoGops:_d,extendFirstKeyFrame:function(e){var t;if(!e[0][0].keyFrame&&1<e.length){t=e.shift();e.byteLength-=t.byteLength;e.nalCount-=t.nalCount;e[0][0].dts=t.dts;e[0][0].pts=t.pts;e[0][0].duration+=t.duration}return e},generateSampleTable:Td,concatenateNalData:vd},kd=[33,16,5,32,164,27],Cd=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Ed=function(e){var t=[];while(e--){t.push(0)}return t},Ld={96e3:[kd,[227,64],Ed(154),[56]],88200:[kd,[231],Ed(170),[56]],64e3:[kd,[248,192],Ed(240),[56]],48e3:[kd,[255,192],Ed(268),[55,148,128],Ed(54),[112]],44100:[kd,[255,192],Ed(268),[55,163,128],Ed(84),[112]],32e3:[kd,[255,192],Ed(268),[55,234],Ed(226),[112]],24e3:[kd,[255,192],Ed(268),[55,255,128],Ed(268),[111,112],Ed(126),[224]],16e3:[kd,[255,192],Ed(268),[55,255,128],Ed(268),[111,255],Ed(269),[223,108],Ed(195),[1,192]],12e3:[Cd,Ed(268),[3,127,248],Ed(268),[6,255,240],Ed(268),[13,255,224],Ed(268),[27,253,128],Ed(259),[56]],11025:[Cd,Ed(268),[3,127,248],Ed(268),[6,255,240],Ed(268),[13,255,224],Ed(268),[27,255,192],Ed(268),[55,175,128],Ed(108),[112]],8e3:[Cd,Ed(268),[3,121,16],Ed(47),[7]]},Id=function(e){return Object.keys(e).reduce(function(t,a){t[a]=new Uint8Array(e[a].reduce(function(e,t){return e.concat(t)},[]));return t},{})}(Ld),Pd=9e4,xd,Dd,Ad,wd,Od,Ud;xd=function(e){return e*Pd};Dd=function(e,t){return e*t};Ad=function(e){return e/Pd};wd=function(e,t){return e/t};Od=function(e,t){return xd(wd(e,t))};Ud=function(e,t){return Dd(Ad(e),t)};var Rd={secondsToVideoTs:xd,secondsToAudioTs:Dd,videoTsToSeconds:Ad,audioTsToSeconds:wd,audioTsToVideoTs:Od,videoTsToAudioTs:Ud},Md=9e4,Bd=function(e){var t,a,n=0;for(t=0;t<e.length;t++){a=e[t];n+=a.data.byteLength}return n},Nd=function(e,t,a,n){var r,s=0,o=0,d=0,l=0,p,u;if(!t.length){return}r=Rd.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate);s=Math.ceil(Md/(e.samplerate/1024));if(a&&n){o=r-Math.max(a,n);d=Math.floor(o/s);l=d*s}if(1>d||l>Md/2){return}p=Id[e.samplerate];if(!p){p=t[0].data}for(u=0;u<d;u++){t.splice(u,0,{data:p})}e.baseMediaDecodeTime-=Math.floor(Rd.videoTsToAudioTs(l,e.samplerate))},jd=function(e){var t,a,n=[];for(t=0;t<e.length;t++){a=e[t];n.push({size:a.data.byteLength,duration:1024})}return n},Fd=function(e){var t,a,n=0,r=new Uint8Array(Bd(e));for(t=0;t<e.length;t++){a=e[t];r.set(a.data,n);n+=a.data.byteLength}return r},Hd={prefixWithSilence:Nd,trimAdtsFramesByEarliestDts:function(e,t,a){if(t.minSegmentDts>=a){return e}t.minSegmentDts=1/0;return e.filter(function(e){if(e.dts>=a){t.minSegmentDts=Math.min(t.minSegmentDts,e.dts);t.minSegmentPts=t.minSegmentDts;return!0}return!1})},generateSampleTable:jd,concatenateFrameData:Fd},Vd={clearDtsInfo:function(e){delete e.minSegmentDts;delete e.maxSegmentDts;delete e.minSegmentPts;delete e.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(e,t){var a,n,r=e.minSegmentDts;if(!t){r-=e.timelineStartInfo.dts}a=e.timelineStartInfo.baseMediaDecodeTime;a+=r;a=Math.max(0,a);if("audio"===e.type){n=e.samplerate/9e4;a*=n;a=Math.floor(a)}return a},collectDtsInfo:function(e,t){if("number"==typeof t.pts){if(e.timelineStartInfo.pts===void 0){e.timelineStartInfo.pts=t.pts}if(e.minSegmentPts===void 0){e.minSegmentPts=t.pts}else{e.minSegmentPts=Math.min(e.minSegmentPts,t.pts)}if(e.maxSegmentPts===void 0){e.maxSegmentPts=t.pts}else{e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)}}if("number"==typeof t.dts){if(e.timelineStartInfo.dts===void 0){e.timelineStartInfo.dts=t.dts}if(e.minSegmentDts===void 0){e.minSegmentDts=t.dts}else{e.minSegmentDts=Math.min(e.minSegmentDts,t.dts)}if(e.maxSegmentDts===void 0){e.maxSegmentDts=t.dts}else{e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts)}}}},qd=4,zd=function(e){var t=0,a={payloadType:-1,payloadSize:0},n=0,r=0;while(t<e.byteLength){if(e[t]===128){break}while(255===e[t]){n+=255;t++}n+=e[t++];while(255===e[t]){r+=255;t++}r+=e[t++];if(!a.payload&&n===qd){a.payloadType=n;a.payloadSize=r;a.payload=e.subarray(t,t+r);break}t+=r;n=0;r=0}return a},Gd=function(e,t){var a=[],n,r,s,o;if(!(64&t[0])){return a}r=31&t[0];for(n=0;n<r;n++){s=3*n;o={type:3&t[s+2],pts:e};if(4&t[s+2]){o.ccData=t[s+3]<<8|t[s+4];a.push(o)}}return a},Wd=function(e){var t=e.byteLength,a=[],n=1,r,s;while(n<t-2){if(0===e[n]&&0===e[n+1]&&3===e[n+2]){a.push(n+2);n+=2}else{n++}}if(0===a.length){return e}r=t-a.length;s=new Uint8Array(r);var o=0;for(n=0;n<r;o++,n++){if(o===a[0]){o++;a.shift()}s[n]=e[o]}return s},Kd={parseSei:zd,parseUserData:function(e){if(181!==e.payload[0]){return null}if(49!=(e.payload[1]<<8|e.payload[2])){return null}if("GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])){return null}if(3!==e.payload[7]){return null}return e.payload.subarray(8,e.payload.length-1)},parseCaptionPackets:Gd,discardEmulationPreventionBytes:Wd,USER_DATA_REGISTERED_ITU_T_T35:qd},Yd=function e(){e.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new el(0,0),new el(0,1),new el(1,0),new el(1,1)];this.reset();this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data"));e.on("done",this.trigger.bind(this,"done"))},this)};Yd.prototype=new hd;Yd.prototype.push=function(e){var t,a,n;if("sei_rbsp"!==e.nalUnitType){return}t=Kd.parseSei(e.escapedRBSP);if(t.payloadType!==Kd.USER_DATA_REGISTERED_ITU_T_T35){return}a=Kd.parseUserData(t);if(!a){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=!1}return}n=Kd.parseCaptionPackets(e.pts,a);this.captionPackets_=this.captionPackets_.concat(n);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};Yd.prototype.flush=function(){if(!this.captionPackets_.length){this.ccStreams_.forEach(function(e){e.flush()},this);return}this.captionPackets_.forEach(function(e,t){e.presortIndex=t});this.captionPackets_.sort(function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts});this.captionPackets_.forEach(function(e){if(2>e.type){this.dispatchCea608Packet(e)}},this);this.captionPackets_.length=0;this.ccStreams_.forEach(function(e){e.flush()},this)};Yd.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=!1;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(e){e.reset()})};Yd.prototype.dispatchCea608Packet=function(e){if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(null===this.activeCea608Channel_[e.type]){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};Yd.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)};Yd.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)};var Xd={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},$d=function(e){if(null===e){return""}e=Xd[e]||e;return String.fromCharCode(e)},Qd=14,Jd=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Zd=function(){var e=[],t=Qd+1;while(t--){e.push("")}return e},el=function e(t,a){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=a||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,a,n,r,i;t=32639&e.ccData;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if(4096==(61440&t)){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}n=t>>>8;r=255&t;if(t===this.PADDING_){}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);a=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=a;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if("popOn"===this.mode_){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=Zd()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=Zd()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if("paintOn"!==this.mode_){this.flushDisplayed(e.pts);this.displayed_=Zd()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(n,r)){n=(3&n)<<8;i=$d(n|r);this[this.mode_](e.pts,i);this.column_++}else if(this.isExtCharacter(n,r)){if("popOn"===this.mode_){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}n=(3&n)<<8;i=$d(n|r);this[this.mode_](e.pts,i);this.column_++}else if(this.isMidRowCode(n,r)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if(14==(14&r)){this.addFormatting(e.pts,["i"])}if(1==(1&r)){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(n,r)){this.column_+=3&r}else if(this.isPAC(n,r)){var s=Jd.indexOf(7968&t);if("rollUp"===this.mode_){if(0>s-this.rollUpRows_+1){s=this.rollUpRows_-1}this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(1&r&&-1===this.formatting_.indexOf("u")){this.addFormatting(e.pts,["u"])}if(16==(16&t)){this.column_=4*((14&t)>>1)}if(this.isColorPAC(r)){if(14==(14&r)){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(n)){if(0===r){r=null}i=$d(n);i+=$d(r);this[this.mode_](e.pts,i);this.column_+=i.length}}};el.prototype=new hd;el.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(t){console.error("Skipping malformed caption.");return""}}).join("\n").replace(/^\n+|\n+$/g,"");if(t.length){this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})}};el.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=Zd();this.nonDisplayed_=Zd();this.lastControlCode_=null;this.column_=0;this.row_=Qd;this.rollUpRows_=2;this.formatting_=[]};el.prototype.setConstants=function(){if(0===this.dataChannel_){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(1===this.dataChannel_){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=32|this.CONTROL_;this.END_OF_CAPTION_=47|this.CONTROL_;this.ROLL_UP_2_ROWS_=37|this.CONTROL_;this.ROLL_UP_3_ROWS_=38|this.CONTROL_;this.ROLL_UP_4_ROWS_=39|this.CONTROL_;this.CARRIAGE_RETURN_=45|this.CONTROL_;this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_;this.BACKSPACE_=33|this.CONTROL_;this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_;this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_};el.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&63>=t};el.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&63>=t};el.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&47>=t};el.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&35>=t};el.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&127>=t};el.prototype.isColorPAC=function(e){return 64<=e&&79>=e||96<=e&&127>=e};el.prototype.isNormalChar=function(e){return 32<=e&&127>=e};el.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_){this.row_=Qd;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=Zd();this.displayed_=Zd()}if(t!==void 0&&t!==this.row_){for(var a=0;a<this.rollUpRows_;a++){this.displayed_[t-a]=this.displayed_[this.row_-a];this.displayed_[this.row_-a]=""}}if(t===void 0){t=this.row_}this.topRow_=t-this.rollUpRows_+1};el.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var a=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,a)};el.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[];this[this.mode_](e,t)};el.prototype.popOn=function(e,t){var a=this.nonDisplayed_[this.row_];a+=t;this.nonDisplayed_[this.row_]=a};el.prototype.rollUp=function(e,t){var a=this.displayed_[this.row_];a+=t;this.displayed_[this.row_]=a};el.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]=""}for(e=this.row_+1;e<Qd+1;e++){this.displayed_[e]=""}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]=""};el.prototype.paintOn=function(e,t){var a=this.displayed_[this.row_];a+=t;this.displayed_[this.row_]=a};var tl={CaptionStream:Yd,Cea608Stream:el},al={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},nl=function(e,t){var a=1;if(e>t){a=-1}while(Math.abs(t-e)>4294967296){e+=a*8589934592}return e},rl=function e(t){var a,n;e.prototype.init.call(this);this.type_=t;this.push=function(e){if(e.type!==this.type_){return}if(n===void 0){n=e.dts}e.dts=nl(e.dts,n);e.pts=nl(e.pts,n);a=e.dts;this.trigger("data",e)};this.flush=function(){n=a;this.trigger("done")};this.discontinuity=function(){n=void 0;a=void 0}};rl.prototype=new hd;var il={TimestampRolloverStream:rl,handleRollover:nl},sl=function(e,t,a){var n,r="";for(n=t;n<a;n++){r+="%"+("00"+e[n].toString(16)).slice(-2)}return r},ol=function(e,t,a){return decodeURIComponent(sl(e,t,a))},dl=function(e,t,a){return unescape(sl(e,t,a))},ll=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},pl={TXXX:function(e){var t;if(3!==e.data[0]){return}for(t=1;t<e.data.length;t++){if(0===e.data[t]){e.description=ol(e.data,1,t);e.value=ol(e.data,t+1,e.data.length).replace(/\0*$/,"");break}}e.data=e.value},WXXX:function(e){var t;if(3!==e.data[0]){return}for(t=1;t<e.data.length;t++){if(0===e.data[t]){e.description=ol(e.data,1,t);e.url=ol(e.data,t+1,e.data.length);break}}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++){if(0===e.data[t]){e.owner=dl(e.data,0,t);break}}e.privateData=e.data.subarray(t+1);e.data=e.privateData}},ul;ul=function(e){var t={debug:!!(e&&e.debug),descriptor:e&&e.descriptor},a=0,n=[],r=0,s;ul.prototype.init.call(this);this.dispatchType=al.METADATA_STREAM_TYPE.toString(16);if(t.descriptor){for(s=0;s<t.descriptor.length;s++){this.dispatchType+=("00"+t.descriptor[s].toString(16)).slice(-2)}}this.push=function(e){var s,o,l,p,u,c;if("timed-metadata"!==e.type){return}if(e.dataAlignmentIndicator){r=0;n.length=0}if(0===n.length&&(10>e.data.length||e.data[0]!==73||e.data[1]!==68||e.data[2]!==51)){if(t.debug){console.log("Skipping unrecognized metadata packet")}return}n.push(e);r+=e.data.byteLength;if(1===n.length){a=ll(e.data.subarray(6,10));a+=10}if(r<a){return}s={data:new Uint8Array(a),frames:[],pts:n[0].pts,dts:n[0].dts};for(u=0;u<a;){s.data.set(n[0].data.subarray(0,a-u),u);u+=n[0].data.byteLength;r-=n[0].data.byteLength;n.shift()}o=10;if(64&s.data[5]){o+=4;o+=ll(s.data.subarray(10,14));a-=ll(s.data.subarray(16,20))}do{l=ll(s.data.subarray(o+4,o+8));if(1>l){return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.")}c=String.fromCharCode(s.data[o],s.data[o+1],s.data[o+2],s.data[o+3]);p={id:c,data:s.data.subarray(o+10,o+l+10)};p.key=p.id;if(pl[p.id]){pl[p.id](p);if("com.apple.streaming.transportStreamTimestamp"===p.owner){var m=p.data,d=(1&m[3])<<30|m[4]<<22|m[5]<<14|m[6]<<6|m[7]>>>2;d*=4;d+=3&m[7];p.timeStamp=d;if(s.pts===void 0&&s.dts===void 0){s.pts=p.timeStamp;s.dts=p.timeStamp}this.trigger("timestamp",p)}}s.frames.push(p);o+=10;o+=l}while(o<a);this.trigger("data",s)}};ul.prototype=new hd;var cl=ul,ml=il.TimestampRolloverStream,gl,hl,yl,_l=188,fl=71;gl=function(){var e=new Uint8Array(_l),t=0;gl.prototype.init.call(this);this.push=function(a){var n=0,r=_l,i;if(t){i=new Uint8Array(a.byteLength+t);i.set(e.subarray(0,t));i.set(a,t);t=0}else{i=a}while(r<i.byteLength){if(i[n]===fl&&i[r]===fl){this.trigger("data",i.subarray(n,r));n+=_l;r+=_l;continue}n++;r++}if(n<i.byteLength){e.set(i.subarray(n),0);t=i.byteLength-n}};this.flush=function(){if(t===_l&&e[0]===fl){this.trigger("data",e);t=0}this.trigger("done")}};gl.prototype=new hd;hl=function(){var e,t,a,n;hl.prototype.init.call(this);n=this;this.packetsWaitingForPmt=[];this.programMapTable=void 0;e=function(e,n){var r=0;if(n.payloadUnitStartIndicator){r+=e[r]+1}if("pat"===n.type){t(e.subarray(r),n)}else{a(e.subarray(r),n)}};t=function(e,t){t.section_number=e[7];t.last_section_number=e[8];n.pmtPid=(31&e[10])<<8|e[11];t.pmtPid=n.pmtPid};a=function(e,t){var a,r,i,s;if(!(1&e[5])){return}n.programMapTable={video:null,audio:null,"timed-metadata":{}};a=(15&e[1])<<8|e[2];r=3+a-4;i=(15&e[10])<<8|e[11];s=12+i;while(s<r){var o=e[s],d=(31&e[s+1])<<8|e[s+2];if(o===al.H264_STREAM_TYPE&&null===n.programMapTable.video){n.programMapTable.video=d}else if(o===al.ADTS_STREAM_TYPE&&null===n.programMapTable.audio){n.programMapTable.audio=d}else if(o===al.METADATA_STREAM_TYPE){n.programMapTable["timed-metadata"][d]=o}s+=((15&e[s+3])<<8|e[s+4])+5}t.programMapTable=n.programMapTable};this.push=function(t){var a={},n=4;a.payloadUnitStartIndicator=!!(64&t[1]);a.pid=31&t[1];a.pid<<=8;a.pid|=t[2];if(1<(48&t[3])>>>4){n+=t[n]+1}if(0===a.pid){a.type="pat";e(t.subarray(n),a);this.trigger("data",a)}else if(a.pid===this.pmtPid){a.type="pmt";e(t.subarray(n),a);this.trigger("data",a);while(this.packetsWaitingForPmt.length){this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}}else if(this.programMapTable===void 0){this.packetsWaitingForPmt.push([t,n,a])}else{this.processPes_(t,n,a)}};this.processPes_=function(e,t,a){if(a.pid===this.programMapTable.video){a.streamType=al.H264_STREAM_TYPE}else if(a.pid===this.programMapTable.audio){a.streamType=al.ADTS_STREAM_TYPE}else{a.streamType=this.programMapTable["timed-metadata"][a.pid]}a.type="pes";a.data=e.subarray(t);this.trigger("data",a)}};hl.prototype=new hd;hl.STREAM_TYPES={h264:27,adts:15};yl=function(){var e=this,t={data:[],size:0},a={data:[],size:0},n={data:[],size:0},r=function(e,t){var a;t.packetLength=6+(e[4]<<8|e[5]);t.dataAlignmentIndicator=0!=(4&e[6]);a=e[7];if(192&a){t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3;t.pts*=4;t.pts+=(6&e[13])>>>1;t.dts=t.pts;if(64&a){t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3;t.dts*=4;t.dts+=(6&e[18])>>>1}}t.data=e.subarray(9+e[8])},i=function(t,a,n){var s=new Uint8Array(t.size),o={type:a},d=0,l=0,p=!1,u;if(!t.data.length||9>t.size){return}o.trackId=t.data[0].pid;for(d=0;d<t.data.length;d++){u=t.data[d];s.set(u.data,l);l+=u.data.byteLength}r(s,o);p="video"===a||o.packetLength<=t.size;if(n||p){t.size=0;t.data.length=0}if(p){e.trigger("data",o)}};yl.prototype.init.call(this);this.push=function(r){({pat:function(){},pes:function(){var e,s;switch(r.streamType){case al.H264_STREAM_TYPE:case al.H264_STREAM_TYPE:e=t;s="video";break;case al.ADTS_STREAM_TYPE:e=a;s="audio";break;case al.METADATA_STREAM_TYPE:e=n;s="timed-metadata";break;default:return;}if(r.payloadUnitStartIndicator){i(e,s,!0)}e.data.push(r);e.size+=r.data.byteLength},pmt:function(){var t={type:"metadata",tracks:[]},a=r.programMapTable;if(null!==a.video){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+a.video,codec:"avc",type:"video"})}if(null!==a.audio){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+a.audio,codec:"adts",type:"audio"})}e.trigger("data",t)}})[r.type]()};this.flush=function(){i(t,"video");i(a,"audio");i(n,"timed-metadata");this.trigger("done")}};yl.prototype=new hd;var bl={PAT_PID:0,MP2T_PACKET_LENGTH:_l,TransportPacketStream:gl,TransportParseStream:hl,ElementaryStream:yl,TimestampRolloverStream:ml,CaptionStream:tl.CaptionStream,Cea608Stream:tl.Cea608Stream,MetadataStream:cl};for(var Tl in al){if(al.hasOwnProperty(Tl)){bl[Tl]=al[Tl]}}var vl=bl,Sl,kl=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Sl=function(){var e;Sl.prototype.init.call(this);this.push=function(t){var a=0,n=0,r,s,o,d,l,p;if("audio"!==t.type){return}if(e){d=e;e=new Uint8Array(d.byteLength+t.data.byteLength);e.set(d);e.set(t.data,d.byteLength)}else{e=t.data}while(a+5<e.length){if(255!==e[a]||240!=(246&e[a+1])){a++;continue}s=2*(1&~e[a+1]);r=(3&e[a+3])<<11|e[a+4]<<3|(224&e[a+5])>>5;l=1024*((3&e[a+6])+1);p=9e4*l/kl[(60&e[a+2])>>>2];o=a+r;if(e.byteLength<o){return}this.trigger("data",{pts:t.pts+n*p,dts:t.dts+n*p,sampleCount:l,audioobjecttype:(3&e[a+2]>>>6)+1,channelcount:(1&e[a+2])<<2|(192&e[a+3])>>>6,samplerate:kl[(60&e[a+2])>>>2],samplingfrequencyindex:(60&e[a+2])>>>2,samplesize:16,data:e.subarray(a+7+s,o)});if(e.byteLength===o){e=void 0;return}n++;e=e.subarray(o)}};this.flush=function(){this.trigger("done")}};Sl.prototype=new hd;var Cl=Sl,El;El=function(e){var t=e.byteLength,a=0,n=0;this.length=function(){return 8*t};this.bitsAvailable=function(){return 8*t+n};this.loadWord=function(){var r=e.byteLength-t,i=new Uint8Array(4),s=Math.min(4,t);if(0===s){throw new Error("no bytes available")}i.set(e.subarray(r,r+s));a=new DataView(i.buffer).getUint32(0);n=8*s;t-=s};this.skipBits=function(e){var r;if(n>e){a<<=e;n-=e}else{e-=n;r=Math.floor(e/8);e-=8*r;t-=r;this.loadWord();a<<=e;n-=e}};this.readBits=function(e){var r=Math.min(n,e),i=a>>>32-r;n-=r;if(0<n){a<<=r}else if(0<t){this.loadWord()}r=e-r;if(0<r){return i<<r|this.readBits(r)}return i};this.skipLeadingZeros=function(){var e;for(e=0;e<n;++e){if(0!=(a&2147483648>>>e)){a<<=e;n-=e;return e}}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e){return 1+e>>>1}return-1*(e>>>1)};this.readBoolean=function(){return 1===this.readBits(1)};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var Ll=El,Il,Pl,xl;Pl=function(){var e=0,t,a;Pl.prototype.init.call(this);this.push=function(n){var r;if(!a){a=n.data}else{r=new Uint8Array(a.byteLength+n.data.byteLength);r.set(a);r.set(n.data,a.byteLength);a=r}for(;e<a.byteLength-3;e++){if(1===a[e+2]){t=e+5;break}}while(t<a.byteLength){switch(a[t]){case 0:if(0!==a[t-1]){t+=2;break}else if(0!==a[t-2]){t++;break}if(e+3!=t-2){this.trigger("data",a.subarray(e+3,t-2))}do{t++}while(1!==a[t]&&t<a.length);e=t-2;t+=3;break;case 1:if(0!==a[t-1]||0!==a[t-2]){t+=3;break}this.trigger("data",a.subarray(e+3,t-2));e=t-2;t+=3;break;default:t+=3;break;}}a=a.subarray(e);t-=e;e=0};this.flush=function(){if(a&&3<a.byteLength){this.trigger("data",a.subarray(e+3))}a=null;e=0;this.trigger("done")}};Pl.prototype=new hd;xl={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0};Il=function(){var e=new Pl,t,a,n,r,i,s,o;Il.prototype.init.call(this);t=this;this.push=function(t){if("video"!==t.type){return}a=t.trackId;n=t.pts;r=t.dts;e.push(t)};e.on("data",function(e){var o={trackId:a,pts:n,dts:r,data:e};switch(31&e[0]){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp";o.escapedRBSP=i(e.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp";o.escapedRBSP=i(e.subarray(1));o.config=s(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp";break;default:break;}t.trigger("data",o)});e.on("done",function(){t.trigger("done")});this.flush=function(){e.flush()};o=function(e,t){var a=8,n=8,r,i;for(r=0;r<e;r++){if(0!=n){i=t.readExpGolomb();n=(a+i+256)%256}a=0==n?a:n}};i=function(e){var t=e.byteLength,a=[],n=1,r,s;while(n<t-2){if(0===e[n]&&0===e[n+1]&&3===e[n+2]){a.push(n+2);n+=2}else{n++}}if(0===a.length){return e}r=t-a.length;s=new Uint8Array(r);var o=0;for(n=0;n<r;o++,n++){if(o===a[0]){o++;a.shift()}s[n]=e[o]}return s};s=function(e){var t=0,a=0,n=0,r=0,s=1,d,l,p,u,c,m,g,h,y,_,f,b,T,v;d=new Ll(e);l=d.readUnsignedByte();u=d.readUnsignedByte();p=d.readUnsignedByte();d.skipUnsignedExpGolomb();if(xl[l]){c=d.readUnsignedExpGolomb();if(3===c){d.skipBits(1)}d.skipUnsignedExpGolomb();d.skipUnsignedExpGolomb();d.skipBits(1);if(d.readBoolean()){f=3!==c?8:12;for(v=0;v<f;v++){if(d.readBoolean()){if(6>v){o(16,d)}else{o(64,d)}}}}}d.skipUnsignedExpGolomb();m=d.readUnsignedExpGolomb();if(0===m){d.readUnsignedExpGolomb()}else if(1===m){d.skipBits(1);d.skipExpGolomb();d.skipExpGolomb();g=d.readUnsignedExpGolomb();for(v=0;v<g;v++){d.skipExpGolomb()}}d.skipUnsignedExpGolomb();d.skipBits(1);h=d.readUnsignedExpGolomb();y=d.readUnsignedExpGolomb();_=d.readBits(1);if(0===_){d.skipBits(1)}d.skipBits(1);if(d.readBoolean()){t=d.readUnsignedExpGolomb();a=d.readUnsignedExpGolomb();n=d.readUnsignedExpGolomb();r=d.readUnsignedExpGolomb()}if(d.readBoolean()){if(d.readBoolean()){T=d.readUnsignedByte();switch(T){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:{b=[d.readUnsignedByte()<<8|d.readUnsignedByte(),d.readUnsignedByte()<<8|d.readUnsignedByte()];break}}if(b){s=b[0]/b[1]}}}return{profileIdc:l,levelIdc:p,profileCompatibility:u,width:Math.ceil((16*(h+1)-2*t-2*a)*s),height:16*((2-_)*(y+1))-2*n-2*r}}};Il.prototype=new hd;var Dl={H264Stream:Il,NalByteStream:Pl},Al=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],wl=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Ol=function(e,t,a){var n,r="";for(n=t;n<a;n++){r+="%"+("00"+e[n].toString(16)).slice(-2)}return r},Ul=function(e,t,a){return unescape(Ol(e,t,a))},Rl=function(e){var t=0;while(t+5<e.length){if(255!==e[t]||240!=(246&e[t+1])){t++;continue}return Al[(60&e[t+2])>>>2]}return null},Ml=function(e){var t,a,n,r;t=10;if(64&e[5]){t+=4;t+=wl(e.subarray(10,14))}do{a=wl(e.subarray(t+4,t+8));if(1>a){return null}r=String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3]);if("PRIV"===r){n=e.subarray(t+10,t+a+10);for(var s=0;s<n.byteLength;s++){if(0===n[s]){var o=Ul(n,0,s);if("com.apple.streaming.transportStreamTimestamp"===o){var l=n.subarray(s+1),d=(1&l[3])<<30|l[4]<<22|l[5]<<14|l[6]<<6|l[7]>>>2;d*=4;d+=3&l[7];return d}break}}}t+=10;t+=a}while(t<e.byteLength);return null},Bl={isLikelyAacData:function(e){if(e[0]===73&&e[1]===68&&e[2]===51){return!0}return!1},parseId3TagSize:function(e,t){var a=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],n=e[t+5];if((16&n)>>4){return a+20}return a+10},parseAdtsSize:function(e,t){var a=(224&e[t+5])>>5,n=e[t+4]<<3,r=e[t+3]&6144;return r|n|a},parseType:function(e,t){if(e[t]===73&&e[t+1]===68&&e[t+2]===51){return"timed-metadata"}else if(e[t]&!0&&240==(240&e[t+1])){return"audio"}return null},parseSampleRate:Rl,parseAacTimestamp:Ml},Nl;Nl=function(){var e=new Uint8Array,t=0;Nl.prototype.init.call(this);this.setTimestamp=function(e){t=e};this.push=function(a){var n=0,r=0,i,s,o,d;if(e.length){d=e.length;e=new Uint8Array(a.byteLength+d);e.set(e.subarray(0,d));e.set(a,d)}else{e=a}while(3<=e.length-r){if(e[r]===73&&e[r+1]===68&&e[r+2]===51){if(10>e.length-r){break}n=Bl.parseId3TagSize(e,r);if(r+n>e.length){break}s={type:"timed-metadata",data:e.subarray(r,r+n)};this.trigger("data",s);r+=n;continue}else if(255==(255&e[r])&&240==(240&e[r+1])){if(7>e.length-r){break}n=Bl.parseAdtsSize(e,r);if(r+n>e.length){break}o={type:"audio",data:e.subarray(r,r+n),pts:t,dts:t};this.trigger("data",o);r+=n;continue}r++}i=e.length-r;if(0<i){e=e.subarray(r)}else{e=new Uint8Array}}};Nl.prototype=new hd;var jl=Nl,Fl=Dl.H264Stream,Hl=Bl.isLikelyAacData,Vl=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],ql=["width","height","profileIdc","levelIdc","profileCompatibility"],zl,Gl,Wl,Kl,Yl=function(e,t){var a;if(e.length!==t.length){return!1}for(a=0;a<e.length;a++){if(e[a]!==t[a]){return!1}}return!0},Xl=function(e,t,a,n,r,i){return{start:{dts:e,pts:e+(a-t)},end:{dts:e+(n-t),pts:e+(r-a)},prependedContentDuration:i,baseMediaDecodeTime:e}};Gl=function(e,t){var a=[],n=0,r=0,i=0,s=1/0;t=t||{};Gl.prototype.init.call(this);this.push=function(t){Vd.collectDtsInfo(e,t);if(e){Vl.forEach(function(a){e[a]=t[a]})}a.push(t)};this.setEarliestDts=function(t){r=t-e.timelineStartInfo.baseMediaDecodeTime};this.setVideoBaseMediaDecodeTime=function(e){s=e};this.setAudioAppendStart=function(e){i=e};this.flush=function(){var o,d,l,p;if(0===a.length){this.trigger("done","AudioSegmentStream");return}o=Hd.trimAdtsFramesByEarliestDts(a,e,r);e.baseMediaDecodeTime=Vd.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);Hd.prefixWithSilence(e,o,i,s);e.samples=Hd.generateSampleTable(o);l=md.mdat(Hd.concatenateFrameData(o));a=[];d=md.moof(n,[e]);p=new Uint8Array(d.byteLength+l.byteLength);n++;p.set(d);p.set(l,d.byteLength);Vd.clearDtsInfo(e);this.trigger("data",{track:e,boxes:p});this.trigger("done","AudioSegmentStream")}};Gl.prototype=new hd;zl=function(e,t){var a=0,n=[],r=[],i,s;t=t||{};zl.prototype.init.call(this);delete e.minPTS;this.gopCache_=[];this.push=function(t){Vd.collectDtsInfo(e,t);if("seq_parameter_set_rbsp"===t.nalUnitType&&!i){i=t.config;e.sps=[t.data];ql.forEach(function(t){e[t]=i[t]},this)}if("pic_parameter_set_rbsp"===t.nalUnitType&&!s){s=t.data;e.pps=[t.data]}n.push(t)};this.flush=function(){var i,s,o,d,l,p,u=0,c,m;while(n.length){if("access_unit_delimiter_rbsp"===n[0].nalUnitType){break}n.shift()}if(0===n.length){this.resetStream_();this.trigger("done","VideoSegmentStream");return}i=Sd.groupNalsIntoFrames(n);o=Sd.groupFramesIntoGops(i);if(!o[0][0].keyFrame){s=this.getGopForFusion_(n[0],e);if(s){u=s.duration;o.unshift(s);o.byteLength+=s.byteLength;o.nalCount+=s.nalCount;o.pts=s.pts;o.dts=s.dts;o.duration+=s.duration}else{o=Sd.extendFirstKeyFrame(o)}}if(r.length){var g;if(t.alignGopsAtEnd){g=this.alignGopsAtEnd_(o)}else{g=this.alignGopsAtStart_(o)}if(!g){this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}Vd.clearDtsInfo(e);o=g}Vd.collectDtsInfo(e,o);e.samples=Sd.generateSampleTable(o);l=md.mdat(Sd.concatenateNalData(o));e.baseMediaDecodeTime=Vd.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);this.trigger("processedGopsInfo",o.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}));c=o[0];m=o[o.length-1];this.trigger("segmentTimingInfo",Xl(e.baseMediaDecodeTime,c.dts,c.pts,m.dts+m.duration,m.pts+m.duration,u));this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime);this.trigger("timelineStartInfo",e.timelineStartInfo);d=md.moof(a,[e]);p=new Uint8Array(d.byteLength+l.byteLength);a++;p.set(d);p.set(l,d.byteLength);this.trigger("data",{track:e,boxes:p});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.resetStream_=function(){Vd.clearDtsInfo(e);i=void 0;s=void 0};this.getGopForFusion_=function(t){var a=1/0,n,r,s,o,d;for(d=0;d<this.gopCache_.length;d++){o=this.gopCache_[d];s=o.gop;if(!(e.pps&&Yl(e.pps[0],o.pps[0]))||!(e.sps&&Yl(e.sps[0],o.sps[0]))){continue}if(s.dts<e.timelineStartInfo.dts){continue}n=t.dts-s.dts-s.duration;if(n>=-10000&&n<=45000){if(!r||a>n){r=o;a=n}}}if(r){return r.gop}return null};this.alignGopsAtStart_=function(e){var t,a,n,i,s,o,d,l;s=e.byteLength;o=e.nalCount;d=e.duration;t=a=0;while(t<r.length&&a<e.length){n=r[t];i=e[a];if(n.pts===i.pts){break}if(i.pts>n.pts){t++;continue}a++;s-=i.byteLength;o-=i.nalCount;d-=i.duration}if(0===a){return e}if(a===e.length){return null}l=e.slice(a);l.byteLength=s;l.duration=d;l.nalCount=o;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsAtEnd_=function(e){var t,a,n,i,s,o;t=r.length-1;a=e.length-1;s=null;o=!1;while(0<=t&&0<=a){n=r[t];i=e[a];if(n.pts===i.pts){o=!0;break}if(n.pts>i.pts){t--;continue}if(t===r.length-1){s=a}a--}if(!o&&null===s){return null}var d;if(o){d=a}else{d=s}if(0===d){return e}var l=e.slice(d),p=l.reduce(function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e},{byteLength:0,duration:0,nalCount:0});l.byteLength=p.byteLength;l.duration=p.duration;l.nalCount=p.nalCount;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsWith=function(e){r=e}};zl.prototype=new hd;Kl=function(e,t){this.numberOfTracks=0;this.metadataStream=t;e=e||{};if("undefined"!=typeof e.remux){this.remuxTracks=!!e.remux}else{this.remuxTracks=!0}if("boolean"==typeof e.keepOriginalTimestamps){this.keepOriginalTimestamps=e.keepOriginalTimestamps}this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;Kl.prototype.init.call(this);this.push=function(e){if(e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}this.pendingTracks.push(e.track);this.pendingBoxes.push(e.boxes);this.pendingBytes+=e.boxes.byteLength;if("video"===e.track.type){this.videoTrack=e.track}if("audio"===e.track.type){this.audioTrack=e.track}}};Kl.prototype=new hd;Kl.prototype.flush=function(e){var t=0,a={captions:[],captionStreams:{},metadata:[],info:{}},n,r,s,o=0,d;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e){return}else if(this.remuxTracks){return}else if(0===this.pendingTracks.length){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}}if(this.videoTrack){o=this.videoTrack.timelineStartInfo.pts;ql.forEach(function(e){a.info[e]=this.videoTrack[e]},this)}else if(this.audioTrack){o=this.audioTrack.timelineStartInfo.pts;Vl.forEach(function(e){a.info[e]=this.audioTrack[e]},this)}if(1===this.pendingTracks.length){a.type=this.pendingTracks[0].type}else{a.type="combined"}this.emittedTracks+=this.pendingTracks.length;s=md.initSegment(this.pendingTracks);a.initSegment=new Uint8Array(s.byteLength);a.initSegment.set(s);a.data=new Uint8Array(this.pendingBytes);for(d=0;d<this.pendingBoxes.length;d++){a.data.set(this.pendingBoxes[d],t);t+=this.pendingBoxes[d].byteLength}for(d=0;d<this.pendingCaptions.length;d++){n=this.pendingCaptions[d];n.startTime=n.startPts;if(!this.keepOriginalTimestamps){n.startTime-=o}n.startTime/=9e4;n.endTime=n.endPts;if(!this.keepOriginalTimestamps){n.endTime-=o}n.endTime/=9e4;a.captionStreams[n.stream]=!0;a.captions.push(n)}for(d=0;d<this.pendingMetadata.length;d++){r=this.pendingMetadata[d];r.cueTime=r.pts;if(!this.keepOriginalTimestamps){r.cueTime-=o}r.cueTime/=9e4;a.metadata.push(r)}a.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",a);if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};Wl=function(e){var t=this,a=!0,n,r;Wl.prototype.init.call(this);e=e||{};this.baseMediaDecodeTime=e.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var a={};this.transmuxPipeline_=a;a.type="aac";a.metadataStream=new vl.MetadataStream;a.aacStream=new jl;a.audioTimestampRolloverStream=new vl.TimestampRolloverStream("audio");a.timedMetadataTimestampRolloverStream=new vl.TimestampRolloverStream("timed-metadata");a.adtsStream=new Cl;a.coalesceStream=new Kl(e,a.metadataStream);a.headOfPipeline=a.aacStream;a.aacStream.pipe(a.audioTimestampRolloverStream).pipe(a.adtsStream);a.aacStream.pipe(a.timedMetadataTimestampRolloverStream).pipe(a.metadataStream).pipe(a.coalesceStream);a.metadataStream.on("timestamp",function(e){a.aacStream.setTimestamp(e.timeStamp)});a.aacStream.on("data",function(n){if("timed-metadata"===n.type&&!a.audioSegmentStream){r=r||{timelineStartInfo:{baseMediaDecodeTime:t.baseMediaDecodeTime},codec:"adts",type:"audio"};a.coalesceStream.numberOfTracks++;a.audioSegmentStream=new Gl(r,e);a.adtsStream.pipe(a.audioSegmentStream).pipe(a.coalesceStream)}});a.coalesceStream.on("data",this.trigger.bind(this,"data"));a.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var a={};this.transmuxPipeline_=a;a.type="ts";a.metadataStream=new vl.MetadataStream;a.packetStream=new vl.TransportPacketStream;a.parseStream=new vl.TransportParseStream;a.elementaryStream=new vl.ElementaryStream;a.videoTimestampRolloverStream=new vl.TimestampRolloverStream("video");a.audioTimestampRolloverStream=new vl.TimestampRolloverStream("audio");a.timedMetadataTimestampRolloverStream=new vl.TimestampRolloverStream("timed-metadata");a.adtsStream=new Cl;a.h264Stream=new Fl;a.captionStream=new vl.CaptionStream;a.coalesceStream=new Kl(e,a.metadataStream);a.headOfPipeline=a.packetStream;a.packetStream.pipe(a.parseStream).pipe(a.elementaryStream);a.elementaryStream.pipe(a.videoTimestampRolloverStream).pipe(a.h264Stream);a.elementaryStream.pipe(a.audioTimestampRolloverStream).pipe(a.adtsStream);a.elementaryStream.pipe(a.timedMetadataTimestampRolloverStream).pipe(a.metadataStream).pipe(a.coalesceStream);a.h264Stream.pipe(a.captionStream).pipe(a.coalesceStream);a.elementaryStream.on("data",function(s){var o;if("metadata"===s.type){o=s.tracks.length;while(o--){if(!n&&"video"===s.tracks[o].type){n=s.tracks[o];n.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime}else if(!r&&"audio"===s.tracks[o].type){r=s.tracks[o];r.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime}}if(n&&!a.videoSegmentStream){a.coalesceStream.numberOfTracks++;a.videoSegmentStream=new zl(n,e);a.videoSegmentStream.on("timelineStartInfo",function(e){if(r){r.timelineStartInfo=e;a.audioSegmentStream.setEarliestDts(e.dts)}});a.videoSegmentStream.on("processedGopsInfo",t.trigger.bind(t,"gopInfo"));a.videoSegmentStream.on("segmentTimingInfo",t.trigger.bind(t,"videoSegmentTimingInfo"));a.videoSegmentStream.on("baseMediaDecodeTime",function(e){if(r){a.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}});a.h264Stream.pipe(a.videoSegmentStream).pipe(a.coalesceStream)}if(r&&!a.audioSegmentStream){a.coalesceStream.numberOfTracks++;a.audioSegmentStream=new Gl(r,e);a.adtsStream.pipe(a.audioSegmentStream).pipe(a.coalesceStream)}}});a.coalesceStream.on("data",this.trigger.bind(this,"data"));a.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(t){var a=this.transmuxPipeline_;if(!e.keepOriginalTimestamps){this.baseMediaDecodeTime=t}if(r){r.timelineStartInfo.dts=void 0;r.timelineStartInfo.pts=void 0;Vd.clearDtsInfo(r);if(!e.keepOriginalTimestamps){r.timelineStartInfo.baseMediaDecodeTime=t}if(a.audioTimestampRolloverStream){a.audioTimestampRolloverStream.discontinuity()}}if(n){if(a.videoSegmentStream){a.videoSegmentStream.gopCache_=[];a.videoTimestampRolloverStream.discontinuity()}n.timelineStartInfo.dts=void 0;n.timelineStartInfo.pts=void 0;Vd.clearDtsInfo(n);a.captionStream.reset();if(!e.keepOriginalTimestamps){n.timelineStartInfo.baseMediaDecodeTime=t}}if(a.timedMetadataTimestampRolloverStream){a.timedMetadataTimestampRolloverStream.discontinuity()}};this.setAudioAppendStart=function(e){if(r){this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)}};this.alignGopsWith=function(e){if(n&&this.transmuxPipeline_.videoSegmentStream){this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)}};this.push=function(e){if(a){var t=Hl(e);if(t&&"aac"!==this.transmuxPipeline_.type){this.setupAacPipeline()}else if(!t&&"ts"!==this.transmuxPipeline_.type){this.setupTsPipeline()}a=!1}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){a=!0;this.transmuxPipeline_.headOfPipeline.flush()};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream){this.transmuxPipeline_.captionStream.reset()}}};Wl.prototype=new hd;var $l={Transmuxer:Wl,VideoSegmentStream:zl,AudioSegmentStream:Gl,AUDIO_PROPERTIES:Vl,VIDEO_PROPERTIES:ql,generateVideoSegmentTimingInfo:Xl},Ql,Jl,Zl=xo.parseType,ep=function(e){return new Date(1e3*e-20828448e5)},tp=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},ap=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=[],n,r;for(n=0;n+4<e.length;n+=r){r=t.getUint32(n);n+=4;if(0>=r){a.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(31&e[n]){case 1:a.push("slice_layer_without_partitioning_rbsp");break;case 5:a.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:a.push("sei_rbsp");break;case 7:a.push("seq_parameter_set_rbsp");break;case 8:a.push("pic_parameter_set_rbsp");break;case 9:a.push("access_unit_delimiter_rbsp");break;default:a.push(31&"UNKNOWN NAL - "+e[n]);break;}}return a},np={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:Ql(e.subarray(78,e.byteLength))}},avcC:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},n=31&e[5],r,s,o,d;o=6;for(d=0;d<n;d++){s=t.getUint16(o);o+=2;a.sps.push(new Uint8Array(e.subarray(o,o+s)));o+=s}r=e[o];o++;for(d=0;d<r;d++){s=t.getUint16(o);o+=2;a.pps.push(new Uint8Array(e.subarray(o,o+s)));o+=s}return a},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:63&e[12]>>>2,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:31&e[26]>>>3,samplingFrequencyIndex:(7&e[26])<<1|1&e[27]>>>7,channelConfiguration:15&e[27]>>>3}}}},ftyp:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={majorBrand:Zl(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},n=8;while(n<e.byteLength){a.compatibleBrands.push(Zl(e.subarray(n,n+4)));n+=4}return a},dinf:function(e){return{boxes:Ql(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:Ql(e.subarray(8))}},hdlr:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:Zl(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}a.name+=String.fromCharCode(e[n])}a.name=decodeURIComponent(escape(a.name));return a},mdat:function(e){return{byteLength:e.byteLength,nals:ap(e)}},mdhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,n,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};if(1===r.version){a+=4;r.creationTime=ep(t.getUint32(a));a+=8;r.modificationTime=ep(t.getUint32(a));a+=4;r.timescale=t.getUint32(a);a+=8;r.duration=t.getUint32(a)}else{r.creationTime=ep(t.getUint32(a));a+=4;r.modificationTime=ep(t.getUint32(a));a+=4;r.timescale=t.getUint32(a);a+=4;r.duration=t.getUint32(a)}a+=4;n=t.getUint16(a);r.language+=String.fromCharCode((n>>10)+96);r.language+=String.fromCharCode(((992&n)>>5)+96);r.language+=String.fromCharCode((31&n)+96);return r},mdia:function(e){return{boxes:Ql(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:Ql(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};if(28<e.byteLength){a.streamDescriptor=Ql(e.subarray(28))[0]}return a},moof:function(e){return{boxes:Ql(e)}},moov:function(e){return{boxes:Ql(e)}},mvex:function(e){return{boxes:Ql(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};if(1===n.version){a+=4;n.creationTime=ep(t.getUint32(a));a+=8;n.modificationTime=ep(t.getUint32(a));a+=4;n.timescale=t.getUint32(a);a+=8;n.duration=t.getUint32(a)}else{n.creationTime=ep(t.getUint32(a));a+=4;n.modificationTime=ep(t.getUint32(a));a+=4;n.timescale=t.getUint32(a);a+=4;n.duration=t.getUint32(a)}a+=4;n.rate=t.getUint16(a)+t.getUint16(a+2)/16;a+=4;n.volume=t.getUint8(a)+t.getUint8(a+1)/8;a+=2;a+=2;a+=8;n.matrix=new Uint32Array(e.subarray(a,a+36));a+=36;a+=24;n.nextTrackId=t.getUint32(a);return n},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},a;for(a=4;a<e.byteLength;a++){t.samples.push({dependsOn:(48&e[a])>>4,isDependedOn:(12&e[a])>>2,hasRedundancy:3&e[a]})}return t},sidx:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8),earliestPresentationTime:t.getUint32(12),firstOffset:t.getUint32(16)},n=t.getUint16(22),r;for(r=24;n;r+=12,n--){a.references.push({referenceType:(128&e[r])>>>7,referencedSize:2147483647&t.getUint32(r),subsegmentDuration:t.getUint32(r+4),startsWithSap:!!(128&e[r+8]),sapType:(112&e[r+8])>>>4,sapDeltaTime:268435455&t.getUint32(r+8)})}return a},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:Ql(e)}},stco:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},n=t.getUint32(4),r;for(r=8;n;r+=4,n--){a.chunkOffsets.push(t.getUint32(r))}return a},stsc:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=t.getUint32(4),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]},r;for(r=8;a;r+=12,a--){n.sampleToChunks.push({firstChunk:t.getUint32(r),samplesPerChunk:t.getUint32(r+4),sampleDescriptionIndex:t.getUint32(r+8)})}return n},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:Ql(e.subarray(8))}},stsz:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:t.getUint32(4),entries:[]},n;for(n=12;n<e.byteLength;n+=4){a.entries.push(t.getUint32(n))}return a},stts:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},n=t.getUint32(4),r;for(r=8;n;r+=8,n--){a.timeToSamples.push({sampleCount:t.getUint32(r),sampleDelta:t.getUint32(r+4)})}return a},styp:function(e){return np.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};if(1===t.version){t.baseMediaDecodeTime*=Math.pow(2,32);t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]}return t},tfhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4)},n=1&a.flags[2],r=2&a.flags[2],s=8&a.flags[2],o=16&a.flags[2],d=32&a.flags[2],l=65536&a.flags[0],p=131072&a.flags[0],u;u=8;if(n){u+=4;a.baseDataOffset=t.getUint32(12);u+=4}if(r){a.sampleDescriptionIndex=t.getUint32(u);u+=4}if(s){a.defaultSampleDuration=t.getUint32(u);u+=4}if(o){a.defaultSampleSize=t.getUint32(u);u+=4}if(d){a.defaultSampleFlags=t.getUint32(u)}if(l){a.durationIsEmpty=!0}if(!n&&p){a.baseDataOffsetIsMoof=!0}return a},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};if(1===n.version){a+=4;n.creationTime=ep(t.getUint32(a));a+=8;n.modificationTime=ep(t.getUint32(a));a+=4;n.trackId=t.getUint32(a);a+=4;a+=8;n.duration=t.getUint32(a)}else{n.creationTime=ep(t.getUint32(a));a+=4;n.modificationTime=ep(t.getUint32(a));a+=4;n.trackId=t.getUint32(a);a+=4;a+=4;n.duration=t.getUint32(a)}a+=4;a+=8;n.layer=t.getUint16(a);a+=2;n.alternateGroup=t.getUint16(a);a+=2;n.volume=t.getUint8(a)+t.getUint8(a+1)/8;a+=2;a+=2;n.matrix=new Uint32Array(e.subarray(a,a+36));a+=36;n.width=t.getUint16(a)+t.getUint16(a+2)/16;a+=4;n.height=t.getUint16(a)+t.getUint16(a+2)/16;return n},traf:function(e){return{boxes:Ql(e)}},trak:function(e){return{boxes:Ql(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},a=new DataView(e.buffer,e.byteOffset,e.byteLength),n=1&t.flags[2],r=4&t.flags[2],i=1&t.flags[1],s=2&t.flags[1],o=4&t.flags[1],d=8&t.flags[1],l=a.getUint32(4),p=8,u;if(n){t.dataOffset=a.getInt32(p);p+=4}if(r&&l){u={flags:tp(e.subarray(p,p+4))};p+=4;if(i){u.duration=a.getUint32(p);p+=4}if(s){u.size=a.getUint32(p);p+=4}if(d){u.compositionTimeOffset=a.getUint32(p);p+=4}t.samples.push(u);l--}while(l--){u={};if(i){u.duration=a.getUint32(p);p+=4}if(s){u.size=a.getUint32(p);p+=4}if(o){u.flags=tp(e.subarray(p,p+4));p+=4}if(d){u.compositionTimeOffset=a.getUint32(p);p+=4}t.samples.push(u)}return t},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};Ql=function(e){for(var t=0,a=[],n,r,s,o,d,l=new ArrayBuffer(e.length),p=new Uint8Array(l),u=0;u<e.length;++u){p[u]=e[u]}n=new DataView(l);while(t<e.byteLength){r=n.getUint32(t);s=Zl(e.subarray(t+4,t+8));o=1<r?t+r:e.byteLength;d=(np[s]||function(e){return{data:e}})(e.subarray(t+8,o));d.size=r;d.type=s;a.push(d);t=o}return a};Jl=function(e,t){var a;t=t||0;a=Array(2*t+1).join(" ");return e.map(function(e){return a+e.type+"\n"+Object.keys(e).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(t){var n=a+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var i=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);if(!i){return n+"<>"}if(1===i.length){return n+"<"+i.join("").slice(1)+">"}return n+"<\n"+i.map(function(e){return a+"  "+e}).join("\n")+"\n"+a+"  >"}return n+JSON.stringify(r,null,2).split("\n").map(function(e,t){if(0===t){return e}return a+"  "+e}).join("\n")}).join("\n")+(e.boxes?"\n"+Jl(e.boxes,t+1):"")}).join("\n")};var rp={inspect:Ql,textify:Jl,parseTfdt:np.tfdt,parseHdlr:np.hdlr,parseTfhd:np.tfhd,parseTrun:np.trun,parseSidx:np.sidx},ip=Kd.discardEmulationPreventionBytes,sp=tl.CaptionStream,op=function(e,t){for(var a=e,n=0,r;n<t.length;n++){r=t[n];if(a<r.size){return r}a-=r.size}return null},dp=function(e,t,a){var n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[],s,o,d,l;for(o=0;o+4<e.length;o+=d){d=n.getUint32(o);o+=4;if(0>=d){continue}switch(31&e[o]){case 6:var p=e.subarray(o+1,o+1+d),u=op(o,t);s={nalUnitType:"sei_rbsp",size:d,data:p,escapedRBSP:ip(p),trackId:a};if(u){s.pts=u.pts;s.dts=u.dts;l=u}else{s.pts=l.pts;s.dts=l.dts}r.push(s);break;default:break;}}return r},lp=function(e,t,a){var n=t,r=a.defaultSampleDuration||0,i=a.defaultSampleSize||0,s=a.trackId,o=[];e.forEach(function(e){var t=rp.parseTrun(e),a=t.samples;a.forEach(function(e){if(e.duration===void 0){e.duration=r}if(e.size===void 0){e.size=i}e.trackId=s;e.dts=n;if(e.compositionTimeOffset===void 0){e.compositionTimeOffset=0}e.pts=n+e.compositionTimeOffset;n+=e.duration});o=o.concat(a)});return o},pp=function(e,t){var a=xo.findBox(e,["moof","traf"]),n=xo.findBox(e,["mdat"]),r={},i=[];n.forEach(function(e,t){var n=a[t];i.push({mdat:e,traf:n})});i.forEach(function(e){var a=e.mdat,n=e.traf,i=xo.findBox(n,["tfhd"]),s=rp.parseTfhd(i[0]),o=s.trackId,d=xo.findBox(n,["tfdt"]),l=0<d.length?rp.parseTfdt(d[0]).baseMediaDecodeTime:0,p=xo.findBox(n,["trun"]),u,c;if(t===o&&0<p.length){u=lp(p,l,s);c=dp(a,u,o);if(!r[o]){r[o]=[]}r[o]=r[o].concat(c)}});return r},up=function(e,t,a){var n;if(!t){return null}n=pp(e,t);return{seiNals:n[t],timescale:a}},cp={generator:md,probe:xo,Transmuxer:$l.Transmuxer,AudioSegmentStream:$l.AudioSegmentStream,VideoSegmentStream:$l.VideoSegmentStream,CaptionParser:function(){var e=!1,t,a,n,r,i;this.isInitialized=function(){return e};this.init=function(){t=new sp;e=!0;t.on("data",function(e){e.startTime=e.startPts/r;e.endTime=e.endPts/r;i.captions.push(e);i.captionStreams[e.stream]=!0})};this.isNewInit=function(e,t){if(e&&0===e.length||t&&"object"===_typeof(t)&&0===Object.keys(t).length){return!1}return n!==e[0]||r!==t[n]};this.parse=function(e,t,s){var o;if(!this.isInitialized()){return null}else if(!t||!s){return null}else if(this.isNewInit(t,s)){n=t[0];r=s[n]}else if(!n||!r){a.push(e);return null}while(0<a.length){var d=a.shift();this.parse(d,t,s)}o=up(e,n,r);if(null===o||!o.seiNals){return null}this.pushNals(o.seiNals);this.flushStream();return i};this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length){return null}e.forEach(function(e){t.push(e)})};this.flushStream=function(){if(!this.isInitialized()){return null}t.flush()};this.clearParsedCaptions=function(){i.captions=[];i.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized()){return null}t.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){a=[];n=null;r=null;if(!i){i={captions:[],captionStreams:{}}}else{this.clearParsedCaptions()}this.resetCaptionStream()};this.reset()}},mp=cp.CaptionParser,gp=function(e){var t=31&e[1];t<<=8;t|=e[2];return t},hp=function(e){return!!(64&e[1])},yp=function(e){var t=0;if(1<(48&e[3])>>>4){t+=e[4]+1}return t},_p=function(e){var t={},a=hp(e),n=4+yp(e);if(a){n+=e[n]+1}if(!(1&e[n+5])){return}var r,s,o;r=(15&e[n+1])<<8|e[n+2];s=3+r-4;o=(15&e[n+10])<<8|e[n+11];var d=12+o;while(d<s){var l=n+d;t[(31&e[l+1])<<8|e[l+2]]=e[l];d+=((15&e[l+3])<<8|e[l+4])+5}return t},fp=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null;}},bp=il.handleRollover,Tp={};Tp.ts={parseType:function(e,t){var a=gp(e);if(0===a){return"pat"}else if(a===t){return"pmt"}else if(t){return"pes"}return null},parsePat:function(e){var t=hp(e),a=4+yp(e);if(t){a+=e[a]+1}return(31&e[a+10])<<8|e[a+11]},parsePmt:_p,parsePayloadUnitStartIndicator:hp,parsePesType:function(e,t){var a=gp(e),n=t[a];switch(n){case al.H264_STREAM_TYPE:return"video";case al.ADTS_STREAM_TYPE:return"audio";case al.METADATA_STREAM_TYPE:return"timed-metadata";default:return null;}},parsePesTime:function(e){var t=hp(e);if(!t){return null}var a=4+yp(e);if(a>=e.byteLength){return null}var n=null,r;r=e[a+7];if(192&r){n={};n.pts=(14&e[a+9])<<27|(255&e[a+10])<<20|(254&e[a+11])<<12|(255&e[a+12])<<5|(254&e[a+13])>>>3;n.pts*=4;n.pts+=(6&e[a+13])>>>1;n.dts=n.pts;if(64&r){n.dts=(14&e[a+14])<<27|(255&e[a+15])<<20|(254&e[a+16])<<12|(255&e[a+17])<<5|(254&e[a+18])>>>3;n.dts*=4;n.dts+=(6&e[a+18])>>>1}}return n},videoPacketContainsKeyFrame:function(e){var t=4+yp(e),a=e.subarray(t),n=0,r=0,i=!1,s;for(;r<a.byteLength-3;r++){if(1===a[r+2]){n=r+5;break}}while(n<a.byteLength){switch(a[n]){case 0:if(0!==a[n-1]){n+=2;break}else if(0!==a[n-2]){n++;break}if(r+3!==n-2){s=fp(31&a[r+3]);if("slice_layer_without_partitioning_rbsp_idr"===s){i=!0}}do{n++}while(1!==a[n]&&n<a.length);r=n-2;n+=3;break;case 1:if(0!==a[n-1]||0!==a[n-2]){n+=3;break}s=fp(31&a[r+3]);if("slice_layer_without_partitioning_rbsp_idr"===s){i=!0}r=n-2;n+=3;break;default:n+=3;break;}}a=a.subarray(r);n-=r;r=0;if(a&&3<a.byteLength){s=fp(31&a[r+3]);if("slice_layer_without_partitioning_rbsp_idr"===s){i=!0}}return i}};Tp.aac=Bl;var vp=function(e,t){var a=0,n=188,r,i;while(n<e.byteLength){if(e[a]===71&&e[n]===71){r=e.subarray(a,n);i=Tp.ts.parseType(r,t.pid);switch(i){case"pat":if(!t.pid){t.pid=Tp.ts.parsePat(r)}break;case"pmt":if(!t.table){t.table=Tp.ts.parsePmt(r)}break;default:break;}if(t.pid&&t.table){return}a+=188;n+=188;continue}a++;n++}},Sp=function(e,t,a){var n=0,r=188,i,s,o,d,l,p=!1;while(r<=e.byteLength){if(e[n]===71&&(e[r]===71||r===e.byteLength)){i=e.subarray(n,r);s=Tp.ts.parseType(i,t.pid);switch(s){case"pes":o=Tp.ts.parsePesType(i,t.table);d=Tp.ts.parsePayloadUnitStartIndicator(i);if("audio"===o&&d){l=Tp.ts.parsePesTime(i);if(l){l.type="audio";a.audio.push(l);p=!0}}break;default:break;}if(p){break}n+=188;r+=188;continue}n++;r++}r=e.byteLength;n=r-188;p=!1;while(0<=n){if(e[n]===71&&(e[r]===71||r===e.byteLength)){i=e.subarray(n,r);s=Tp.ts.parseType(i,t.pid);switch(s){case"pes":o=Tp.ts.parsePesType(i,t.table);d=Tp.ts.parsePayloadUnitStartIndicator(i);if("audio"===o&&d){l=Tp.ts.parsePesTime(i);if(l){l.type="audio";a.audio.push(l);p=!0}}break;default:break;}if(p){break}n-=188;r-=188;continue}n--;r--}},kp=function(e,t,a){var n=0,r=188,s,o,d,l,p,u,c,m,g=!1,h={data:[],size:0};while(r<e.byteLength){if(e[n]===71&&e[r]===71){s=e.subarray(n,r);o=Tp.ts.parseType(s,t.pid);switch(o){case"pes":d=Tp.ts.parsePesType(s,t.table);l=Tp.ts.parsePayloadUnitStartIndicator(s);if("video"===d){if(l&&!g){p=Tp.ts.parsePesTime(s);if(p){p.type="video";a.video.push(p);g=!0}}if(!a.firstKeyFrame){if(l){if(0!==h.size){u=new Uint8Array(h.size);c=0;while(h.data.length){m=h.data.shift();u.set(m,c);c+=m.byteLength}if(Tp.ts.videoPacketContainsKeyFrame(u)){a.firstKeyFrame=Tp.ts.parsePesTime(u);a.firstKeyFrame.type="video"}h.size=0}}h.data.push(s);h.size+=s.byteLength}}break;default:break;}if(g&&a.firstKeyFrame){break}n+=188;r+=188;continue}n++;r++}r=e.byteLength;n=r-188;g=!1;while(0<=n){if(e[n]===71&&e[r]===71){s=e.subarray(n,r);o=Tp.ts.parseType(s,t.pid);switch(o){case"pes":d=Tp.ts.parsePesType(s,t.table);l=Tp.ts.parsePayloadUnitStartIndicator(s);if("video"===d&&l){p=Tp.ts.parsePesTime(s);if(p){p.type="video";a.video.push(p);g=!0}}break;default:break;}if(g){break}n-=188;r-=188;continue}n--;r--}},Cp=function(e,t){if(e.audio&&e.audio.length){var a=t;if("undefined"==typeof a){a=e.audio[0].dts}e.audio.forEach(function(e){e.dts=bp(e.dts,a);e.pts=bp(e.pts,a);e.dtsTime=e.dts/90000;e.ptsTime=e.pts/90000})}if(e.video&&e.video.length){var n=t;if("undefined"==typeof n){n=e.video[0].dts}e.video.forEach(function(e){e.dts=bp(e.dts,n);e.pts=bp(e.pts,n);e.dtsTime=e.dts/90000;e.ptsTime=e.pts/90000});if(e.firstKeyFrame){var r=e.firstKeyFrame;r.dts=bp(r.dts,n);r.pts=bp(r.pts,n);r.dtsTime=r.dts/90000;r.ptsTime=r.dts/90000}}},Ep=function(e){var t=!1,a=0,n=null,r=null,i=0,s=0,o;while(3<=e.length-s){var d=Tp.aac.parseType(e,s);switch(d){case"timed-metadata":if(10>e.length-s){t=!0;break}i=Tp.aac.parseId3TagSize(e,s);if(i>e.length){t=!0;break}if(null===r){o=e.subarray(s,s+i);r=Tp.aac.parseAacTimestamp(o)}s+=i;break;case"audio":if(7>e.length-s){t=!0;break}i=Tp.aac.parseAdtsSize(e,s);if(i>e.length){t=!0;break}if(null===n){o=e.subarray(s,s+i);n=Tp.aac.parseSampleRate(o)}a++;s+=i;break;default:s++;break;}if(t){return null}}if(null===n||null===r){return null}var l=90000/n,p={audio:[{type:"audio",dts:r,pts:r},{type:"audio",dts:r+1024*a*l,pts:r+1024*a*l}]};return p},Lp=function(e){var t={pid:null,table:null},a={};vp(e,t);for(var n in t.table){if(t.table.hasOwnProperty(n)){var r=t.table[n];switch(r){case al.H264_STREAM_TYPE:a.video=[];kp(e,t,a);if(0===a.video.length){delete a.video}break;case al.ADTS_STREAM_TYPE:a.audio=[];Sp(e,t,a);if(0===a.audio.length){delete a.audio}break;default:break;}}}return a};function ft(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var Ip=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}},Pp=function(){function e(e,t){for(var a=0,n;a<t.length;a++){n=t[a];n.enumerable=n.enumerable||!1;n.configurable=!0;if("value"in n)n.writable=!0;Object.defineProperty(e,n.key,n)}}return function(t,a,n){if(a)e(t.prototype,a);if(n)e(t,n);return t}}(),xp=function(e,t){if("function"!=typeof t&&null!==t){throw new TypeError("Super expression must either be null or a function, not "+_typeof(t))}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t},Dp=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&("object"===_typeof(t)||"function"==typeof t)?t:e},Ap=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],a=e[1],n=t[4],r=a[4],o=void 0,l=void 0,p=void 0,u=[],d=[],c=void 0,m=void 0,g=void 0,h=void 0,y=void 0,_=void 0;for(o=0;256>o;o++){d[(u[o]=o<<1^283*(o>>7))^o]=o}for(l=p=0;!n[l];l^=c||1,p=d[p]||1){h=p^p<<1^p<<2^p<<3^p<<4;h=99^(h>>8^255&h);n[l]=h;r[h]=l;g=u[m=u[c=u[l]]];_=16843009*g^65537*m^257*c^16843008*l;y=257*u[h]^16843008*h;for(o=0;4>o;o++){t[o][l]=y=y<<24^y>>>8;a[o][h]=_=_<<24^_>>>8}}for(o=0;5>o;o++){t[o]=t[o].slice(0);a[o]=a[o].slice(0)}return e},wp=null,Op=function(){function e(t){Ip(this,e);if(!wp){wp=Ap()}this._tables=[[wp[0][0].slice(),wp[0][1].slice(),wp[0][2].slice(),wp[0][3].slice(),wp[0][4].slice()],[wp[1][0].slice(),wp[1][1].slice(),wp[1][2].slice(),wp[1][3].slice(),wp[1][4].slice()]];var a=void 0,n=void 0,r=void 0,s=void 0,o=void 0,d=this._tables[0][4],l=this._tables[1],p=t.length,u=1;if(4!==p&&6!==p&&8!==p){throw new Error("Invalid aes key size")}s=t.slice(0);o=[];this._key=[s,o];for(a=p;a<4*p+28;a++){r=s[a-1];if(0==a%p||8===p&&4==a%p){r=d[r>>>24]<<24^d[255&r>>16]<<16^d[255&r>>8]<<8^d[255&r];if(0==a%p){r=r<<8^r>>>24^u<<24;u=u<<1^283*(u>>7)}}s[a]=s[a-p]^r}for(n=0;a;n++,a--){r=s[3&n?a:a-4];if(4>=a||4>n){o[n]=r}else{o[n]=l[0][d[r>>>24]]^l[1][d[255&r>>16]]^l[2][d[255&r>>8]]^l[3][d[255&r]]}}}e.prototype.decrypt=function(e,t,n,r,s,o){var l=this._key[1],p=e^l[0],u=r^l[1],m=n^l[2],g=t^l[3],h=void 0,y=void 0,_=void 0,f=l.length/4-2,T=void 0,v=4,S=this._tables[1],k=S[0],C=S[1],E=S[2],L=S[3],I=S[4];for(T=0;T<f;T++){h=k[p>>>24]^C[255&u>>16]^E[255&m>>8]^L[255&g]^l[v];y=k[u>>>24]^C[255&m>>16]^E[255&g>>8]^L[255&p]^l[v+1];_=k[m>>>24]^C[255&g>>16]^E[255&p>>8]^L[255&u]^l[v+2];g=k[g>>>24]^C[255&p>>16]^E[255&u>>8]^L[255&m]^l[v+3];v+=4;p=h;u=y;m=_}for(T=0;4>T;T++){s[(3&-T)+o]=I[p>>>24]<<24^I[255&u>>16]<<16^I[255&m>>8]<<8^I[255&g]^l[v++];h=p;p=u;u=m;m=g;g=h}};return e}(),Up=function(){function e(){Ip(this,e);this.listeners={}}e.prototype.on=function(e,t){if(!this.listeners[e]){this.listeners[e]=[]}this.listeners[e].push(t)};e.prototype.off=function(e,t){if(!this.listeners[e]){return!1}var a=this.listeners[e].indexOf(t);this.listeners[e].splice(a,1);return-1<a};e.prototype.trigger=function(e){var t=this.listeners[e];if(!t){return}if(2===arguments.length){for(var a=t.length,n=0;n<a;++n){t[n].call(this,arguments[1])}}else{for(var r=Array.prototype.slice.call(arguments,1),s=t.length,o=0;o<s;++o){t[o].apply(this,r)}}};e.prototype.dispose=function(){this.listeners={}};e.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})};return e}(),Rp=function(e){xp(t,e);function t(){Ip(this,t);var a=Dp(this,e.call(this,Up));a.jobs=[];a.delay=1;a.timeout_=null;return a}t.prototype.processJob_=function(){this.jobs.shift()();if(this.jobs.length){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}else{this.timeout_=null}};t.prototype.push=function(e){this.jobs.push(e);if(!this.timeout_){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}};return t}(Up),Mp=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},Bp=function(e,t,a){var n=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),r=new Op(Array.prototype.slice.call(t)),i=new Uint8Array(e.byteLength),s=new Int32Array(i.buffer),o=void 0,d=void 0,l=void 0,p=void 0,u=void 0,c=void 0,m=void 0,g=void 0,h=void 0;o=a[0];d=a[1];l=a[2];p=a[3];for(h=0;h<n.length;h+=4){u=Mp(n[h]);c=Mp(n[h+1]);m=Mp(n[h+2]);g=Mp(n[h+3]);r.decrypt(u,c,m,g,s,h);s[h]=Mp(s[h]^o);s[h+1]=Mp(s[h+1]^d);s[h+2]=Mp(s[h+2]^l);s[h+3]=Mp(s[h+3]^p);o=u;d=c;l=m;p=g}return i},Np=function(){function e(t,a,n,r){Ip(this,e);var s=e.STEP,o=new Int32Array(t.buffer),d=new Uint8Array(t.byteLength),l=0;this.asyncStream_=new Rp;this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+s),a,n,d));for(l=s;l<o.length;l+=s){n=new Uint32Array([Mp(o[l-4]),Mp(o[l-3]),Mp(o[l-2]),Mp(o[l-1])]);this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+s),a,n,d))}this.asyncStream_.push(function(){r(null,ft(d))})}e.prototype.decryptChunk_=function(e,t,a,n){return function(){var r=Bp(e,t,a);n.set(r,e.byteOffset)}};Pp(e,null,[{key:"STEP",get:function(){return 32e3}}]);return e}(),jp=function(t,a){if(/^[a-z]+:/i.test(a)){return a}if(!/\/\//i.test(t)){t=_s.buildAbsoluteURL(e.location.href,t)}return _s.buildAbsoluteURL(t,a)},Fp=function(e,t,a){if(e&&a.responseURL&&t!==a.responseURL){return a.responseURL}return t},Hp=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}},Vp=function(){function e(e,t){for(var a=0,n;a<t.length;a++){n=t[a];n.enumerable=n.enumerable||!1;n.configurable=!0;if("value"in n)n.writable=!0;Object.defineProperty(e,n.key,n)}}return function(t,a,n){if(a)e(t.prototype,a);if(n)e(t,n);return t}}(),qp=function e(t,a,n){if(null===t)t=Function.prototype;var r=Object.getOwnPropertyDescriptor(t,a);if(r===void 0){var i=Object.getPrototypeOf(t);if(null===i){}else{return e(i,a,n)}}else if("value"in r){return r.value}else{var s=r.get;if(s===void 0){return}return s.call(n)}},zp=function(e,t){if("function"!=typeof t&&null!==t){throw new TypeError("Super expression must either be null or a function, not "+_typeof(t))}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t},Gp=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&("object"===_typeof(t)||"function"==typeof t)?t:e},Wp=function(){function e(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var s=e[Symbol.iterator](),o;!(n=(o=s.next()).done);n=!0){a.push(o.value);if(t&&a.length===t)break}}catch(e){r=!0;i=e}finally{try{if(!n&&s["return"])s["return"]()}finally{if(r)throw i}}return a}return function(t,a){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,a)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}(),Kp=mt.mergeOptions,Yp=mt.EventTarget,Xp=mt.log,$p=function(e,t){["AUDIO","SUBTITLES"].forEach(function(a){for(var n in e.mediaGroups[a]){for(var r in e.mediaGroups[a][n]){var i=e.mediaGroups[a][n][r];t(i,a,n,r)}}})},Qp=function(e,t,a){var n=t.slice();a=a||0;for(var r=Math.min(e.length,t.length+a),s=a;s<r;s++){n[s-a]=Kp(e[s],n[s-a])}return n},Jp=function(e,t){if(!e.resolvedUri){e.resolvedUri=jp(t,e.uri)}if(e.key&&!e.key.resolvedUri){e.key.resolvedUri=jp(t,e.key.uri)}if(e.map&&!e.map.resolvedUri){e.map.resolvedUri=jp(t,e.map.uri)}},Zp=function(e,t){var a=Kp(e,{}),n=a.playlists[t.uri];if(!n){return null}if(n.segments&&t.segments&&n.segments.length===t.segments.length&&n.endList===t.endList&&n.mediaSequence===t.mediaSequence){return null}var r=Kp(n,t);if(n.segments){r.segments=Qp(n.segments,t.segments,t.mediaSequence-n.mediaSequence)}r.segments.forEach(function(e){Jp(e,r.resolvedUri)});for(var s=0;s<a.playlists.length;s++){if(a.playlists[s].uri===t.uri){a.playlists[s]=r}}a.playlists[t.uri]=r;return a},eu=function(e){var t=e.playlists.length;while(t--){var a=e.playlists[t];e.playlists[a.uri]=a;a.resolvedUri=jp(e.uri,a.uri);a.id=t;if(!a.attributes){a.attributes={};Xp.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}},tu=function(e){$p(e,function(t){if(t.uri){t.resolvedUri=jp(e.uri,t.uri)}})},au=function(e,t){var a=e.segments[e.segments.length-1],n=void 0;if(t&&a&&a.duration){n=1e3*a.duration}else{n=500*(e.targetDuration||10)}return n},nu=function(t){zp(a,t);function a(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};Hp(this,a);var r=Gp(this,(a.__proto__||Object.getPrototypeOf(a)).call(this)),i=n.withCredentials,s=i===void 0?!1:i,o=n.handleManifestRedirects,d=o===void 0?!1:o;r.srcUrl=e;r.hls_=t;r.withCredentials=s;r.handleManifestRedirects=d;var l=t.options_;r.customTagParsers=l&&l.customTagParsers||[];r.customTagMappers=l&&l.customTagMappers||[];if(!r.srcUrl){throw new Error("A non-empty playlist URL is required")}r.state="HAVE_NOTHING";r.on("mediaupdatetimeout",function(){if("HAVE_METADATA"!==r.state){return}r.state="HAVE_CURRENT_METADATA";r.request=r.hls_.xhr({uri:jp(r.master.uri,r.media().uri),withCredentials:r.withCredentials},function(e){if(!r.request){return}if(e){return r.playlistRequestError(r.request,r.media().uri,"HAVE_METADATA")}r.haveMetadata(r.request,r.media().uri)})});return r}Vp(a,[{key:"playlistRequestError",value:function(e,t,a){this.request=null;if(a){this.state=a}this.error={playlist:this.master.playlists[t],status:e.status,message:"HLS playlist request error at URL: "+t,responseText:e.responseText,code:500<=e.status?4:2};this.trigger("error")}},{key:"haveMetadata",value:function(t,a){var n=this;this.request=null;this.state="HAVE_METADATA";var r=new ks;this.customTagParsers.forEach(function(e){return r.addParser(e)});this.customTagMappers.forEach(function(e){return r.addTagMapper(e)});r.push(t.responseText);r.end();r.manifest.uri=a;r.manifest.attributes=r.manifest.attributes||{};var i=Zp(this.master,r.manifest);this.targetDuration=r.manifest.targetDuration;if(i){this.master=i;this.media_=this.master.playlists[r.manifest.uri]}else{this.trigger("playlistunchanged")}if(!this.media().endList){e.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=e.setTimeout(function(){n.trigger("mediaupdatetimeout")},au(this.media(),!!i))}this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest();e.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null;e.onreadystatechange=null;e.abort()}}},{key:"media",value:function(e){var t=this;if(!e){return this.media_}if("HAVE_NOTHING"===this.state){throw new Error("Cannot switch media playlist from "+this.state)}var a=this.state;if("string"==typeof e){if(!this.master.playlists[e]){throw new Error("Unknown playlist URI: "+e)}e=this.master.playlists[e]}var n=!this.media_||e.uri!==this.media_.uri;if(this.master.playlists[e.uri].endList){if(this.request){this.request.onreadystatechange=null;this.request.abort();this.request=null}this.state="HAVE_METADATA";this.media_=e;if(n){this.trigger("mediachanging");this.trigger("mediachange")}return}if(!n){return}this.state="SWITCHING_MEDIA";if(this.request){if(e.resolvedUri===this.request.url){return}this.request.onreadystatechange=null;this.request.abort();this.request=null}if(this.media_){this.trigger("mediachanging")}this.request=this.hls_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},function(n,r){if(!t.request){return}e.resolvedUri=Fp(t.handleManifestRedirects,e.resolvedUri,r);if(n){return t.playlistRequestError(t.request,e.uri,a)}t.haveMetadata(r,e.uri);if("HAVE_MASTER"===a){t.trigger("loadedmetadata")}else{t.trigger("mediachange")}})}},{key:"pause",value:function(){this.stopRequest();e.clearTimeout(this.mediaUpdateTimeout);if("HAVE_NOTHING"===this.state){this.started=!1}if("SWITCHING_MEDIA"===this.state){if(this.media_){this.state="HAVE_METADATA"}else{this.state="HAVE_MASTER"}}else if("HAVE_CURRENT_METADATA"===this.state){this.state="HAVE_METADATA"}}},{key:"load",value:function(t){var a=this;e.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(t){var r=n?1e3*(n.targetDuration/2):5000;this.mediaUpdateTimeout=e.setTimeout(function(){return a.load()},r);return}if(!this.started){this.start();return}if(n&&!n.endList){this.trigger("mediaupdatetimeout")}else{this.trigger("loadedplaylist")}}},{key:"start",value:function(){var t=this;this.started=!0;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(a,n){if(!t.request){return}t.request=null;if(a){t.error={status:n.status,message:"HLS playlist request error at URL: "+t.srcUrl,responseText:n.responseText,code:2};if("HAVE_NOTHING"===t.state){t.started=!1}return t.trigger("error")}var r=new ks;t.customTagParsers.forEach(function(e){return r.addParser(e)});t.customTagMappers.forEach(function(e){return r.addTagMapper(e)});r.push(n.responseText);r.end();t.state="HAVE_MASTER";t.srcUrl=Fp(t.handleManifestRedirects,t.srcUrl,n);r.manifest.uri=t.srcUrl;if(r.manifest.playlists){t.master=r.manifest;eu(t.master);tu(t.master);t.trigger("loadedplaylist");if(!t.request){t.media(r.manifest.playlists[0])}return}t.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:e.location.href,playlists:[{uri:t.srcUrl,id:0,resolvedUri:t.srcUrl,attributes:{}}]};t.master.playlists[t.srcUrl]=t.master.playlists[0];t.haveMetadata(n,t.srcUrl);return t.trigger("loadedmetadata")})}}]);return a}(Yp),ru=mt.createTimeRange,iu=function(e,t){var a=0,n=t-e.mediaSequence,r=e.segments[n];if(r){if("undefined"!=typeof r.start){return{result:r.start,precise:!0}}if("undefined"!=typeof r.end){return{result:r.end-r.duration,precise:!0}}}while(n--){r=e.segments[n];if("undefined"!=typeof r.end){return{result:a+r.end,precise:!0}}a+=r.duration;if("undefined"!=typeof r.start){return{result:a+r.start,precise:!0}}}return{result:a,precise:!1}},su=function(e,t){var a=0,n=void 0,r=t-e.mediaSequence;for(;r<e.segments.length;r++){n=e.segments[r];if("undefined"!=typeof n.start){return{result:n.start-a,precise:!0}}a+=n.duration;if("undefined"!=typeof n.end){return{result:n.end-a,precise:!0}}}return{result:-1,precise:!1}},ou=function(e,t,a){var n=void 0,r=void 0;if("undefined"==typeof t){t=e.mediaSequence+e.segments.length}if(t<e.mediaSequence){return 0}n=iu(e,t);if(n.precise){return n.result}r=su(e,t);if(r.precise){return r.result}return n.result+a},du=function(t,a,n){if(!t){return 0}if("number"!=typeof n){n=0}if("undefined"==typeof a){if(t.totalDuration){return t.totalDuration}if(!t.endList){return e.Infinity}}return ou(t,a,n)},lu=function(e,t,a){var n=0;if(t>a){var r=[a,t];t=r[0];a=r[1]}if(0>t){for(var s=t;s<Math.min(0,a);s++){n+=e.targetDuration}t=0}for(var o=t;o<a;o++){n+=e.segments[o].duration}return n},pu=function(e){if(!e.segments.length){return 0}var t=e.segments.length-1,a=e.segments[t].duration||e.targetDuration,n=a+2*e.targetDuration;while(t--){a+=e.segments[t].duration;if(a>=n){break}}return Math.max(0,t)},uu=function(e,t,a){if(!e||!e.segments){return null}if(e.endList){return du(e)}if(null===t){return null}t=t||0;var n=a?pu(e):e.segments.length;return ou(e,e.mediaSequence+n,t)},cu=function(e){return 0==e-Math.floor(e)},mu=function(e,t){if(cu(t)){return t+.1*e}for(var a=t.toString().split(".")[1].length,n=1;n<=a;n++){var r=Math.pow(10,n),s=t*r;if(cu(s)||n===a){return(s+e)/r}}},gu=mu.bind(null,1),hu=mu.bind(null,-1),yu=function(e,t,a,n){var r=void 0,s=void 0,o=e.segments.length,d=t-n;if(0>d){if(0<a){for(r=a-1;0<=r;r--){s=e.segments[r];d+=hu(s.duration);if(0<d){return{mediaIndex:r,startTime:n-lu(e,a,r)}}}}return{mediaIndex:0,startTime:t}}if(0>a){for(r=a;0>r;r++){d-=e.targetDuration;if(0>d){return{mediaIndex:0,startTime:t}}}a=0}for(r=a;r<o;r++){s=e.segments[r];d-=gu(s.duration);if(0>d){return{mediaIndex:r,startTime:n+lu(e,a,r)}}}return{mediaIndex:o-1,startTime:t}},_u=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},fu=function(e){return e.excludeUntil&&e.excludeUntil===1/0},bu=function(e){var t=_u(e);return!e.disabled&&!t},Tu=function(e){for(var t=0;t<e.segments.length;t++){if(e.segments[t].key){return!0}}return!1},vu=function(e){for(var t=0;t<e.segments.length;t++){if(e.segments[t].map){return!0}}return!1},Su=function(e,t){return t.attributes&&t.attributes[e]},ku=function(e,t){if(1===e.playlists.length){return!0}var a=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){if(!bu(e)){return!1}return(e.attributes.BANDWIDTH||0)<a}).length},Cu={duration:du,seekable:function(e,t){var a=uu(e,t,!0);if(null===a){return ru()}return ru(t||0,a)},safeLiveIndex:pu,getMediaInfoForTime:yu,isEnabled:bu,isDisabled:function(e){return e.disabled},isBlacklisted:_u,isIncompatible:fu,playlistEnd:uu,isAes:Tu,isFmp4:vu,hasAttribute:Su,estimateSegmentRequestTime:function(e,t,a){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:0;if(!Su("BANDWIDTH",a)){return NaN}var r=e*a.attributes.BANDWIDTH;return(r-8*n)/t},isLowestEnabledRendition:ku},Eu=mt.xhr,Lu=mt.mergeOptions,Iu=function(){return function e(t,a){t=Lu({timeout:45e3},t);var n=e.beforeRequest||mt.Hls.xhr.beforeRequest;if(n&&"function"==typeof n){var r=n(t);if(r){t=r}}var i=Eu(t,function(e,t){var n=i.response;if(!e&&n){i.responseTime=Date.now();i.roundTripTime=i.responseTime-i.requestTime;i.bytesReceived=n.byteLength||n.length;if(!i.bandwidth){i.bandwidth=Math.floor(1e3*(8*(i.bytesReceived/i.roundTripTime)))}}if(t.headers){i.responseHeaders=t.headers}if(e&&"ETIMEDOUT"===e.code){i.timedout=!0}if(!e&&!i.aborted&&200!==t.statusCode&&206!==t.statusCode&&0!==t.statusCode){e=new Error("XHR Failed with a response of: "+(i&&(n||i.responseText)))}a(e,i)}),s=i.abort;i.abort=function(){i.aborted=!0;return s.apply(i,arguments)};i.uri=t.uri;i.requestTime=Date.now();return i}},Pu=function(e,t){return e.start(t)+"-"+e.end(t)},xu=function(t,e){var a=t.toString(16);return"00".substring(0,2-a.length)+a+(e%2?" ":"")},Du=function(t){if(32<=t&&126>t){return String.fromCharCode(t)}return"."},Au=function(e){var t={};Object.keys(e).forEach(function(a){var n=e[a];if(ArrayBuffer.isView(n)){t[a]={bytes:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength}}else{t[a]=n}});return t},wu=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},Ou=function(e){for(var t=Array.prototype.slice.call(e),a=16,n="",r=void 0,i=void 0,s=0;s<t.length/a;s++){r=t.slice(s*a,s*a+a).map(xu).join("");i=t.slice(s*a,s*a+a).map(Du).join("");n+=r+" "+i+"\n"}return n},Uu=function(e){var t="",a=void 0;for(a=0;a<e.length;a++){t+=Pu(e,a)+" "}return t},Ru=Object.freeze({createTransferableMessage:Au,initSegmentId:wu,hexDump:Ou,tagDump:function(e){var t=e.bytes;return Ou(t)},textRanges:Uu}),Mu=.25,Bu=function(e,t){if(!t.dateTimeObject){return null}var a=t.videoTimingInfo.transmuxerPrependedSeconds,n=t.videoTimingInfo.transmuxedPresentationStart;return new Date(t.dateTimeObject.getTime()+1e3*(e-(n+a)))},Nu=function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds},ju=function(e,t){var a;try{a=new Date(e)}catch(t){return null}if(!t||!t.segments||0===t.segments.length){return null}var n=t.segments[0];if(a<n.dateTimeObject){return null}for(var r=0;r<t.segments.length-1;r++){n=t.segments[r];var s=t.segments[r+1].dateTimeObject;if(a<s){break}}var o=t.segments[t.segments.length-1],d=o.dateTimeObject,l=o.videoTimingInfo?Nu(o.videoTimingInfo):o.duration+o.duration*Mu,p=new Date(d.getTime()+1e3*l);if(a>p){return null}if(a>d){n=o}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:Cu.duration(t,t.mediaSequence+t.segments.indexOf(n)),type:n.videoTimingInfo?"accurate":"estimate"}},Fu=function(e,t){if(!t||!t.segments||0===t.segments.length){return null}for(var a=0,n=void 0,r=0;r<t.segments.length;r++){n=t.segments[r];a=n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:a+n.duration;if(e<=a){break}}var s=t.segments[t.segments.length-1];if(s.videoTimingInfo&&s.videoTimingInfo.transmuxedPresentationEnd<e){return null}if(e>a){if(e>a+s.duration*Mu){return null}n=s}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:a-n.duration,type:n.videoTimingInfo?"accurate":"estimate"}},Hu=function(e,t){var a=void 0,n=void 0;try{a=new Date(e);n=new Date(t)}catch(t){}var r=a.getTime(),i=n.getTime();return(i-r)/1e3},Vu=function(e){if(!e.segments||0===e.segments.length){return!1}for(var t=0,a;t<e.segments.length;t++){a=e.segments[t];if(!a.dateTimeObject){return!1}}return!0},qu=function(e){var t=e.playlist,a=e.time,n=a===void 0?void 0:a,r=e.callback;if(!r){throw new Error("getProgramTime: callback must be provided")}if(!t||n===void 0){return r({message:"getProgramTime: playlist and time must be provided"})}var i=Fu(n,t);if(!i){return r({message:"valid programTime was not found"})}if("estimate"===i.type){return r({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:i.estimatedStart})}var s={mediaSeconds:n},o=Bu(n,i.segment);if(o){s.programDateTime=o.toISOString()}return r(null,s)},zu=function e(t){var a=t.programTime,n=t.playlist,r=t.retryCount,i=r===void 0?2:r,s=t.seekTo,o=t.pauseAfterSeek,d=o===void 0?!0:o,l=t.tech,p=t.callback;if(!p){throw new Error("seekToProgramTime: callback must be provided")}if("undefined"==typeof a||!n||!s){return p({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"})}if(!n.endList&&!l.hasStarted_){return p({message:"player must be playing a live stream to start buffering"})}if(!Vu(n)){return p({message:"programDateTime tags must be provided in the manifest "+n.resolvedUri})}var u=ju(a,n);if(!u){return p({message:a+" was not found in the stream"})}var c=u.segment,m=Hu(c.dateTimeObject,a);if("estimate"===u.type){if(0===i){return p({message:a+" is not buffered yet. Try again"})}s(u.estimatedStart+m);l.one("seeked",function(){e({programTime:a,playlist:n,retryCount:i-1,seekTo:s,pauseAfterSeek:d,tech:l,callback:p})});return}var g=c.start+m;l.one("seeked",function(){return p(null,l.currentTime())});if(d){l.pause()}s(g)},Gu=1/30,Wu=3*Gu,Ku=function(e,t){var a=[],n=void 0;if(e&&e.length){for(n=0;n<e.length;n++){if(t(e.start(n),e.end(n))){a.push([e.start(n),e.end(n)])}}}return mt.createTimeRanges(a)},Yu=function(e,t){return Ku(e,function(e,a){return e-Gu<=t&&a+Gu>=t})},Xu=function(e,t){return Ku(e,function(e){return e-Gu>=t})},$u=function(e){if(2>e.length){return mt.createTimeRanges()}for(var t=[],a=1;a<e.length;a++){var n=e.end(a-1),r=e.start(a);t.push([n,r])}return mt.createTimeRanges(t)},Qu=function(e){var t=[];if(!e||!e.length){return""}for(var a=0;a<e.length;a++){t.push(e.start(a)+" => "+e.end(a))}return t.join(", ")},Ju=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,n=e.length?e.end(e.length-1):0;return(n-t)/a},Zu=function(e){for(var t=[],a=0;a<e.length;a++){t.push({start:e.start(a),end:e.end(a)})}return t},ec=function(e,t,a){var n=t.player_;if(a.captions&&a.captions.length){if(!e.inbandTextTracks_){e.inbandTextTracks_={}}for(var r in a.captionStreams){if(!e.inbandTextTracks_[r]){n.tech_.trigger({type:"usage",name:"hls-608"});var i=n.textTracks().getTrackById(r);if(i){e.inbandTextTracks_[r]=i}else{e.inbandTextTracks_[r]=n.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track}}}}if(a.metadata&&a.metadata.length&&!e.metadataTrack_){e.metadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track;e.metadataTrack_.inBandMetadataTrackDispatchType=a.metadata.dispatchType}},tc=function(e,t,a){var n=void 0,r=void 0;if(!a){return}if(!a.cues){return}n=a.cues.length;while(n--){r=a.cues[n];if(r.startTime<=t&&r.endTime>=e){a.removeCue(r)}}},ac=function(e){Object.defineProperties(e.frame,{id:{get:function(){mt.log.warn("cue.frame.id is deprecated. Use cue.value.key instead.");return e.value.key}},value:{get:function(){mt.log.warn("cue.frame.value is deprecated. Use cue.value.data instead.");return e.value.data}},privateData:{get:function(){mt.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead.");return e.value.data}}})},nc=function(e){var t;if(isNaN(e)||Math.abs(e)===1/0){t=Number.MAX_VALUE}else{t=e}return t},rc=function(t,a,n){var r=e.WebKitDataCue||e.VTTCue;if(a){a.forEach(function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new r(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},t)}if(n){var s=nc(t.mediaSource_.duration);n.forEach(function(t){var a=t.cueTime+this.timestampOffset;if("number"!=typeof a||e.isNaN(a)||0>a||!(a<1/0)){return}t.frames.forEach(function(e){var t=new r(a,a,e.value||e.url||e.data||"");t.frame=e;t.value=e;ac(t);this.metadataTrack_.addCue(t)},this)},t);if(t.metadataTrack_&&t.metadataTrack_.cues&&t.metadataTrack_.cues.length){for(var o=t.metadataTrack_.cues,d=[],l=0;l<o.length;l++){if(o[l]){d.push(o[l])}}var p=d.reduce(function(e,t){var a=e[t.startTime]||[];a.push(t);e[t.startTime]=a;return e},{}),u=Object.keys(p).sort(function(e,t){return+e-+t});u.forEach(function(e,t){var a=p[e],n=+u[t+1]||s;a.forEach(function(e){e.endTime=n})})}}},ic="undefined"!=typeof window?window:{},sc="undefined"==typeof Symbol?"__target":Symbol(),oc=ic.BlobBuilder||ic.WebKitBlobBuilder||ic.MozBlobBuilder||ic.MSBlobBuilder,dc=ic.URL||ic.webkitURL||dc&&dc.msURL,lc=ic.Worker;function bt(e,t){return function(a){var n=this;if(!t){return new lc(e)}else if(lc&&!a){var r=t.toString().replace(/^function.+?{/,"").slice(0,-1),i=Tt(r);this[sc]=new lc(i);vt(this[sc],i);return this[sc]}else{var s={postMessage:function(e){if(n.onmessage){setTimeout(function(){n.onmessage({data:e,target:s})})}}};t.call(s);this.postMessage=function(e){setTimeout(function(){s.onmessage({data:e,target:n})})};this.isThisThread=!0}}}if(lc){var pc,uc=Tt("self.onmessage = function () {}"),cc=new Uint8Array(1);try{pc=new lc(uc);pc.postMessage(cc,[cc.buffer])}catch(t){lc=null}finally{dc.revokeObjectURL(uc);if(pc){pc.terminate()}}}function Tt(t){try{return dc.createObjectURL(new Blob([t],{type:"application/javascript"}))}catch(n){var a=new oc;a.append(t);return dc.createObjectURL(a.getBlob(type))}}function vt(e,t){if(!e||!t)return;var a=e.terminate;e.objURL=t;e.terminate=function(){if(e.objURL)dc.revokeObjectURL(e.objURL);a.call(e)}}var mc=new bt("./transmuxer-worker.worker.js",function(){var e=this,t=function(){var t=Math.pow(2,32)-1,a,n,r,i,s,o,d,l,p,u,c,m,g,h,y,_,f,b,T,v,S,k,C,E,L,I,P,x,D,A,w,O,U,R,M,B;(function(){C={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if("undefined"==typeof Uint8Array){return}for(var e in C){if(C.hasOwnProperty(e)){C[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]}}E=new Uint8Array([105,115,111,109]);I=new Uint8Array([97,118,99,49]);L=new Uint8Array([0,0,0,1]);P=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);x=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);D={video:P,audio:x};O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);w=new Uint8Array([0,0,0,0,0,0,0,0]);U=new Uint8Array([0,0,0,0,0,0,0,0]);R=U;M=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);B=U;A=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();a=function(e){var t=[],a=0,n,r,s;for(n=1;n<arguments.length;n++){t.push(arguments[n])}n=t.length;while(n--){a+=t[n].byteLength}r=new Uint8Array(a+8);s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setUint32(0,r.byteLength);r.set(e,4);for(n=0,a=8;n<t.length;n++){r.set(t[n],a);a+=t[n].byteLength}return r};n=function(){return a(C.dinf,a(C.dref,O))};r=function(e){return a(C.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))};i=function(){return a(C.ftyp,E,L,E,I)};_=function(e){return a(C.hdlr,D[e])};s=function(e){return a(C.mdat,e)};y=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,255&e.duration>>>24,255&e.duration>>>16,255&e.duration>>>8,255&e.duration,85,196,0,0]);if(e.samplerate){t[12]=255&e.samplerate>>>24;t[13]=255&e.samplerate>>>16;t[14]=255&e.samplerate>>>8;t[15]=255&e.samplerate}return a(C.mdhd,t)};h=function(e){return a(C.mdia,y(e),_(e.type),d(e))};o=function(e){return a(C.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))};d=function(e){return a(C.minf,"video"===e.type?a(C.vmhd,A):a(C.smhd,w),n(),b(e))};l=function(e,t){var n=[],r=t.length;while(r--){n[r]=v(t[r])}return a.apply(null,[C.moof,o(e)].concat(n))};p=function(e){var t=e.length,n=[];while(t--){n[t]=m(e[t])}return a.apply(null,[C.moov,c(4294967295)].concat(n).concat(u(e)))};u=function(e){var t=e.length,n=[];while(t--){n[t]=S(e[t])}return a.apply(null,[C.mvex].concat(n))};c=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return a(C.mvhd,t)};f=function(e){var t=e.samples||[],n=new Uint8Array(4+t.length),r,s;for(s=0;s<t.length;s++){r=t[s].flags;n[s+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy}return a(C.sdtp,n)};b=function(e){return a(C.stbl,T(e),a(C.stts,B),a(C.stsc,R),a(C.stsz,M),a(C.stco,U))};(function(){var e,t;T=function(n){return a(C.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===n.type?e(n):t(n))};e=function(e){var t=e.sps||[],n=e.pps||[],r=[],s=[],o;for(o=0;o<t.length;o++){r.push((65280&t[o].byteLength)>>>8);r.push(255&t[o].byteLength);r=r.concat(Array.prototype.slice.call(t[o]))}for(o=0;o<n.length;o++){s.push((65280&n[o].byteLength)>>>8);s.push(255&n[o].byteLength);s=s.concat(Array.prototype.slice.call(n[o]))}return a(C.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a(C.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([t.length]).concat(r).concat([n.length]).concat(s))),a(C.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))};t=function(e){return a(C.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),r(e))}})();g=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return a(C.tkhd,t)};v=function(e){var t,n,r,i,s,o,d;t=a(C.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));o=Math.floor(e.baseMediaDecodeTime/4294967296);d=Math.floor(e.baseMediaDecodeTime%4294967296);n=a(C.tfdt,new Uint8Array([1,0,0,0,255&o>>>24,255&o>>>16,255&o>>>8,255&o,255&d>>>24,255&d>>>16,255&d>>>8,255&d]));s=92;if("audio"===e.type){r=k(e,s);return a(C.traf,t,n,r)}i=f(e);r=k(e,i.length+s);return a(C.traf,t,n,r,i)};m=function(e){e.duration=e.duration||4294967295;return a(C.trak,g(e),h(e))};S=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if("video"!==e.type){t[t.length-1]=0}return a(C.trex,t)};(function(){var e,t,n;n=function(e,t){var a=0,n=0,r=0,i=0;if(e.length){if(e[0].duration!==void 0){a=1}if(e[0].size!==void 0){n=2}if(e[0].flags!==void 0){r=4}if(e[0].compositionTimeOffset!==void 0){i=8}}return[0,0,a|n|r|i,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]};t=function(e,t){var r,s,o,d;s=e.samples||[];t+=20+16*s.length;r=n(s,t);for(d=0;d<s.length;d++){o=s[d];r=r.concat([(4278190080&o.duration)>>>24,(16711680&o.duration)>>>16,(65280&o.duration)>>>8,255&o.duration,(4278190080&o.size)>>>24,(16711680&o.size)>>>16,(65280&o.size)>>>8,255&o.size,o.flags.isLeading<<2|o.flags.dependsOn,o.flags.isDependedOn<<6|o.flags.hasRedundancy<<4|o.flags.paddingValue<<1|o.flags.isNonSyncSample,o.flags.degradationPriority&61440,15&o.flags.degradationPriority,(4278190080&o.compositionTimeOffset)>>>24,(16711680&o.compositionTimeOffset)>>>16,(65280&o.compositionTimeOffset)>>>8,255&o.compositionTimeOffset])}return a(C.trun,new Uint8Array(r))};e=function(e,t){var r,s,o,d;s=e.samples||[];t+=20+8*s.length;r=n(s,t);for(d=0;d<s.length;d++){o=s[d];r=r.concat([(4278190080&o.duration)>>>24,(16711680&o.duration)>>>16,(65280&o.duration)>>>8,255&o.duration,(4278190080&o.size)>>>24,(16711680&o.size)>>>16,(65280&o.size)>>>8,255&o.size])}return a(C.trun,new Uint8Array(r))};k=function(a,n){if("audio"===a.type){return e(a,n)}return t(a,n)}})();var N={ftyp:i,mdat:s,moof:l,moov:p,initSegment:function(e){var t=i(),a=p(e),n;n=new Uint8Array(t.byteLength+a.byteLength);n.set(t);n.set(a,t.byteLength);return n}},j={toUnsigned:function(e){return e>>>0}}.toUnsigned,F,H,V,q,z;F=function(e,t){var a=[],n,r,s,o,d;if(!t.length){return null}for(n=0;n<e.byteLength;){r=j(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]);s=H(e.subarray(n+4,n+8));o=1<r?n+r:e.byteLength;if(s===t[0]){if(1===t.length){a.push(e.subarray(n+8,o))}else{d=F(e.subarray(n+8,o),t.slice(1));if(d.length){a=a.concat(d)}}}n=o}return a};H=function(e){var t="";t+=String.fromCharCode(e[0]);t+=String.fromCharCode(e[1]);t+=String.fromCharCode(e[2]);t+=String.fromCharCode(e[3]);return t};V=function(e){var t=F(e,["moov","trak"]);return t.reduce(function(e,t){var a,n,r,i,s;a=F(t,["tkhd"])[0];if(!a){return null}n=a[0];r=0===n?12:20;i=j(a[r]<<24|a[r+1]<<16|a[r+2]<<8|a[r+3]);s=F(t,["mdia","mdhd"])[0];if(!s){return null}n=s[0];r=0===n?12:20;e[i]=j(s[r]<<24|s[r+1]<<16|s[r+2]<<8|s[r+3]);return e},{})};q=function(e,t){var a,n,r;a=F(t,["moof","traf"]);n=[].concat.apply([],a.map(function(t){return F(t,["tfhd"]).map(function(a){var n,r,i;n=j(a[4]<<24|a[5]<<16|a[6]<<8|a[7]);r=e[n]||9e4;i=F(t,["tfdt"]).map(function(e){var t,a;t=e[0];a=j(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);if(1===t){a*=Math.pow(2,32);a+=j(e[8]<<24|e[9]<<16|e[10]<<8|e[11])}return a})[0];i=i||1/0;return i/r})}));r=Math.min.apply(null,n);return isFinite(r)?r:0};z=function(e){var t=F(e,["moov","trak"]),a=[];t.forEach(function(e){var t=F(e,["mdia","hdlr"]),n=F(e,["tkhd"]);t.forEach(function(e,t){var r=H(e.subarray(8,12)),i=n[t],s,o;if("vide"===r){s=new DataView(i.buffer,i.byteOffset,i.byteLength);s.getUint8(0);o=s.getUint32(20);a.push(o)}})});return a};var G={findBox:F,parseType:H,timescale:V,startTime:q,videoTrackIds:z},W=function(){this.init=function(){var e={};this.on=function(t,a){if(!e[t]){e[t]=[]}e[t]=e[t].concat(a)};this.off=function(t,a){var n;if(!e[t]){return!1}n=e[t].indexOf(a);e[t]=e[t].slice();e[t].splice(n,1);return-1<n};this.trigger=function(t){var a,n,r,s;a=e[t];if(!a){return}if(2===arguments.length){r=a.length;for(n=0;n<r;++n){a[n].call(this,arguments[1])}}else{s=[];n=arguments.length;for(n=1;n<arguments.length;++n){s.push(arguments[n])}r=a.length;for(n=0;n<r;++n){a[n].apply(this,s)}}};this.dispose=function(){e={}}}};W.prototype.pipe=function(e){this.on("data",function(t){e.push(t)});this.on("done",function(t){e.flush(t)});return e};W.prototype.push=function(e){this.trigger("data",e)};W.prototype.flush=function(e){this.trigger("done",e)};var K=W,Y=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},X=function(e,t){var a=Y();a.dataOffset=t;a.compositionTimeOffset=e.pts-e.dts;a.duration=e.duration;a.size=4*e.length;a.size+=e.byteLength;if(e.keyFrame){a.flags.dependsOn=2;a.flags.isNonSyncSample=0}return a},$={groupNalsIntoFrames:function(e){var t,a,n=[],r=[];n.byteLength=0;for(t=0;t<e.length;t++){a=e[t];if("access_unit_delimiter_rbsp"===a.nalUnitType){if(n.length){n.duration=a.dts-n.dts;r.push(n)}n=[a];n.byteLength=a.data.byteLength;n.pts=a.pts;n.dts=a.dts}else{if("slice_layer_without_partitioning_rbsp_idr"===a.nalUnitType){n.keyFrame=!0}n.duration=a.dts-n.dts;n.byteLength+=a.data.byteLength;n.push(a)}}if(r.length&&(!n.duration||0>=n.duration)){n.duration=r[r.length-1].duration}r.push(n);return r},groupFramesIntoGops:function(e){var t,a,n=[],r=[];n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=e[0].pts;n.dts=e[0].dts;r.byteLength=0;r.nalCount=0;r.duration=0;r.pts=e[0].pts;r.dts=e[0].dts;for(t=0;t<e.length;t++){a=e[t];if(a.keyFrame){if(n.length){r.push(n);r.byteLength+=n.byteLength;r.nalCount+=n.nalCount;r.duration+=n.duration}n=[a];n.nalCount=a.length;n.byteLength=a.byteLength;n.pts=a.pts;n.dts=a.dts;n.duration=a.duration}else{n.duration+=a.duration;n.nalCount+=a.length;n.byteLength+=a.byteLength;n.push(a)}}if(r.length&&0>=n.duration){n.duration=r[r.length-1].duration}r.byteLength+=n.byteLength;r.nalCount+=n.nalCount;r.duration+=n.duration;r.push(n);return r},extendFirstKeyFrame:function(e){var t;if(!e[0][0].keyFrame&&1<e.length){t=e.shift();e.byteLength-=t.byteLength;e.nalCount-=t.nalCount;e[0][0].dts=t.dts;e[0][0].pts=t.pts;e[0][0].duration+=t.duration}return e},generateSampleTable:function(e,t){var a,n,r,s,o,d=t||0,l=[];for(a=0;a<e.length;a++){s=e[a];for(n=0;n<s.length;n++){o=s[n];r=X(o,d);d+=r.size;l.push(r)}}return l},concatenateNalData:function(e){var t,a,n,r,s,o,d=0,l=e.byteLength,p=e.nalCount,u=new Uint8Array(l+4*p),c=new DataView(u.buffer);for(t=0;t<e.length;t++){r=e[t];for(a=0;a<r.length;a++){s=r[a];for(n=0;n<s.length;n++){o=s[n];c.setUint32(d,o.data.byteLength);d+=4;u.set(o.data,d);d+=o.data.byteLength}}}return u}},Q=[33,16,5,32,164,27],J=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Z=function(e){var t=[];while(e--){t.push(0)}return t},ee={96e3:[Q,[227,64],Z(154),[56]],88200:[Q,[231],Z(170),[56]],64e3:[Q,[248,192],Z(240),[56]],48e3:[Q,[255,192],Z(268),[55,148,128],Z(54),[112]],44100:[Q,[255,192],Z(268),[55,163,128],Z(84),[112]],32e3:[Q,[255,192],Z(268),[55,234],Z(226),[112]],24e3:[Q,[255,192],Z(268),[55,255,128],Z(268),[111,112],Z(126),[224]],16e3:[Q,[255,192],Z(268),[55,255,128],Z(268),[111,255],Z(269),[223,108],Z(195),[1,192]],12e3:[J,Z(268),[3,127,248],Z(268),[6,255,240],Z(268),[13,255,224],Z(268),[27,253,128],Z(259),[56]],11025:[J,Z(268),[3,127,248],Z(268),[6,255,240],Z(268),[13,255,224],Z(268),[27,255,192],Z(268),[55,175,128],Z(108),[112]],8e3:[J,Z(268),[3,121,16],Z(47),[7]]},te=function(e){return Object.keys(e).reduce(function(t,a){t[a]=new Uint8Array(e[a].reduce(function(e,t){return e.concat(t)},[]));return t},{})}(ee),ae=9e4,ne,re,ie,se,oe,de;ne=function(e){return e*ae};re=function(e,t){return e*t};ie=function(e){return e/ae};se=function(e,t){return e/t};oe=function(e,t){return ne(se(e,t))};de=function(e,t){return re(ie(e),t)};var le={secondsToVideoTs:ne,secondsToAudioTs:re,videoTsToSeconds:ie,audioTsToSeconds:se,audioTsToVideoTs:oe,videoTsToAudioTs:de},pe=9e4,ue=function(e){var t,a,n=0;for(t=0;t<e.length;t++){a=e[t];n+=a.data.byteLength}return n},ce={prefixWithSilence:function(e,t,a,n){var r,s=0,o=0,d=0,l=0,p,u;if(!t.length){return}r=le.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate);s=Math.ceil(pe/(e.samplerate/1024));if(a&&n){o=r-Math.max(a,n);d=Math.floor(o/s);l=d*s}if(1>d||l>pe/2){return}p=te[e.samplerate];if(!p){p=t[0].data}for(u=0;u<d;u++){t.splice(u,0,{data:p})}e.baseMediaDecodeTime-=Math.floor(le.videoTsToAudioTs(l,e.samplerate))},trimAdtsFramesByEarliestDts:function(e,t,a){if(t.minSegmentDts>=a){return e}t.minSegmentDts=1/0;return e.filter(function(e){if(e.dts>=a){t.minSegmentDts=Math.min(t.minSegmentDts,e.dts);t.minSegmentPts=t.minSegmentDts;return!0}return!1})},generateSampleTable:function(e){var t,a,n=[];for(t=0;t<e.length;t++){a=e[t];n.push({size:a.data.byteLength,duration:1024})}return n},concatenateFrameData:function(e){var t,a,n=0,r=new Uint8Array(ue(e));for(t=0;t<e.length;t++){a=e[t];r.set(a.data,n);n+=a.data.byteLength}return r}},me={clearDtsInfo:function(e){delete e.minSegmentDts;delete e.maxSegmentDts;delete e.minSegmentPts;delete e.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(e,t){var a,n,r=e.minSegmentDts;if(!t){r-=e.timelineStartInfo.dts}a=e.timelineStartInfo.baseMediaDecodeTime;a+=r;a=Math.max(0,a);if("audio"===e.type){n=e.samplerate/9e4;a*=n;a=Math.floor(a)}return a},collectDtsInfo:function(e,t){if("number"==typeof t.pts){if(e.timelineStartInfo.pts===void 0){e.timelineStartInfo.pts=t.pts}if(e.minSegmentPts===void 0){e.minSegmentPts=t.pts}else{e.minSegmentPts=Math.min(e.minSegmentPts,t.pts)}if(e.maxSegmentPts===void 0){e.maxSegmentPts=t.pts}else{e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)}}if("number"==typeof t.dts){if(e.timelineStartInfo.dts===void 0){e.timelineStartInfo.dts=t.dts}if(e.minSegmentDts===void 0){e.minSegmentDts=t.dts}else{e.minSegmentDts=Math.min(e.minSegmentDts,t.dts)}if(e.maxSegmentDts===void 0){e.maxSegmentDts=t.dts}else{e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts)}}}},ge=4,he={parseSei:function(e){var t=0,a={payloadType:-1,payloadSize:0},n=0,r=0;while(t<e.byteLength){if(e[t]===128){break}while(255===e[t]){n+=255;t++}n+=e[t++];while(255===e[t]){r+=255;t++}r+=e[t++];if(!a.payload&&n===ge){a.payloadType=n;a.payloadSize=r;a.payload=e.subarray(t,t+r);break}t+=r;n=0;r=0}return a},parseUserData:function(e){if(181!==e.payload[0]){return null}if(49!=(e.payload[1]<<8|e.payload[2])){return null}if("GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])){return null}if(3!==e.payload[7]){return null}return e.payload.subarray(8,e.payload.length-1)},parseCaptionPackets:function(e,t){var a=[],n,r,s,o;if(!(64&t[0])){return a}r=31&t[0];for(n=0;n<r;n++){s=3*n;o={type:3&t[s+2],pts:e};if(4&t[s+2]){o.ccData=t[s+3]<<8|t[s+4];a.push(o)}}return a},discardEmulationPreventionBytes:function(e){var t=e.byteLength,a=[],n=1,r,s;while(n<t-2){if(0===e[n]&&0===e[n+1]&&3===e[n+2]){a.push(n+2);n+=2}else{n++}}if(0===a.length){return e}r=t-a.length;s=new Uint8Array(r);var o=0;for(n=0;n<r;o++,n++){if(o===a[0]){o++;a.shift()}s[n]=e[o]}return s},USER_DATA_REGISTERED_ITU_T_T35:ge},ye=function e(){e.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new Se(0,0),new Se(0,1),new Se(1,0),new Se(1,1)];this.reset();this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data"));e.on("done",this.trigger.bind(this,"done"))},this)};ye.prototype=new K;ye.prototype.push=function(e){var t,a,n;if("sei_rbsp"!==e.nalUnitType){return}t=he.parseSei(e.escapedRBSP);if(t.payloadType!==he.USER_DATA_REGISTERED_ITU_T_T35){return}a=he.parseUserData(t);if(!a){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=!1}return}n=he.parseCaptionPackets(e.pts,a);this.captionPackets_=this.captionPackets_.concat(n);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};ye.prototype.flush=function(){if(!this.captionPackets_.length){this.ccStreams_.forEach(function(e){e.flush()},this);return}this.captionPackets_.forEach(function(e,t){e.presortIndex=t});this.captionPackets_.sort(function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts});this.captionPackets_.forEach(function(e){if(2>e.type){this.dispatchCea608Packet(e)}},this);this.captionPackets_.length=0;this.ccStreams_.forEach(function(e){e.flush()},this)};ye.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=!1;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(e){e.reset()})};ye.prototype.dispatchCea608Packet=function(e){if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(null===this.activeCea608Channel_[e.type]){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};ye.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)};ye.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)};var _e={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},fe=function(e){if(null===e){return""}e=_e[e]||e;return String.fromCharCode(e)},be=14,Te=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],ve=function(){var e=[],t=be+1;while(t--){e.push("")}return e},Se=function e(t,a){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=a||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,a,n,r,i;t=32639&e.ccData;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if(4096==(61440&t)){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}n=t>>>8;r=255&t;if(t===this.PADDING_){}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);a=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=a;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if("popOn"===this.mode_){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=ve()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=ve()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if("paintOn"!==this.mode_){this.flushDisplayed(e.pts);this.displayed_=ve()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(n,r)){n=(3&n)<<8;i=fe(n|r);this[this.mode_](e.pts,i);this.column_++}else if(this.isExtCharacter(n,r)){if("popOn"===this.mode_){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}n=(3&n)<<8;i=fe(n|r);this[this.mode_](e.pts,i);this.column_++}else if(this.isMidRowCode(n,r)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if(14==(14&r)){this.addFormatting(e.pts,["i"])}if(1==(1&r)){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(n,r)){this.column_+=3&r}else if(this.isPAC(n,r)){var s=Te.indexOf(7968&t);if("rollUp"===this.mode_){if(0>s-this.rollUpRows_+1){s=this.rollUpRows_-1}this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(1&r&&-1===this.formatting_.indexOf("u")){this.addFormatting(e.pts,["u"])}if(16==(16&t)){this.column_=4*((14&t)>>1)}if(this.isColorPAC(r)){if(14==(14&r)){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(n)){if(0===r){r=null}i=fe(n);i+=fe(r);this[this.mode_](e.pts,i);this.column_+=i.length}}};Se.prototype=new K;Se.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(t){console.error("Skipping malformed caption.");return""}}).join("\n").replace(/^\n+|\n+$/g,"");if(t.length){this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})}};Se.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=ve();this.nonDisplayed_=ve();this.lastControlCode_=null;this.column_=0;this.row_=be;this.rollUpRows_=2;this.formatting_=[]};Se.prototype.setConstants=function(){if(0===this.dataChannel_){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(1===this.dataChannel_){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=32|this.CONTROL_;this.END_OF_CAPTION_=47|this.CONTROL_;this.ROLL_UP_2_ROWS_=37|this.CONTROL_;this.ROLL_UP_3_ROWS_=38|this.CONTROL_;this.ROLL_UP_4_ROWS_=39|this.CONTROL_;this.CARRIAGE_RETURN_=45|this.CONTROL_;this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_;this.BACKSPACE_=33|this.CONTROL_;this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_;this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_};Se.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&63>=t};Se.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&63>=t};Se.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&47>=t};Se.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&35>=t};Se.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&127>=t};Se.prototype.isColorPAC=function(e){return 64<=e&&79>=e||96<=e&&127>=e};Se.prototype.isNormalChar=function(e){return 32<=e&&127>=e};Se.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_){this.row_=be;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=ve();this.displayed_=ve()}if(t!==void 0&&t!==this.row_){for(var a=0;a<this.rollUpRows_;a++){this.displayed_[t-a]=this.displayed_[this.row_-a];this.displayed_[this.row_-a]=""}}if(t===void 0){t=this.row_}this.topRow_=t-this.rollUpRows_+1};Se.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var a=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,a)};Se.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[];this[this.mode_](e,t)};Se.prototype.popOn=function(e,t){var a=this.nonDisplayed_[this.row_];a+=t;this.nonDisplayed_[this.row_]=a};Se.prototype.rollUp=function(e,t){var a=this.displayed_[this.row_];a+=t;this.displayed_[this.row_]=a};Se.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]=""}for(e=this.row_+1;e<be+1;e++){this.displayed_[e]=""}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]=""};Se.prototype.paintOn=function(e,t){var a=this.displayed_[this.row_];a+=t;this.displayed_[this.row_]=a};var ke={CaptionStream:ye,Cea608Stream:Se},Ce={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Ee=function(e,t){var a=1;if(e>t){a=-1}while(Math.abs(t-e)>4294967296){e+=a*8589934592}return e},Le=function e(t){var a,n;e.prototype.init.call(this);this.type_=t;this.push=function(e){if(e.type!==this.type_){return}if(n===void 0){n=e.dts}e.dts=Ee(e.dts,n);e.pts=Ee(e.pts,n);a=e.dts;this.trigger("data",e)};this.flush=function(){n=a;this.trigger("done")};this.discontinuity=function(){n=void 0;a=void 0}};Le.prototype=new K;var Ie=function(e,t,a){var n,r="";for(n=t;n<a;n++){r+="%"+("00"+e[n].toString(16)).slice(-2)}return r},Pe=function(e,t,a){return decodeURIComponent(Ie(e,t,a))},xe=function(e,t,a){return unescape(Ie(e,t,a))},De=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Ae={TXXX:function(e){var t;if(3!==e.data[0]){return}for(t=1;t<e.data.length;t++){if(0===e.data[t]){e.description=Pe(e.data,1,t);e.value=Pe(e.data,t+1,e.data.length).replace(/\0*$/,"");break}}e.data=e.value},WXXX:function(e){var t;if(3!==e.data[0]){return}for(t=1;t<e.data.length;t++){if(0===e.data[t]){e.description=Pe(e.data,1,t);e.url=Pe(e.data,t+1,e.data.length);break}}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++){if(0===e.data[t]){e.owner=xe(e.data,0,t);break}}e.privateData=e.data.subarray(t+1);e.data=e.privateData}},we;we=function(e){var t={debug:!!(e&&e.debug),descriptor:e&&e.descriptor},a=0,n=[],r=0,s;we.prototype.init.call(this);this.dispatchType=Ce.METADATA_STREAM_TYPE.toString(16);if(t.descriptor){for(s=0;s<t.descriptor.length;s++){this.dispatchType+=("00"+t.descriptor[s].toString(16)).slice(-2)}}this.push=function(e){var s,o,l,p,u,c;if("timed-metadata"!==e.type){return}if(e.dataAlignmentIndicator){r=0;n.length=0}if(0===n.length&&(10>e.data.length||e.data[0]!==73||e.data[1]!==68||e.data[2]!==51)){if(t.debug){console.log("Skipping unrecognized metadata packet")}return}n.push(e);r+=e.data.byteLength;if(1===n.length){a=De(e.data.subarray(6,10));a+=10}if(r<a){return}s={data:new Uint8Array(a),frames:[],pts:n[0].pts,dts:n[0].dts};for(u=0;u<a;){s.data.set(n[0].data.subarray(0,a-u),u);u+=n[0].data.byteLength;r-=n[0].data.byteLength;n.shift()}o=10;if(64&s.data[5]){o+=4;o+=De(s.data.subarray(10,14));a-=De(s.data.subarray(16,20))}do{l=De(s.data.subarray(o+4,o+8));if(1>l){return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.")}c=String.fromCharCode(s.data[o],s.data[o+1],s.data[o+2],s.data[o+3]);p={id:c,data:s.data.subarray(o+10,o+l+10)};p.key=p.id;if(Ae[p.id]){Ae[p.id](p);if("com.apple.streaming.transportStreamTimestamp"===p.owner){var m=p.data,d=(1&m[3])<<30|m[4]<<22|m[5]<<14|m[6]<<6|m[7]>>>2;d*=4;d+=3&m[7];p.timeStamp=d;if(s.pts===void 0&&s.dts===void 0){s.pts=p.timeStamp;s.dts=p.timeStamp}this.trigger("timestamp",p)}}s.frames.push(p);o+=10;o+=l}while(o<a);this.trigger("data",s)}};we.prototype=new K;var Oe=we,Ue={TimestampRolloverStream:Le,handleRollover:Ee}.TimestampRolloverStream,Re,Me,Be,Ne=188,je=71;Re=function(){var e=new Uint8Array(Ne),t=0;Re.prototype.init.call(this);this.push=function(a){var n=0,r=Ne,i;if(t){i=new Uint8Array(a.byteLength+t);i.set(e.subarray(0,t));i.set(a,t);t=0}else{i=a}while(r<i.byteLength){if(i[n]===je&&i[r]===je){this.trigger("data",i.subarray(n,r));n+=Ne;r+=Ne;continue}n++;r++}if(n<i.byteLength){e.set(i.subarray(n),0);t=i.byteLength-n}};this.flush=function(){if(t===Ne&&e[0]===je){this.trigger("data",e);t=0}this.trigger("done")}};Re.prototype=new K;Me=function(){var e,t,a,n;Me.prototype.init.call(this);n=this;this.packetsWaitingForPmt=[];this.programMapTable=void 0;e=function(e,n){var r=0;if(n.payloadUnitStartIndicator){r+=e[r]+1}if("pat"===n.type){t(e.subarray(r),n)}else{a(e.subarray(r),n)}};t=function(e,t){t.section_number=e[7];t.last_section_number=e[8];n.pmtPid=(31&e[10])<<8|e[11];t.pmtPid=n.pmtPid};a=function(e,t){var a,r,i,s;if(!(1&e[5])){return}n.programMapTable={video:null,audio:null,"timed-metadata":{}};a=(15&e[1])<<8|e[2];r=3+a-4;i=(15&e[10])<<8|e[11];s=12+i;while(s<r){var o=e[s],d=(31&e[s+1])<<8|e[s+2];if(o===Ce.H264_STREAM_TYPE&&null===n.programMapTable.video){n.programMapTable.video=d}else if(o===Ce.ADTS_STREAM_TYPE&&null===n.programMapTable.audio){n.programMapTable.audio=d}else if(o===Ce.METADATA_STREAM_TYPE){n.programMapTable["timed-metadata"][d]=o}s+=((15&e[s+3])<<8|e[s+4])+5}t.programMapTable=n.programMapTable};this.push=function(t){var a={},n=4;a.payloadUnitStartIndicator=!!(64&t[1]);a.pid=31&t[1];a.pid<<=8;a.pid|=t[2];if(1<(48&t[3])>>>4){n+=t[n]+1}if(0===a.pid){a.type="pat";e(t.subarray(n),a);this.trigger("data",a)}else if(a.pid===this.pmtPid){a.type="pmt";e(t.subarray(n),a);this.trigger("data",a);while(this.packetsWaitingForPmt.length){this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}}else if(this.programMapTable===void 0){this.packetsWaitingForPmt.push([t,n,a])}else{this.processPes_(t,n,a)}};this.processPes_=function(e,t,a){if(a.pid===this.programMapTable.video){a.streamType=Ce.H264_STREAM_TYPE}else if(a.pid===this.programMapTable.audio){a.streamType=Ce.ADTS_STREAM_TYPE}else{a.streamType=this.programMapTable["timed-metadata"][a.pid]}a.type="pes";a.data=e.subarray(t);this.trigger("data",a)}};Me.prototype=new K;Me.STREAM_TYPES={h264:27,adts:15};Be=function(){var e=this,t={data:[],size:0},a={data:[],size:0},n={data:[],size:0},r=function(e,t){var a;t.packetLength=6+(e[4]<<8|e[5]);t.dataAlignmentIndicator=0!=(4&e[6]);a=e[7];if(192&a){t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3;t.pts*=4;t.pts+=(6&e[13])>>>1;t.dts=t.pts;if(64&a){t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3;t.dts*=4;t.dts+=(6&e[18])>>>1}}t.data=e.subarray(9+e[8])},i=function(t,a,n){var s=new Uint8Array(t.size),o={type:a},d=0,l=0,p=!1,u;if(!t.data.length||9>t.size){return}o.trackId=t.data[0].pid;for(d=0;d<t.data.length;d++){u=t.data[d];s.set(u.data,l);l+=u.data.byteLength}r(s,o);p="video"===a||o.packetLength<=t.size;if(n||p){t.size=0;t.data.length=0}if(p){e.trigger("data",o)}};Be.prototype.init.call(this);this.push=function(r){({pat:function(){},pes:function(){var e,s;switch(r.streamType){case Ce.H264_STREAM_TYPE:case Ce.H264_STREAM_TYPE:e=t;s="video";break;case Ce.ADTS_STREAM_TYPE:e=a;s="audio";break;case Ce.METADATA_STREAM_TYPE:e=n;s="timed-metadata";break;default:return;}if(r.payloadUnitStartIndicator){i(e,s,!0)}e.data.push(r);e.size+=r.data.byteLength},pmt:function(){var t={type:"metadata",tracks:[]},a=r.programMapTable;if(null!==a.video){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+a.video,codec:"avc",type:"video"})}if(null!==a.audio){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+a.audio,codec:"adts",type:"audio"})}e.trigger("data",t)}})[r.type]()};this.flush=function(){i(t,"video");i(a,"audio");i(n,"timed-metadata");this.trigger("done")}};Be.prototype=new K;var Fe={PAT_PID:0,MP2T_PACKET_LENGTH:Ne,TransportPacketStream:Re,TransportParseStream:Me,ElementaryStream:Be,TimestampRolloverStream:Ue,CaptionStream:ke.CaptionStream,Cea608Stream:ke.Cea608Stream,MetadataStream:Oe};for(var He in Ce){if(Ce.hasOwnProperty(He)){Fe[He]=Ce[He]}}var Ve=Fe,qe,ze=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];qe=function(){var e;qe.prototype.init.call(this);this.push=function(t){var a=0,n=0,r,s,o,d,l,p;if("audio"!==t.type){return}if(e){d=e;e=new Uint8Array(d.byteLength+t.data.byteLength);e.set(d);e.set(t.data,d.byteLength)}else{e=t.data}while(a+5<e.length){if(255!==e[a]||240!=(246&e[a+1])){a++;continue}s=2*(1&~e[a+1]);r=(3&e[a+3])<<11|e[a+4]<<3|(224&e[a+5])>>5;l=1024*((3&e[a+6])+1);p=9e4*l/ze[(60&e[a+2])>>>2];o=a+r;if(e.byteLength<o){return}this.trigger("data",{pts:t.pts+n*p,dts:t.dts+n*p,sampleCount:l,audioobjecttype:(3&e[a+2]>>>6)+1,channelcount:(1&e[a+2])<<2|(192&e[a+3])>>>6,samplerate:ze[(60&e[a+2])>>>2],samplingfrequencyindex:(60&e[a+2])>>>2,samplesize:16,data:e.subarray(a+7+s,o)});if(e.byteLength===o){e=void 0;return}n++;e=e.subarray(o)}};this.flush=function(){this.trigger("done")}};qe.prototype=new K;var Ge=qe,We;We=function(e){var t=e.byteLength,a=0,n=0;this.length=function(){return 8*t};this.bitsAvailable=function(){return 8*t+n};this.loadWord=function(){var r=e.byteLength-t,i=new Uint8Array(4),s=Math.min(4,t);if(0===s){throw new Error("no bytes available")}i.set(e.subarray(r,r+s));a=new DataView(i.buffer).getUint32(0);n=8*s;t-=s};this.skipBits=function(e){var r;if(n>e){a<<=e;n-=e}else{e-=n;r=Math.floor(e/8);e-=8*r;t-=r;this.loadWord();a<<=e;n-=e}};this.readBits=function(e){var r=Math.min(n,e),i=a>>>32-r;n-=r;if(0<n){a<<=r}else if(0<t){this.loadWord()}r=e-r;if(0<r){return i<<r|this.readBits(r)}return i};this.skipLeadingZeros=function(){var e;for(e=0;e<n;++e){if(0!=(a&2147483648>>>e)){a<<=e;n-=e;return e}}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e){return 1+e>>>1}return-1*(e>>>1)};this.readBoolean=function(){return 1===this.readBits(1)};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var Ke=We,Ye,Xe,$e;Xe=function(){var e=0,t,a;Xe.prototype.init.call(this);this.push=function(n){var r;if(!a){a=n.data}else{r=new Uint8Array(a.byteLength+n.data.byteLength);r.set(a);r.set(n.data,a.byteLength);a=r}for(;e<a.byteLength-3;e++){if(1===a[e+2]){t=e+5;break}}while(t<a.byteLength){switch(a[t]){case 0:if(0!==a[t-1]){t+=2;break}else if(0!==a[t-2]){t++;break}if(e+3!=t-2){this.trigger("data",a.subarray(e+3,t-2))}do{t++}while(1!==a[t]&&t<a.length);e=t-2;t+=3;break;case 1:if(0!==a[t-1]||0!==a[t-2]){t+=3;break}this.trigger("data",a.subarray(e+3,t-2));e=t-2;t+=3;break;default:t+=3;break;}}a=a.subarray(e);t-=e;e=0};this.flush=function(){if(a&&3<a.byteLength){this.trigger("data",a.subarray(e+3))}a=null;e=0;this.trigger("done")}};Xe.prototype=new K;$e={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0};Ye=function(){var e=new Xe,t,a,n,r,i,s,o;Ye.prototype.init.call(this);t=this;this.push=function(t){if("video"!==t.type){return}a=t.trackId;n=t.pts;r=t.dts;e.push(t)};e.on("data",function(e){var o={trackId:a,pts:n,dts:r,data:e};switch(31&e[0]){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp";o.escapedRBSP=i(e.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp";o.escapedRBSP=i(e.subarray(1));o.config=s(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp";break;default:break;}t.trigger("data",o)});e.on("done",function(){t.trigger("done")});this.flush=function(){e.flush()};o=function(e,t){var a=8,n=8,r,i;for(r=0;r<e;r++){if(0!=n){i=t.readExpGolomb();n=(a+i+256)%256}a=0==n?a:n}};i=function(e){var t=e.byteLength,a=[],n=1,r,s;while(n<t-2){if(0===e[n]&&0===e[n+1]&&3===e[n+2]){a.push(n+2);n+=2}else{n++}}if(0===a.length){return e}r=t-a.length;s=new Uint8Array(r);var o=0;for(n=0;n<r;o++,n++){if(o===a[0]){o++;a.shift()}s[n]=e[o]}return s};s=function(e){var t=0,a=0,n=0,r=0,s=1,d,l,p,u,c,m,g,h,y,_,f,b,T,v;d=new Ke(e);l=d.readUnsignedByte();u=d.readUnsignedByte();p=d.readUnsignedByte();d.skipUnsignedExpGolomb();if($e[l]){c=d.readUnsignedExpGolomb();if(3===c){d.skipBits(1)}d.skipUnsignedExpGolomb();d.skipUnsignedExpGolomb();d.skipBits(1);if(d.readBoolean()){f=3!==c?8:12;for(v=0;v<f;v++){if(d.readBoolean()){if(6>v){o(16,d)}else{o(64,d)}}}}}d.skipUnsignedExpGolomb();m=d.readUnsignedExpGolomb();if(0===m){d.readUnsignedExpGolomb()}else if(1===m){d.skipBits(1);d.skipExpGolomb();d.skipExpGolomb();g=d.readUnsignedExpGolomb();for(v=0;v<g;v++){d.skipExpGolomb()}}d.skipUnsignedExpGolomb();d.skipBits(1);h=d.readUnsignedExpGolomb();y=d.readUnsignedExpGolomb();_=d.readBits(1);if(0===_){d.skipBits(1)}d.skipBits(1);if(d.readBoolean()){t=d.readUnsignedExpGolomb();a=d.readUnsignedExpGolomb();n=d.readUnsignedExpGolomb();r=d.readUnsignedExpGolomb()}if(d.readBoolean()){if(d.readBoolean()){T=d.readUnsignedByte();switch(T){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:{b=[d.readUnsignedByte()<<8|d.readUnsignedByte(),d.readUnsignedByte()<<8|d.readUnsignedByte()];break}}if(b){s=b[0]/b[1]}}}return{profileIdc:l,levelIdc:p,profileCompatibility:u,width:Math.ceil((16*(h+1)-2*t-2*a)*s),height:16*((2-_)*(y+1))-2*n-2*r}}};Ye.prototype=new K;var Qe={H264Stream:Ye,NalByteStream:Xe},Je=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Ze=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},et=function(e,t,a){var n,r="";for(n=t;n<a;n++){r+="%"+("00"+e[n].toString(16)).slice(-2)}return r},tt=function(e,t,a){return unescape(et(e,t,a))},at={isLikelyAacData:function(e){if(e[0]===73&&e[1]===68&&e[2]===51){return!0}return!1},parseId3TagSize:function(e,t){var a=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],n=e[t+5];if((16&n)>>4){return a+20}return a+10},parseAdtsSize:function(e,t){var a=(224&e[t+5])>>5,n=e[t+4]<<3,r=e[t+3]&6144;return r|n|a},parseType:function(e,t){if(e[t]===73&&e[t+1]===68&&e[t+2]===51){return"timed-metadata"}else if(e[t]&!0&&240==(240&e[t+1])){return"audio"}return null},parseSampleRate:function(e){var t=0;while(t+5<e.length){if(255!==e[t]||240!=(246&e[t+1])){t++;continue}return Je[(60&e[t+2])>>>2]}return null},parseAacTimestamp:function(e){var t,a,n,r;t=10;if(64&e[5]){t+=4;t+=Ze(e.subarray(10,14))}do{a=Ze(e.subarray(t+4,t+8));if(1>a){return null}r=String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3]);if("PRIV"===r){n=e.subarray(t+10,t+a+10);for(var s=0;s<n.byteLength;s++){if(0===n[s]){var o=tt(n,0,s);if("com.apple.streaming.transportStreamTimestamp"===o){var l=n.subarray(s+1),d=(1&l[3])<<30|l[4]<<22|l[5]<<14|l[6]<<6|l[7]>>>2;d*=4;d+=3&l[7];return d}break}}}t+=10;t+=a}while(t<e.byteLength);return null}},nt;nt=function(){var e=new Uint8Array,t=0;nt.prototype.init.call(this);this.setTimestamp=function(e){t=e};this.push=function(a){var n=0,r=0,i,s,o,d;if(e.length){d=e.length;e=new Uint8Array(a.byteLength+d);e.set(e.subarray(0,d));e.set(a,d)}else{e=a}while(3<=e.length-r){if(e[r]===73&&e[r+1]===68&&e[r+2]===51){if(10>e.length-r){break}n=at.parseId3TagSize(e,r);if(r+n>e.length){break}s={type:"timed-metadata",data:e.subarray(r,r+n)};this.trigger("data",s);r+=n;continue}else if(255==(255&e[r])&&240==(240&e[r+1])){if(7>e.length-r){break}n=at.parseAdtsSize(e,r);if(r+n>e.length){break}o={type:"audio",data:e.subarray(r,r+n),pts:t,dts:t};this.trigger("data",o);r+=n;continue}r++}i=e.length-r;if(0<i){e=e.subarray(r)}else{e=new Uint8Array}}};nt.prototype=new K;var rt=nt,it=Qe.H264Stream,st=at.isLikelyAacData,ot=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],dt=["width","height","profileIdc","levelIdc","profileCompatibility"],lt,pt,ut,ct,mt=function(e,t){var a;if(e.length!==t.length){return!1}for(a=0;a<e.length;a++){if(e[a]!==t[a]){return!1}}return!0},gt=function(e,t,a,n,r,i){return{start:{dts:e,pts:e+(a-t)},end:{dts:e+(n-t),pts:e+(r-a)},prependedContentDuration:i,baseMediaDecodeTime:e}};pt=function(e,t){var a=[],n=0,r=0,i=0,s=1/0;t=t||{};pt.prototype.init.call(this);this.push=function(t){me.collectDtsInfo(e,t);if(e){ot.forEach(function(a){e[a]=t[a]})}a.push(t)};this.setEarliestDts=function(t){r=t-e.timelineStartInfo.baseMediaDecodeTime};this.setVideoBaseMediaDecodeTime=function(e){s=e};this.setAudioAppendStart=function(e){i=e};this.flush=function(){var o,d,l,p;if(0===a.length){this.trigger("done","AudioSegmentStream");return}o=ce.trimAdtsFramesByEarliestDts(a,e,r);e.baseMediaDecodeTime=me.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);ce.prefixWithSilence(e,o,i,s);e.samples=ce.generateSampleTable(o);l=N.mdat(ce.concatenateFrameData(o));a=[];d=N.moof(n,[e]);p=new Uint8Array(d.byteLength+l.byteLength);n++;p.set(d);p.set(l,d.byteLength);me.clearDtsInfo(e);this.trigger("data",{track:e,boxes:p});this.trigger("done","AudioSegmentStream")}};pt.prototype=new K;lt=function(e,t){var a=0,n=[],r=[],i,s;t=t||{};lt.prototype.init.call(this);delete e.minPTS;this.gopCache_=[];this.push=function(t){me.collectDtsInfo(e,t);if("seq_parameter_set_rbsp"===t.nalUnitType&&!i){i=t.config;e.sps=[t.data];dt.forEach(function(t){e[t]=i[t]},this)}if("pic_parameter_set_rbsp"===t.nalUnitType&&!s){s=t.data;e.pps=[t.data]}n.push(t)};this.flush=function(){var i,s,o,d,l,p,u=0,c,m;while(n.length){if("access_unit_delimiter_rbsp"===n[0].nalUnitType){break}n.shift()}if(0===n.length){this.resetStream_();this.trigger("done","VideoSegmentStream");return}i=$.groupNalsIntoFrames(n);o=$.groupFramesIntoGops(i);if(!o[0][0].keyFrame){s=this.getGopForFusion_(n[0],e);if(s){u=s.duration;o.unshift(s);o.byteLength+=s.byteLength;o.nalCount+=s.nalCount;o.pts=s.pts;o.dts=s.dts;o.duration+=s.duration}else{o=$.extendFirstKeyFrame(o)}}if(r.length){var g;if(t.alignGopsAtEnd){g=this.alignGopsAtEnd_(o)}else{g=this.alignGopsAtStart_(o)}if(!g){this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}me.clearDtsInfo(e);o=g}me.collectDtsInfo(e,o);e.samples=$.generateSampleTable(o);l=N.mdat($.concatenateNalData(o));e.baseMediaDecodeTime=me.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);this.trigger("processedGopsInfo",o.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}));c=o[0];m=o[o.length-1];this.trigger("segmentTimingInfo",gt(e.baseMediaDecodeTime,c.dts,c.pts,m.dts+m.duration,m.pts+m.duration,u));this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime);this.trigger("timelineStartInfo",e.timelineStartInfo);d=N.moof(a,[e]);p=new Uint8Array(d.byteLength+l.byteLength);a++;p.set(d);p.set(l,d.byteLength);this.trigger("data",{track:e,boxes:p});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.resetStream_=function(){me.clearDtsInfo(e);i=void 0;s=void 0};this.getGopForFusion_=function(t){var a=1/0,n,r,s,o,d;for(d=0;d<this.gopCache_.length;d++){o=this.gopCache_[d];s=o.gop;if(!(e.pps&&mt(e.pps[0],o.pps[0]))||!(e.sps&&mt(e.sps[0],o.sps[0]))){continue}if(s.dts<e.timelineStartInfo.dts){continue}n=t.dts-s.dts-s.duration;if(n>=-10000&&n<=45000){if(!r||a>n){r=o;a=n}}}if(r){return r.gop}return null};this.alignGopsAtStart_=function(e){var t,a,n,i,s,o,d,l;s=e.byteLength;o=e.nalCount;d=e.duration;t=a=0;while(t<r.length&&a<e.length){n=r[t];i=e[a];if(n.pts===i.pts){break}if(i.pts>n.pts){t++;continue}a++;s-=i.byteLength;o-=i.nalCount;d-=i.duration}if(0===a){return e}if(a===e.length){return null}l=e.slice(a);l.byteLength=s;l.duration=d;l.nalCount=o;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsAtEnd_=function(e){var t,a,n,i,s,o;t=r.length-1;a=e.length-1;s=null;o=!1;while(0<=t&&0<=a){n=r[t];i=e[a];if(n.pts===i.pts){o=!0;break}if(n.pts>i.pts){t--;continue}if(t===r.length-1){s=a}a--}if(!o&&null===s){return null}var d;if(o){d=a}else{d=s}if(0===d){return e}var l=e.slice(d),p=l.reduce(function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e},{byteLength:0,duration:0,nalCount:0});l.byteLength=p.byteLength;l.duration=p.duration;l.nalCount=p.nalCount;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsWith=function(e){r=e}};lt.prototype=new K;ct=function(e,t){this.numberOfTracks=0;this.metadataStream=t;e=e||{};if("undefined"!=typeof e.remux){this.remuxTracks=!!e.remux}else{this.remuxTracks=!0}if("boolean"==typeof e.keepOriginalTimestamps){this.keepOriginalTimestamps=e.keepOriginalTimestamps}this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;ct.prototype.init.call(this);this.push=function(e){if(e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}this.pendingTracks.push(e.track);this.pendingBoxes.push(e.boxes);this.pendingBytes+=e.boxes.byteLength;if("video"===e.track.type){this.videoTrack=e.track}if("audio"===e.track.type){this.audioTrack=e.track}}};ct.prototype=new K;ct.prototype.flush=function(e){var t=0,a={captions:[],captionStreams:{},metadata:[],info:{}},n,r,s,o=0,d;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e){return}else if(this.remuxTracks){return}else if(0===this.pendingTracks.length){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}}if(this.videoTrack){o=this.videoTrack.timelineStartInfo.pts;dt.forEach(function(e){a.info[e]=this.videoTrack[e]},this)}else if(this.audioTrack){o=this.audioTrack.timelineStartInfo.pts;ot.forEach(function(e){a.info[e]=this.audioTrack[e]},this)}if(1===this.pendingTracks.length){a.type=this.pendingTracks[0].type}else{a.type="combined"}this.emittedTracks+=this.pendingTracks.length;s=N.initSegment(this.pendingTracks);a.initSegment=new Uint8Array(s.byteLength);a.initSegment.set(s);a.data=new Uint8Array(this.pendingBytes);for(d=0;d<this.pendingBoxes.length;d++){a.data.set(this.pendingBoxes[d],t);t+=this.pendingBoxes[d].byteLength}for(d=0;d<this.pendingCaptions.length;d++){n=this.pendingCaptions[d];n.startTime=n.startPts;if(!this.keepOriginalTimestamps){n.startTime-=o}n.startTime/=9e4;n.endTime=n.endPts;if(!this.keepOriginalTimestamps){n.endTime-=o}n.endTime/=9e4;a.captionStreams[n.stream]=!0;a.captions.push(n)}for(d=0;d<this.pendingMetadata.length;d++){r=this.pendingMetadata[d];r.cueTime=r.pts;if(!this.keepOriginalTimestamps){r.cueTime-=o}r.cueTime/=9e4;a.metadata.push(r)}a.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",a);if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};ut=function(e){var t=this,a=!0,n,r;ut.prototype.init.call(this);e=e||{};this.baseMediaDecodeTime=e.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var a={};this.transmuxPipeline_=a;a.type="aac";a.metadataStream=new Ve.MetadataStream;a.aacStream=new rt;a.audioTimestampRolloverStream=new Ve.TimestampRolloverStream("audio");a.timedMetadataTimestampRolloverStream=new Ve.TimestampRolloverStream("timed-metadata");a.adtsStream=new Ge;a.coalesceStream=new ct(e,a.metadataStream);a.headOfPipeline=a.aacStream;a.aacStream.pipe(a.audioTimestampRolloverStream).pipe(a.adtsStream);a.aacStream.pipe(a.timedMetadataTimestampRolloverStream).pipe(a.metadataStream).pipe(a.coalesceStream);a.metadataStream.on("timestamp",function(e){a.aacStream.setTimestamp(e.timeStamp)});a.aacStream.on("data",function(n){if("timed-metadata"===n.type&&!a.audioSegmentStream){r=r||{timelineStartInfo:{baseMediaDecodeTime:t.baseMediaDecodeTime},codec:"adts",type:"audio"};a.coalesceStream.numberOfTracks++;a.audioSegmentStream=new pt(r,e);a.adtsStream.pipe(a.audioSegmentStream).pipe(a.coalesceStream)}});a.coalesceStream.on("data",this.trigger.bind(this,"data"));a.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var a={};this.transmuxPipeline_=a;a.type="ts";a.metadataStream=new Ve.MetadataStream;a.packetStream=new Ve.TransportPacketStream;a.parseStream=new Ve.TransportParseStream;a.elementaryStream=new Ve.ElementaryStream;a.videoTimestampRolloverStream=new Ve.TimestampRolloverStream("video");a.audioTimestampRolloverStream=new Ve.TimestampRolloverStream("audio");a.timedMetadataTimestampRolloverStream=new Ve.TimestampRolloverStream("timed-metadata");a.adtsStream=new Ge;a.h264Stream=new it;a.captionStream=new Ve.CaptionStream;a.coalesceStream=new ct(e,a.metadataStream);a.headOfPipeline=a.packetStream;a.packetStream.pipe(a.parseStream).pipe(a.elementaryStream);a.elementaryStream.pipe(a.videoTimestampRolloverStream).pipe(a.h264Stream);a.elementaryStream.pipe(a.audioTimestampRolloverStream).pipe(a.adtsStream);a.elementaryStream.pipe(a.timedMetadataTimestampRolloverStream).pipe(a.metadataStream).pipe(a.coalesceStream);a.h264Stream.pipe(a.captionStream).pipe(a.coalesceStream);a.elementaryStream.on("data",function(s){var o;if("metadata"===s.type){o=s.tracks.length;while(o--){if(!n&&"video"===s.tracks[o].type){n=s.tracks[o];n.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime}else if(!r&&"audio"===s.tracks[o].type){r=s.tracks[o];r.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime}}if(n&&!a.videoSegmentStream){a.coalesceStream.numberOfTracks++;a.videoSegmentStream=new lt(n,e);a.videoSegmentStream.on("timelineStartInfo",function(e){if(r){r.timelineStartInfo=e;a.audioSegmentStream.setEarliestDts(e.dts)}});a.videoSegmentStream.on("processedGopsInfo",t.trigger.bind(t,"gopInfo"));a.videoSegmentStream.on("segmentTimingInfo",t.trigger.bind(t,"videoSegmentTimingInfo"));a.videoSegmentStream.on("baseMediaDecodeTime",function(e){if(r){a.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}});a.h264Stream.pipe(a.videoSegmentStream).pipe(a.coalesceStream)}if(r&&!a.audioSegmentStream){a.coalesceStream.numberOfTracks++;a.audioSegmentStream=new pt(r,e);a.adtsStream.pipe(a.audioSegmentStream).pipe(a.coalesceStream)}}});a.coalesceStream.on("data",this.trigger.bind(this,"data"));a.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(t){var a=this.transmuxPipeline_;if(!e.keepOriginalTimestamps){this.baseMediaDecodeTime=t}if(r){r.timelineStartInfo.dts=void 0;r.timelineStartInfo.pts=void 0;me.clearDtsInfo(r);if(!e.keepOriginalTimestamps){r.timelineStartInfo.baseMediaDecodeTime=t}if(a.audioTimestampRolloverStream){a.audioTimestampRolloverStream.discontinuity()}}if(n){if(a.videoSegmentStream){a.videoSegmentStream.gopCache_=[];a.videoTimestampRolloverStream.discontinuity()}n.timelineStartInfo.dts=void 0;n.timelineStartInfo.pts=void 0;me.clearDtsInfo(n);a.captionStream.reset();if(!e.keepOriginalTimestamps){n.timelineStartInfo.baseMediaDecodeTime=t}}if(a.timedMetadataTimestampRolloverStream){a.timedMetadataTimestampRolloverStream.discontinuity()}};this.setAudioAppendStart=function(e){if(r){this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)}};this.alignGopsWith=function(e){if(n&&this.transmuxPipeline_.videoSegmentStream){this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)}};this.push=function(e){if(a){var t=st(e);if(t&&"aac"!==this.transmuxPipeline_.type){this.setupAacPipeline()}else if(!t&&"ts"!==this.transmuxPipeline_.type){this.setupTsPipeline()}a=!1}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){a=!0;this.transmuxPipeline_.headOfPipeline.flush()};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream){this.transmuxPipeline_.captionStream.reset()}}};ut.prototype=new K;var ht={Transmuxer:ut,VideoSegmentStream:lt,AudioSegmentStream:pt,AUDIO_PROPERTIES:ot,VIDEO_PROPERTIES:dt,generateVideoSegmentTimingInfo:gt},yt,_t,ft=G.parseType,bt=function(e){return new Date(1e3*e-20828448e5)},Tt=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},vt=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=[],n,r;for(n=0;n+4<e.length;n+=r){r=t.getUint32(n);n+=4;if(0>=r){a.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(31&e[n]){case 1:a.push("slice_layer_without_partitioning_rbsp");break;case 5:a.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:a.push("sei_rbsp");break;case 7:a.push("seq_parameter_set_rbsp");break;case 8:a.push("pic_parameter_set_rbsp");break;case 9:a.push("access_unit_delimiter_rbsp");break;default:a.push(31&"UNKNOWN NAL - "+e[n]);break;}}return a},St={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:yt(e.subarray(78,e.byteLength))}},avcC:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},n=31&e[5],r,s,o,d;o=6;for(d=0;d<n;d++){s=t.getUint16(o);o+=2;a.sps.push(new Uint8Array(e.subarray(o,o+s)));o+=s}r=e[o];o++;for(d=0;d<r;d++){s=t.getUint16(o);o+=2;a.pps.push(new Uint8Array(e.subarray(o,o+s)));o+=s}return a},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:63&e[12]>>>2,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:31&e[26]>>>3,samplingFrequencyIndex:(7&e[26])<<1|1&e[27]>>>7,channelConfiguration:15&e[27]>>>3}}}},ftyp:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={majorBrand:ft(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},n=8;while(n<e.byteLength){a.compatibleBrands.push(ft(e.subarray(n,n+4)));n+=4}return a},dinf:function(e){return{boxes:yt(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:yt(e.subarray(8))}},hdlr:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:ft(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}a.name+=String.fromCharCode(e[n])}a.name=decodeURIComponent(escape(a.name));return a},mdat:function(e){return{byteLength:e.byteLength,nals:vt(e)}},mdhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,n,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};if(1===r.version){a+=4;r.creationTime=bt(t.getUint32(a));a+=8;r.modificationTime=bt(t.getUint32(a));a+=4;r.timescale=t.getUint32(a);a+=8;r.duration=t.getUint32(a)}else{r.creationTime=bt(t.getUint32(a));a+=4;r.modificationTime=bt(t.getUint32(a));a+=4;r.timescale=t.getUint32(a);a+=4;r.duration=t.getUint32(a)}a+=4;n=t.getUint16(a);r.language+=String.fromCharCode((n>>10)+96);r.language+=String.fromCharCode(((992&n)>>5)+96);r.language+=String.fromCharCode((31&n)+96);return r},mdia:function(e){return{boxes:yt(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:yt(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};if(28<e.byteLength){a.streamDescriptor=yt(e.subarray(28))[0]}return a},moof:function(e){return{boxes:yt(e)}},moov:function(e){return{boxes:yt(e)}},mvex:function(e){return{boxes:yt(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};if(1===n.version){a+=4;n.creationTime=bt(t.getUint32(a));a+=8;n.modificationTime=bt(t.getUint32(a));a+=4;n.timescale=t.getUint32(a);a+=8;n.duration=t.getUint32(a)}else{n.creationTime=bt(t.getUint32(a));a+=4;n.modificationTime=bt(t.getUint32(a));a+=4;n.timescale=t.getUint32(a);a+=4;n.duration=t.getUint32(a)}a+=4;n.rate=t.getUint16(a)+t.getUint16(a+2)/16;a+=4;n.volume=t.getUint8(a)+t.getUint8(a+1)/8;a+=2;a+=2;a+=8;n.matrix=new Uint32Array(e.subarray(a,a+36));a+=36;a+=24;n.nextTrackId=t.getUint32(a);return n},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},a;for(a=4;a<e.byteLength;a++){t.samples.push({dependsOn:(48&e[a])>>4,isDependedOn:(12&e[a])>>2,hasRedundancy:3&e[a]})}return t},sidx:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8),earliestPresentationTime:t.getUint32(12),firstOffset:t.getUint32(16)},n=t.getUint16(22),r;for(r=24;n;r+=12,n--){a.references.push({referenceType:(128&e[r])>>>7,referencedSize:2147483647&t.getUint32(r),subsegmentDuration:t.getUint32(r+4),startsWithSap:!!(128&e[r+8]),sapType:(112&e[r+8])>>>4,sapDeltaTime:268435455&t.getUint32(r+8)})}return a},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:yt(e)}},stco:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},n=t.getUint32(4),r;for(r=8;n;r+=4,n--){a.chunkOffsets.push(t.getUint32(r))}return a},stsc:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=t.getUint32(4),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]},r;for(r=8;a;r+=12,a--){n.sampleToChunks.push({firstChunk:t.getUint32(r),samplesPerChunk:t.getUint32(r+4),sampleDescriptionIndex:t.getUint32(r+8)})}return n},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:yt(e.subarray(8))}},stsz:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:t.getUint32(4),entries:[]},n;for(n=12;n<e.byteLength;n+=4){a.entries.push(t.getUint32(n))}return a},stts:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},n=t.getUint32(4),r;for(r=8;n;r+=8,n--){a.timeToSamples.push({sampleCount:t.getUint32(r),sampleDelta:t.getUint32(r+4)})}return a},styp:function(e){return St.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};if(1===t.version){t.baseMediaDecodeTime*=Math.pow(2,32);t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]}return t},tfhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4)},n=1&a.flags[2],r=2&a.flags[2],s=8&a.flags[2],o=16&a.flags[2],d=32&a.flags[2],l=65536&a.flags[0],p=131072&a.flags[0],u;u=8;if(n){u+=4;a.baseDataOffset=t.getUint32(12);u+=4}if(r){a.sampleDescriptionIndex=t.getUint32(u);u+=4}if(s){a.defaultSampleDuration=t.getUint32(u);u+=4}if(o){a.defaultSampleSize=t.getUint32(u);u+=4}if(d){a.defaultSampleFlags=t.getUint32(u)}if(l){a.durationIsEmpty=!0}if(!n&&p){a.baseDataOffsetIsMoof=!0}return a},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};if(1===n.version){a+=4;n.creationTime=bt(t.getUint32(a));a+=8;n.modificationTime=bt(t.getUint32(a));a+=4;n.trackId=t.getUint32(a);a+=4;a+=8;n.duration=t.getUint32(a)}else{n.creationTime=bt(t.getUint32(a));a+=4;n.modificationTime=bt(t.getUint32(a));a+=4;n.trackId=t.getUint32(a);a+=4;a+=4;n.duration=t.getUint32(a)}a+=4;a+=8;n.layer=t.getUint16(a);a+=2;n.alternateGroup=t.getUint16(a);a+=2;n.volume=t.getUint8(a)+t.getUint8(a+1)/8;a+=2;a+=2;n.matrix=new Uint32Array(e.subarray(a,a+36));a+=36;n.width=t.getUint16(a)+t.getUint16(a+2)/16;a+=4;n.height=t.getUint16(a)+t.getUint16(a+2)/16;return n},traf:function(e){return{boxes:yt(e)}},trak:function(e){return{boxes:yt(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},a=new DataView(e.buffer,e.byteOffset,e.byteLength),n=1&t.flags[2],r=4&t.flags[2],i=1&t.flags[1],s=2&t.flags[1],o=4&t.flags[1],d=8&t.flags[1],l=a.getUint32(4),p=8,u;if(n){t.dataOffset=a.getInt32(p);p+=4}if(r&&l){u={flags:Tt(e.subarray(p,p+4))};p+=4;if(i){u.duration=a.getUint32(p);p+=4}if(s){u.size=a.getUint32(p);p+=4}if(d){u.compositionTimeOffset=a.getUint32(p);p+=4}t.samples.push(u);l--}while(l--){u={};if(i){u.duration=a.getUint32(p);p+=4}if(s){u.size=a.getUint32(p);p+=4}if(o){u.flags=Tt(e.subarray(p,p+4));p+=4}if(d){u.compositionTimeOffset=a.getUint32(p);p+=4}t.samples.push(u)}return t},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};yt=function(e){for(var t=0,a=[],n,r,s,o,d,l=new ArrayBuffer(e.length),p=new Uint8Array(l),u=0;u<e.length;++u){p[u]=e[u]}n=new DataView(l);while(t<e.byteLength){r=n.getUint32(t);s=ft(e.subarray(t+4,t+8));o=1<r?t+r:e.byteLength;d=(St[s]||function(e){return{data:e}})(e.subarray(t+8,o));d.size=r;d.type=s;a.push(d);t=o}return a};_t=function(e,t){var a;t=t||0;a=Array(2*t+1).join(" ");return e.map(function(e){return a+e.type+"\n"+Object.keys(e).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(t){var n=a+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var i=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);if(!i){return n+"<>"}if(1===i.length){return n+"<"+i.join("").slice(1)+">"}return n+"<\n"+i.map(function(e){return a+"  "+e}).join("\n")+"\n"+a+"  >"}return n+JSON.stringify(r,null,2).split("\n").map(function(e,t){if(0===t){return e}return a+"  "+e}).join("\n")}).join("\n")+(e.boxes?"\n"+_t(e.boxes,t+1):"")}).join("\n")};var kt={inspect:yt,textify:_t,parseTfdt:St.tfdt,parseHdlr:St.hdlr,parseTfhd:St.tfhd,parseTrun:St.trun,parseSidx:St.sidx},Ct=he.discardEmulationPreventionBytes,Et=ke.CaptionStream,Lt=function(e,t){for(var a=e,n=0,r;n<t.length;n++){r=t[n];if(a<r.size){return r}a-=r.size}return null},It=function(e,t,a){var n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[],s,o,d,l;for(o=0;o+4<e.length;o+=d){d=n.getUint32(o);o+=4;if(0>=d){continue}switch(31&e[o]){case 6:var p=e.subarray(o+1,o+1+d),u=Lt(o,t);s={nalUnitType:"sei_rbsp",size:d,data:p,escapedRBSP:Ct(p),trackId:a};if(u){s.pts=u.pts;s.dts=u.dts;l=u}else{s.pts=l.pts;s.dts=l.dts}r.push(s);break;default:break;}}return r},Pt=function(e,t,a){var n=t,r=a.defaultSampleDuration||0,i=a.defaultSampleSize||0,s=a.trackId,o=[];e.forEach(function(e){var t=kt.parseTrun(e),a=t.samples;a.forEach(function(e){if(e.duration===void 0){e.duration=r}if(e.size===void 0){e.size=i}e.trackId=s;e.dts=n;if(e.compositionTimeOffset===void 0){e.compositionTimeOffset=0}e.pts=n+e.compositionTimeOffset;n+=e.duration});o=o.concat(a)});return o},xt=function(e,t){var a=G.findBox(e,["moof","traf"]),n=G.findBox(e,["mdat"]),r={},i=[];n.forEach(function(e,t){var n=a[t];i.push({mdat:e,traf:n})});i.forEach(function(e){var a=e.mdat,n=e.traf,i=G.findBox(n,["tfhd"]),s=kt.parseTfhd(i[0]),o=s.trackId,d=G.findBox(n,["tfdt"]),l=0<d.length?kt.parseTfdt(d[0]).baseMediaDecodeTime:0,p=G.findBox(n,["trun"]),u,c;if(t===o&&0<p.length){u=Pt(p,l,s);c=It(a,u,o);if(!r[o]){r[o]=[]}r[o]=r[o].concat(c)}});return r},Dt=function(e,t,a){var n;if(!t){return null}n=xt(e,t);return{seiNals:n[t],timescale:a}},At={generator:N,probe:G,Transmuxer:ht.Transmuxer,AudioSegmentStream:ht.AudioSegmentStream,VideoSegmentStream:ht.VideoSegmentStream,CaptionParser:function(){var e=!1,t,a,n,r,i;this.isInitialized=function(){return e};this.init=function(){t=new Et;e=!0;t.on("data",function(e){e.startTime=e.startPts/r;e.endTime=e.endPts/r;i.captions.push(e);i.captionStreams[e.stream]=!0})};this.isNewInit=function(e,t){if(e&&0===e.length||t&&"object"===_typeof(t)&&0===Object.keys(t).length){return!1}return n!==e[0]||r!==t[n]};this.parse=function(e,t,s){var o;if(!this.isInitialized()){return null}else if(!t||!s){return null}else if(this.isNewInit(t,s)){n=t[0];r=s[n]}else if(!n||!r){a.push(e);return null}while(0<a.length){var d=a.shift();this.parse(d,t,s)}o=Dt(e,n,r);if(null===o||!o.seiNals){return null}this.pushNals(o.seiNals);this.flushStream();return i};this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length){return null}e.forEach(function(e){t.push(e)})};this.flushStream=function(){if(!this.isInitialized()){return null}t.flush()};this.clearParsedCaptions=function(){i.captions=[];i.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized()){return null}t.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){a=[];n=null;r=null;if(!i){i={captions:[],captionStreams:{}}}else{this.clearParsedCaptions()}this.resetCaptionStream()};this.reset()}},wt=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}},Ot=function(){function e(e,t){for(var a=0,n;a<t.length;a++){n=t[a];n.enumerable=n.enumerable||!1;n.configurable=!0;if("value"in n)n.writable=!0;Object.defineProperty(e,n.key,n)}}return function(t,a,n){if(a)e(t.prototype,a);if(n)e(t,n);return t}}(),Ut=function(e,t){t.on("data",function(t){var a=t.initSegment;t.initSegment={data:a.buffer,byteOffset:a.byteOffset,byteLength:a.byteLength};var n=t.data;t.data=n.buffer;e.postMessage({action:"data",segment:t,byteOffset:n.byteOffset,byteLength:n.byteLength},[t.data])});if(t.captionStream){t.captionStream.on("data",function(t){e.postMessage({action:"caption",data:t})})}t.on("done",function(){e.postMessage({action:"done"})});t.on("gopInfo",function(t){e.postMessage({action:"gopInfo",gopInfo:t})});t.on("videoSegmentTimingInfo",function(t){e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})})},Rt=function(){function e(t,a){wt(this,e);this.options=a||{};this.self=t;this.init()}Ot(e,[{key:"init",value:function(){if(this.transmuxer){this.transmuxer.dispose()}this.transmuxer=new At.Transmuxer(this.options);Ut(this.self,this.transmuxer)}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*t))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]);return e}(),Mt=new function(e){e.onmessage=function(t){if("init"===t.data.action&&t.data.options){this.messageHandlers=new Rt(e,t.data.options);return}if(!this.messageHandlers){this.messageHandlers=new Rt(e)}if(t.data&&t.data.action&&"init"!==t.data.action){if(this.messageHandlers[t.data.action]){this.messageHandlers[t.data.action](t.data)}}}}(e);return Mt}()}),gc={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},hc=function(e){return e.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,a){var n=("00"+(+t).toString(16)).slice(-2),r=("00"+(+a).toString(16)).slice(-2);return"avc1."+n+"00"+r})})},yc=function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",t={codecCount:0},a=void 0;t.codecCount=e.split(",").length;t.codecCount=t.codecCount||2;a=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(e);if(a){t.videoCodec=a[2];t.videoObjectTypeIndicator=a[3]}t.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(e);t.audioProfile=t.audioProfile&&t.audioProfile[2];return t},_c=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return hc([e])[0]})},fc=function(e,t,a){return e+"/"+t+"; codecs=\""+a.filter(function(e){return!!e}).join(", ")+"\""},bc=function(e){if(e.segments&&e.segments.length&&e.segments[0].map){return"mp4"}return"mp2t"},Tc=function(e){var t=e.attributes||{};if(t.CODECS){return yc(t.CODECS)}return gc},vc=function(e,t){if(!e.mediaGroups.AUDIO||!t){return null}var a=e.mediaGroups.AUDIO[t];if(!a){return null}for(var n in a){var r=a[n];if(r.default&&r.playlists){return yc(r.playlists[0].attributes.CODECS).audioProfile}}return null},Sc=function(e,t){var a=bc(t),n=Tc(t),r=t.attributes||{},i=!0,s=!1;if(!t){return[]}if(e.mediaGroups.AUDIO&&r.AUDIO){var o=e.mediaGroups.AUDIO[r.AUDIO];if(o){s=!0;i=!1;for(var d in o){if(!o[d].uri&&!o[d].playlists){i=!0;break}}}}if(s&&!n.audioProfile){if(!i){n.audioProfile=vc(e,r.AUDIO)}if(!n.audioProfile){mt.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)");n.audioProfile=gc.audioProfile}}var l={};if(n.videoCodec){l.video=""+n.videoCodec+n.videoObjectTypeIndicator}if(n.audioProfile){l.audio="mp4a.40."+n.audioProfile}var p=fc("audio",a,[l.audio]),u=fc("video",a,[l.video]),c=fc("video",a,[l.video,l.audio]);if(s){if(!i&&l.video){return[u,p]}if(!i&&!l.video){return[p,p]}return[c,p]}if(!l.video){return[p]}return[c]},kc=function(e){var t={type:"",parameters:{}},a=e.trim().split(";");t.type=a.shift().trim();a.forEach(function(e){var a=e.trim().split("=");if(1<a.length){var n=a[0].replace(/"/g,"").trim(),r=a[1].replace(/"/g,"").trim();t.parameters[n]=r}});return t},Cc=function(e){return /mp4a\.\d+.\d+/i.test(e)},Ec=function(e){return /avc1\.[\da-f]+/i.test(e)},Lc=function(e,t,a){if("undefined"==typeof t||null===t||!e.length){return[]}var n=Math.ceil(9e4*(t-a+3)),r=void 0;for(r=0;r<e.length;r++){if(e[r].pts>n){break}}return e.slice(r)},Ic=function(e,t,a){if(!t.length){return e}if(a){return t.slice()}var n=t[0].pts,r=0;for(r;r<e.length;r++){if(e[r].pts>=n){break}}return e.slice(0,r).concat(t)},Pc=function(e,t,a,n){var r=Math.ceil(9e4*(t-n)),s=Math.ceil(9e4*(a-n)),o=e.slice(),d=e.length;while(d--){if(e[d].pts<=s){break}}if(-1==d){return o}var l=d+1;while(l--){if(e[l].pts<=r){break}}l=Math.max(l,0);o.splice(l,d-l+1);return o},xc=function(e,t,a){var n=null,r=null,i=0,s=[],o=[];if(!e&&!t){return mt.createTimeRange()}if(!e){return t.buffered}if(!t){return e.buffered}if(a){return e.buffered}if(0===e.buffered.length&&0===t.buffered.length){return mt.createTimeRange()}var d=e.buffered,l=t.buffered,p=d.length;while(p--){s.push({time:d.start(p),type:"start"});s.push({time:d.end(p),type:"end"})}p=l.length;while(p--){s.push({time:l.start(p),type:"start"});s.push({time:l.end(p),type:"end"})}s.sort(function(e,t){return e.time-t.time});for(p=0;p<s.length;p++){if("start"===s[p].type){i++;if(2===i){n=s[p].time}}else if("end"===s[p].type){i--;if(1===i){r=s[p].time}}if(null!==n&&null!==r){o.push([n,r]);n=null;r=null}}return mt.createTimeRanges(o)},Dc=9e4,Ac=function(e,t){var a=e.addSourceBuffer(t),n=Object.create(null);n.updating=!1;n.realBuffer_=a;var r=function(e){if("function"==typeof a[e]){n[e]=function(){return a[e].apply(a,arguments)}}else if("undefined"==typeof n[e]){Object.defineProperty(n,e,{get:function(){return a[e]},set:function(t){return a[e]=t}})}};for(var i in a){r(i)}return n},wc=function(e){zp(t,e);function t(e,a){Hp(this,t);var n=Gp(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,mt.EventTarget));n.timestampOffset_=0;n.pendingBuffers_=[];n.bufferUpdating_=!1;n.mediaSource_=e;n.codecs_=a;n.audioCodec_=null;n.videoCodec_=null;n.audioDisabled_=!1;n.appendAudioInitSegment_=!0;n.gopBuffer_=[];n.timeMapping_=0;n.safeAppend_=11<=mt.browser.IE_VERSION;var r={remux:!1,alignGopsAtEnd:n.safeAppend_};n.codecs_.forEach(function(e){if(Cc(e)){n.audioCodec_=e}else if(Ec(e)){n.videoCodec_=e}});n.transmuxer_=new mc;n.transmuxer_.postMessage({action:"init",options:r});n.transmuxer_.onmessage=function(e){if("data"===e.data.action){return n.data_(e)}if("done"===e.data.action){return n.done_(e)}if("gopInfo"===e.data.action){return n.appendGopInfo_(e)}if("videoSegmentTimingInfo"===e.data.action){return n.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo)}};Object.defineProperty(n,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){if("number"==typeof e&&0<=e){this.timestampOffset_=e;this.appendAudioInitSegment_=!0;this.gopBuffer_.length=0;this.timeMapping_=0;this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e})}}});Object.defineProperty(n,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){if(this.videoBuffer_){this.videoBuffer_.appendWindowStart=e}if(this.audioBuffer_){this.audioBuffer_.appendWindowStart=e}}});Object.defineProperty(n,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}});Object.defineProperty(n,"buffered",{get:function(){return xc(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}});return n}Vp(t,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength);t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength);ec(this,this.mediaSource_,t);this.pendingBuffers_.push(t)}},{key:"done_",value:function(){if("closed"===this.mediaSource_.readyState){this.pendingBuffers_.length=0;return}this.processPendingSegments_()}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/Dc,presentation:e.start.pts/Dc},end:{decode:e.end.dts/Dc,presentation:e.end.pts/Dc},baseMediaDecodeTime:e.baseMediaDecodeTime/Dc};if(e.prependedContentDuration){t.prependedContentDuration=e.prependedContentDuration/Dc}this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach(function(a){if(!e[a+"Codec_"]){return}if(e[a+"Buffer_"]){return}var n=null;if(e.mediaSource_[a+"Buffer_"]){n=e.mediaSource_[a+"Buffer_"];n.updating=!1}else{var r=a+"/mp4;codecs=\""+e[a+"Codec_"]+"\"";n=Ac(e.mediaSource_.nativeMediaSource_,r);e.mediaSource_[a+"Buffer_"]=n}e[a+"Buffer_"]=n;["update","updatestart","updateend"].forEach(function(r){n.addEventListener(r,function(){if("audio"===a&&e.audioDisabled_){return}if("updateend"===r){e[a+"Buffer_"].updating=!1}var n=t.every(function(n){if("audio"===n&&e.audioDisabled_){return!0}if(a!==n&&e[n+"Buffer_"]&&e[n+"Buffer_"].updating){return!1}return!0});if(n){return e.trigger(r)}})})})}},{key:"appendBuffer",value:function(e){this.bufferUpdating_=!0;if(this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}if(this.videoBuffer_){this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:Lc(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)})}this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]);this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=Ic(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_){this.videoBuffer_.updating=!0;this.videoBuffer_.remove(e,t);this.gopBuffer_=Pc(this.gopBuffer_,e,t,this.timeMapping_)}if(!this.audioDisabled_&&this.audioBuffer_){this.audioBuffer_.updating=!0;this.audioBuffer_.remove(e,t)}tc(e,t,this.metadataTrack_);if(this.inbandTextTracks_){for(var a in this.inbandTextTracks_){tc(e,t,this.inbandTextTracks_[a])}}}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};e=this.pendingBuffers_.reduce(function(e,t){var a=t.type,n=t.data,r=t.initSegment;e[a].segments.push(n);e[a].bytes+=n.byteLength;e[a].initSegment=r;if(t.captions){e.captions=e.captions.concat(t.captions)}if(t.info){e[a].info=t.info}if(t.metadata){e.metadata=e.metadata.concat(t.metadata)}return e},e);if(!this.videoBuffer_&&!this.audioBuffer_){if(0===e.video.bytes){this.videoCodec_=null}if(0===e.audio.bytes){this.audioCodec_=null}this.createRealSourceBuffers_()}if(e.audio.info){this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info})}if(e.video.info){this.mediaSource_.trigger({type:"videoinfo",info:e.video.info})}if(this.appendAudioInitSegment_){if(!this.audioDisabled_&&this.audioBuffer_){e.audio.segments.unshift(e.audio.initSegment);e.audio.bytes+=e.audio.initSegment.byteLength}this.appendAudioInitSegment_=!1}var t=!1;if(this.videoBuffer_&&e.video.bytes){e.video.segments.unshift(e.video.initSegment);e.video.bytes+=e.video.initSegment.byteLength;this.concatAndAppendSegments_(e.video,this.videoBuffer_)}else if(this.videoBuffer_&&(this.audioDisabled_||!this.audioBuffer_)){t=!0}rc(this,e.captions,e.metadata);if(!this.audioDisabled_&&this.audioBuffer_){this.concatAndAppendSegments_(e.audio,this.audioBuffer_)}this.pendingBuffers_.length=0;if(t){this.trigger("updateend")}this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var a=0,n=void 0;if(e.bytes){n=new Uint8Array(e.bytes);e.segments.forEach(function(e){n.set(e,a);a+=e.byteLength});try{t.updating=!0;t.appendBuffer(n)}catch(e){if(this.mediaSource_.player_){this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}}},{key:"abort",value:function(){if(this.videoBuffer_){this.videoBuffer_.abort()}if(!this.audioDisabled_&&this.audioBuffer_){this.audioBuffer_.abort()}if(this.transmuxer_){this.transmuxer_.postMessage({action:"reset"})}this.pendingBuffers_.length=0;this.bufferUpdating_=!1}}]);return t}(mt.EventTarget),Oc=function(a){zp(n,a);function n(){Hp(this,n);var a=Gp(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),r=void 0;a.nativeMediaSource_=new e.MediaSource;for(r in a.nativeMediaSource_){if(!(r in n.prototype)&&"function"==typeof a.nativeMediaSource_[r]){a[r]=a.nativeMediaSource_[r].bind(a.nativeMediaSource_)}}a.duration_=NaN;Object.defineProperty(a,"duration",{get:function(){if(this.duration_===1/0){return this.duration_}return this.nativeMediaSource_.duration},set:function(e){this.duration_=e;if(e!==1/0){this.nativeMediaSource_.duration=e}}});Object.defineProperty(a,"seekable",{get:function(){if(this.duration_===1/0){return mt.createTimeRanges([[0,this.nativeMediaSource_.duration]])}return this.nativeMediaSource_.seekable}});Object.defineProperty(a,"readyState",{get:function(){return this.nativeMediaSource_.readyState}});Object.defineProperty(a,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}});a.sourceBuffers=[];a.activeSourceBuffers_=[];a.updateActiveSourceBuffers_=function(){a.activeSourceBuffers_.length=0;if(1===a.sourceBuffers.length){var e=a.sourceBuffers[0];e.appendAudioInitSegment_=!0;e.audioDisabled_=!e.audioCodec_;a.activeSourceBuffers_.push(e);return}for(var t=!1,n=!0,r=0,s;r<a.player_.audioTracks().length;r++){s=a.player_.audioTracks()[r];if(s.enabled&&"main"!==s.kind){t=!0;n=!1;break}}a.sourceBuffers.forEach(function(e,r){e.appendAudioInitSegment_=!0;if(e.videoCodec_&&e.audioCodec_){e.audioDisabled_=t}else if(e.videoCodec_&&!e.audioCodec_){e.audioDisabled_=!0;n=!1}else if(!e.videoCodec_&&e.audioCodec_){e.audioDisabled_=r?n:!n;if(e.audioDisabled_){return}}a.activeSourceBuffers_.push(e)})};a.onPlayerMediachange_=function(){a.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=!0})};a.onHlsReset_=function(){a.sourceBuffers.forEach(function(e){if(e.transmuxer_){e.transmuxer_.postMessage({action:"resetCaptions"})}})};a.onHlsSegmentTimeMapping_=function(e){a.sourceBuffers.forEach(function(t){return t.timeMapping_=e.mapping})};["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},a);a.on("sourceopen",function(){var e=t.querySelector("[src=\""+a.url_+"\"]");if(!e){return}a.player_=mt(e.parentNode);if(!a.player_){return}a.player_.tech_.on("hls-reset",a.onHlsReset_);a.player_.tech_.on("hls-segment-time-mapping",a.onHlsSegmentTimeMapping_);if(a.player_.audioTracks&&a.player_.audioTracks()){a.player_.audioTracks().on("change",a.updateActiveSourceBuffers_);a.player_.audioTracks().on("addtrack",a.updateActiveSourceBuffers_);a.player_.audioTracks().on("removetrack",a.updateActiveSourceBuffers_)}a.player_.on("mediachange",a.onPlayerMediachange_)});a.on("sourceended",function(){for(var e=nc(a.duration),t=0;t<a.sourceBuffers.length;t++){var n=a.sourceBuffers[t],r=n.metadataTrack_&&n.metadataTrack_.cues;if(r&&r.length){r[r.length-1].endTime=e}}});a.on("sourceclose",function(){this.sourceBuffers.forEach(function(e){if(e.transmuxer_){e.transmuxer_.terminate()}});this.sourceBuffers.length=0;if(!this.player_){return}if(this.player_.audioTracks&&this.player_.audioTracks()){this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_);this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_);this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)}if(this.player_.el_){this.player_.off("mediachange",this.onPlayerMediachange_)}if(this.player_.tech_&&this.player_.tech_.el_){this.player_.tech_.off("hls-reset",this.onHlsReset_);this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)}});return a}Vp(n,[{key:"addSeekableRange_",value:function(e,t){var a;if(this.duration!==1/0){a=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity");a.name="InvalidStateError";a.code=11;throw a}if(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration)){this.nativeMediaSource_.duration=t}}},{key:"addSourceBuffer",value:function(e){var t=void 0,a=kc(e);if(/^(video|audio)\/mp2t$/i.test(a.type)){var n=[];if(a.parameters&&a.parameters.codecs){n=a.parameters.codecs.split(",");n=hc(n);n=n.filter(function(e){return Cc(e)||Ec(e)})}if(0===n.length){n=["avc1.4d400d","mp4a.40.2"]}t=new wc(this,n);if(0!==this.sourceBuffers.length){this.sourceBuffers[0].createRealSourceBuffers_();t.createRealSourceBuffers_();this.sourceBuffers[0].audioDisabled_=!0}}else{t=this.nativeMediaSource_.addSourceBuffer(e)}this.sourceBuffers.push(t);return t}}]);return n}(mt.EventTarget),Uc=0;mt.mediaSources={};var Rc=function(e,t){var a=mt.mediaSources[e];if(a){a.trigger({type:"sourceopen",swfId:t})}else{throw new Error("Media Source not found (Video.js)")}},Mc=function(){return!!e.MediaSource&&!!e.MediaSource.isTypeSupported&&e.MediaSource.isTypeSupported("video/mp4;codecs=\"avc1.4d400d,mp4a.40.2\"")},Bc=function(){this.MediaSource={open:Rc,supportsNativeMediaSources:Mc};if(Mc()){return new Oc}throw new Error("Cannot use create a virtual MediaSource for this video")};Bc.open=Rc;Bc.supportsNativeMediaSources=Mc;var Nc={createObjectURL:function(t){var a=void 0;if(t instanceof Oc){a=e.URL.createObjectURL(t.nativeMediaSource_);t.url_=a;return a}if(!(t instanceof Oc)){a=e.URL.createObjectURL(t);t.url_=a;return a}a="blob:vjs-media-source/"+Uc;Uc++;mt.mediaSources[a]=t;return a}};mt.MediaSource=Bc;mt.URL=Nc;var jc=mt.EventTarget,Fc=mt.mergeOptions,Hc=function(e,t){for(var a=void 0,n=Fc(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),r=0,s;r<t.playlists.length;r++){s=Zp(n,t.playlists[r]);if(s){n=s}else{a=!0}}$p(t,function(e,t,r,i){if(e.playlists&&e.playlists.length){var s=e.playlists[0].uri,o=Zp(n,e.playlists[0]);if(o){n=o;n.mediaGroups[t][r][i].playlists[0]=n.playlists[s];a=!1}}});if(a){return null}return n},Vc=function(t){zp(a,t);function a(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},r=arguments[3];Hp(this,a);var i=Gp(this,(a.__proto__||Object.getPrototypeOf(a)).call(this)),s=n.withCredentials,o=s===void 0?!1:s,d=n.handleManifestRedirects,l=d===void 0?!1:d;i.hls_=t;i.withCredentials=o;i.handleManifestRedirects=l;if(!e){throw new Error("A non-empty playlist URL or playlist is required")}i.on("minimumUpdatePeriod",function(){i.refreshXml_()});i.on("mediaupdatetimeout",function(){i.refreshMedia_()});i.state="HAVE_NOTHING";i.loadedPlaylists_={};if("string"==typeof e){i.srcUrl=e;return Gp(i)}i.setupChildLoader(r,e);return i}Vp(a,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e;this.childPlaylist_=t}},{key:"dispose",value:function(){this.stopRequest();this.loadedPlaylists_={};e.clearTimeout(this.mediaUpdateTimeout)}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null;e.onreadystatechange=null;e.abort()}}},{key:"media",value:function(t){if(!t){return this.media_}if("HAVE_NOTHING"===this.state){throw new Error("Cannot switch media playlist from "+this.state)}var a=this.state;if("string"==typeof t){if(!this.master.playlists[t]){throw new Error("Unknown playlist URI: "+t)}t=this.master.playlists[t]}var n=!this.media_||t.uri!==this.media_.uri;if(n&&this.loadedPlaylists_[t.uri]&&this.loadedPlaylists_[t.uri].endList){this.state="HAVE_METADATA";this.media_=t;if(n){this.trigger("mediachanging");this.trigger("mediachange")}return}if(!n){return}if(this.media_){this.trigger("mediachanging")}this.mediaRequest_=e.setTimeout(this.haveMetadata.bind(this,{startingState:a,playlist:t}),0)}},{key:"haveMetadata",value:function(e){var t=e.startingState,a=e.playlist;this.state="HAVE_METADATA";this.media_=a;this.loadedPlaylists_[a.uri]=a;this.mediaRequest_=null;this.refreshMedia_();if("HAVE_MASTER"===t){this.trigger("loadedmetadata")}else{this.trigger("mediachange")}}},{key:"pause",value:function(){this.stopRequest();e.clearTimeout(this.mediaUpdateTimeout);if("HAVE_NOTHING"===this.state){this.started=!1}}},{key:"load",value:function(t){var a=this;e.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(t){var r=n?1e3*(n.targetDuration/2):5000;this.mediaUpdateTimeout=e.setTimeout(function(){return a.load()},r);return}if(!this.started){this.start();return}this.trigger("loadedplaylist")}},{key:"parseMasterXml",value:function(){var e=vo(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_});e.uri=this.srcUrl;for(var t=0,a;t<e.playlists.length;t++){a="placeholder-uri-"+t;e.playlists[t].uri=a;e.playlists[a]=e.playlists[t]}$p(e,function(t,a,n,r){if(t.playlists&&t.playlists.length){var i="placeholder-uri-"+a+"-"+n+"-"+r;t.playlists[0].uri=i;e.playlists[i]=t.playlists[0]}});eu(e);tu(e);return e}},{key:"start",value:function(){var t=this;this.started=!0;if(this.masterPlaylistLoader_){this.mediaRequest_=e.setTimeout(this.haveMaster_.bind(this),0);return}this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,a){if(!t.request){return}t.request=null;if(e){t.error={status:a.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:a.responseText,code:2};if("HAVE_NOTHING"===t.state){t.started=!1}return t.trigger("error")}t.masterXml_=a.responseText;if(a.responseHeaders&&a.responseHeaders.date){t.masterLoaded_=Date.parse(a.responseHeaders.date)}else{t.masterLoaded_=Date.now()}t.srcUrl=Fp(t.handleManifestRedirects,t.srcUrl,a);t.syncClientServerClock_(t.onClientServerClockSync_.bind(t))})}},{key:"syncClientServerClock_",value:function(e){var t=this,a=So(this.masterXml_);if(null===a){this.clientOffset_=this.masterLoaded_-Date.now();return e()}if("DIRECT"===a.method){this.clientOffset_=a.value-Date.now();return e()}this.request=this.hls_.xhr({uri:jp(this.srcUrl,a.value),method:a.method,withCredentials:this.withCredentials},function(n,r){if(!t.request){return}if(n){t.clientOffset_=t.masterLoaded_-Date.now();return e()}var i;if("HEAD"===a.method){if(!r.responseHeaders||!r.responseHeaders.date){i=t.masterLoaded_}else{i=Date.parse(r.responseHeaders.date)}}else{i=Date.parse(r.responseText)}t.clientOffset_=i-Date.now();e()})}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER";this.mediaRequest_=null;if(!this.masterPlaylistLoader_){this.master=this.parseMasterXml();this.trigger("loadedplaylist")}else if(!this.media_){this.media(this.childPlaylist_)}}},{key:"onClientServerClockSync_",value:function(){var t=this;this.haveMaster_();if(!this.hasPendingRequest()&&!this.media_){this.media(this.master.playlists[0])}if(this.master&&this.master.minimumUpdatePeriod){e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod)}}},{key:"refreshXml_",value:function(){var t=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(a,n){if(!t.request){return}t.request=null;if(a){t.error={status:n.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:n.responseText,code:2};if("HAVE_NOTHING"===t.state){t.started=!1}return t.trigger("error")}t.masterXml_=n.responseText;var r=t.parseMasterXml(),i=Hc(t.master,r);if(i){t.master=i}e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},t.master.minimumUpdatePeriod)})}},{key:"refreshMedia_",value:function(){var t=this,a=void 0,n=void 0;if(this.masterPlaylistLoader_){a=this.masterPlaylistLoader_.master;n=this.masterPlaylistLoader_.parseMasterXml()}else{a=this.master;n=this.parseMasterXml()}var r=Hc(a,n);if(r){if(this.masterPlaylistLoader_){this.masterPlaylistLoader_.master=r}else{this.master=r}this.media_=r.playlists[this.media_.uri]}else{this.trigger("playlistunchanged")}if(!this.media().endList){this.mediaUpdateTimeout=e.setTimeout(function(){t.trigger("mediaupdatetimeout")},au(this.media(),!!r))}this.trigger("loadedplaylist")}}]);return a}(jc),qc=function(e){if(mt.log.debug){return mt.log.debug.bind(mt,"VHS:",e+" >")}return function(){}};function St(){}var zc=function(){function e(t,a,n,r){Hp(this,e);this.callbacks_=[];this.pendingCallback_=null;this.timestampOffset_=0;this.mediaSource=t;this.processedAppend_=!1;this.type_=n;this.mimeType_=a;this.logger_=qc("SourceUpdater["+n+"]["+a+"]");if("closed"===t.readyState){t.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,a,r))}else{this.createSourceBuffer_(a,r)}}Vp(e,[{key:"createSourceBuffer_",value:function(e,t){var a=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e);this.logger_("created SourceBuffer");if(t){t.trigger("sourcebufferadded");if(2>this.mediaSource.sourceBuffers.length){t.on("sourcebufferadded",function(){a.start_()});return}}this.start_()}},{key:"start_",value:function(){var e=this;this.started_=!0;this.onUpdateendCallback_=function(){var t=e.pendingCallback_;e.pendingCallback_=null;e.logger_("buffered ["+Qu(e.buffered())+"]");if(t){t()}e.runCallback_()};this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_);this.runCallback_()}},{key:"abort",value:function(e){var t=this;if(this.processedAppend_){this.queueCallback_(function(){t.sourceBuffer_.abort()},e)}}},{key:"appendBuffer",value:function(e,t){var a=this;this.processedAppend_=!0;this.queueCallback_(function(){if(e.videoSegmentTimingInfoCallback){a.sourceBuffer_.addEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback)}a.sourceBuffer_.appendBuffer(e.bytes)},function(){if(e.videoSegmentTimingInfoCallback){a.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback)}t()})}},{key:"buffered",value:function(){if(!this.sourceBuffer_){return mt.createTimeRanges()}return this.sourceBuffer_.buffered}},{key:"remove",value:function(e,t){var a=this,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:St;if(this.processedAppend_){this.queueCallback_(function(){a.logger_("remove ["+e+" => "+t+"]");a.sourceBuffer_.remove(e,t)},n)}}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==St}},{key:"timestampOffset",value:function(e){var t=this;if("undefined"!=typeof e){this.queueCallback_(function(){t.sourceBuffer_.timestampOffset=e});this.timestampOffset_=e}return this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]);this.runCallback_()}},{key:"runCallback_",value:function(){var e;if(!this.updating()&&this.callbacks_.length&&this.started_){e=this.callbacks_.shift();this.pendingCallback_=e[1];e[0]()}}},{key:"dispose",value:function(){this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_);if(this.sourceBuffer_&&"open"===this.mediaSource.readyState){this.sourceBuffer_.abort()}}}]);return e}(),Gc={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},Wc={FAILURE:2,TIMEOUT:-101,ABORTED:-102},Kc=function(e){var t=void 0,a=void 0;a=e.offset+e.length-1;t=e.offset;return"bytes="+t+"-"+a},Yc=function(e){var t={};if(e.byterange){t.Range=Kc(e.byterange)}return t},Xc=function(e){e.forEach(function(e){e.abort()})},$c=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}},Qc=function(e){var t=e.target,a=Date.now()-t.requestTime,n={bandwidth:1/0,bytesReceived:0,roundTripTime:a||0};n.bytesReceived=e.loaded;n.bandwidth=Math.floor(1e3*(8*(n.bytesReceived/n.roundTripTime)));return n},Jc=function(e,t){if(t.timedout){return{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:Wc.TIMEOUT,xhr:t}}if(t.aborted){return{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:Wc.ABORTED,xhr:t}}if(e){return{status:t.status,message:"HLS request errored at URL: "+t.uri,code:Wc.FAILURE,xhr:t}}return null},Zc=function(e,t){return function(a,n){var r=n.response,i=Jc(a,n);if(i){return t(i,e)}if(16!==r.byteLength){return t({status:n.status,message:"Invalid HLS key at URL: "+n.uri,code:Wc.FAILURE,xhr:n},e)}var s=new DataView(r);e.key.bytes=new Uint32Array([s.getUint32(0),s.getUint32(4),s.getUint32(8),s.getUint32(12)]);return t(null,e)}},em=function(e,t,a){return function(n,r){var i=r.response,s=Jc(n,r);if(s){return a(s,e)}if(0===i.byteLength){return a({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Wc.FAILURE,xhr:r},e)}e.map.bytes=new Uint8Array(r.response);if(!t.isInitialized()){t.init()}e.map.timescales=xo.timescale(e.map.bytes);e.map.videoTrackIds=xo.videoTrackIds(e.map.bytes);return a(null,e)}},tm=function(e,t,a){return function(n,r){var i=r.response,s=Jc(n,r),o=void 0;if(s){return a(s,e)}if(0===i.byteLength){return a({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Wc.FAILURE,xhr:r},e)}e.stats=$c(r);if(e.key){e.encryptedBytes=new Uint8Array(r.response)}else{e.bytes=new Uint8Array(r.response)}if(e.map&&e.map.bytes){if(!t.isInitialized()){t.init()}o=t.parse(e.bytes,e.map.videoTrackIds,e.map.timescales);if(o&&o.captions){e.captionStreams=o.captionStreams;e.fmp4Captions=o.captions}}return a(null,e)}},am=function(e,t,a){e.addEventListener("message",function n(r){if(r.data.source===t.requestId){e.removeEventListener("message",n);var i=r.data.decrypted;t.bytes=new Uint8Array(i.bytes,i.byteOffset,i.byteLength);return a(null,t)}});e.postMessage(Au({source:t.requestId,encrypted:t.encryptedBytes,key:t.key.bytes,iv:t.key.iv}),[t.encryptedBytes.buffer,t.key.bytes.buffer])},nm=function(e,t,a){var n=0,r=!1;return function(i,s){if(r){return}if(i){r=!0;Xc(e);return a(i,s)}n+=1;if(n===e.length){s.endOfAllRequests=Date.now();if(s.encryptedBytes){return am(t,s,a)}return a(null,s)}}},rm=function(e,t){return function(a){e.stats=mt.mergeOptions(e.stats,Qc(a));if(!e.stats.firstBytesReceivedAt&&e.stats.bytesReceived){e.stats.firstBytesReceivedAt=Date.now()}return t(a,e)}},im=function(e,t,a,n,r,i,s){var o=[],d=nm(o,a,s);if(r.key){var l=mt.mergeOptions(t,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),p=Zc(r,d),u=e(l,p);o.push(u)}if(r.map&&!r.map.bytes){var c=mt.mergeOptions(t,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:Yc(r.map)}),m=em(r,n,d),g=e(c,m);o.push(g)}var h=mt.mergeOptions(t,{uri:r.resolvedUri,responseType:"arraybuffer",headers:Yc(r)}),y=tm(r,n,d),_=e(h,y);_.addEventListener("progress",rm(r,i));o.push(_);return function(){return Xc(o)}},sm=function(t,a){var n;if(!t){return""}n=e.getComputedStyle(t);if(!n){return""}return n[a]},om=function(e,t){var a=e.slice();e.sort(function(e,n){var r=t(e,n);if(0===r){return a.indexOf(e)-a.indexOf(n)}return r})},dm=function(t,a){var n=void 0,r=void 0;if(t.attributes.BANDWIDTH){n=t.attributes.BANDWIDTH}n=n||e.Number.MAX_VALUE;if(a.attributes.BANDWIDTH){r=a.attributes.BANDWIDTH}r=r||e.Number.MAX_VALUE;return n-r},lm=function(t,a){var n=void 0,r=void 0;if(t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width){n=t.attributes.RESOLUTION.width}n=n||e.Number.MAX_VALUE;if(a.attributes.RESOLUTION&&a.attributes.RESOLUTION.width){r=a.attributes.RESOLUTION.width}r=r||e.Number.MAX_VALUE;if(n===r&&t.attributes.BANDWIDTH&&a.attributes.BANDWIDTH){return t.attributes.BANDWIDTH-a.attributes.BANDWIDTH}return n-r},pm=function(t,a,n,r,i){var s=t.playlists.map(function(t){var a=void 0,n=void 0,r=void 0;a=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width;n=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.height;r=t.attributes.BANDWIDTH;r=r||e.Number.MAX_VALUE;return{bandwidth:r,width:a,height:n,playlist:t}});om(s,function(e,t){return e.bandwidth-t.bandwidth});s=s.filter(function(e){return!Cu.isIncompatible(e.playlist)});var o=s.filter(function(e){return Cu.isEnabled(e.playlist)});if(!o.length){o=s.filter(function(e){return!Cu.isDisabled(e.playlist)})}var d=o.filter(function(e){return e.bandwidth*Gc.BANDWIDTH_VARIANCE<a}),l=d[d.length-1],p=d.filter(function(e){return e.bandwidth===l.bandwidth})[0];if(!1===i){var u=p||o[0]||s[0];return u?u.playlist:null}var c=d.filter(function(e){return e.width&&e.height});om(c,function(e,t){return e.width-t.width});var m=c.filter(function(e){return e.width===n&&e.height===r});l=m[m.length-1];var g=m.filter(function(e){return e.bandwidth===l.bandwidth})[0],h=void 0,y=void 0,_=void 0;if(!g){h=c.filter(function(e){return e.width>n||e.height>r});y=h.filter(function(e){return e.width===h[0].width&&e.height===h[0].height});l=y[y.length-1];_=y.filter(function(e){return e.bandwidth===l.bandwidth})[0]}var f=_||g||p||o[0]||s[0];return f?f.playlist:null},um=function(e){var t=e.master,a=e.currentTime,n=e.bandwidth,r=e.duration,i=e.segmentDuration,s=e.timeUntilRebuffer,o=e.currentTimeline,d=e.syncController,l=t.playlists.filter(function(e){return!Cu.isIncompatible(e)}),p=l.filter(Cu.isEnabled);if(!p.length){p=l.filter(function(e){return!Cu.isDisabled(e)})}var u=p.filter(Cu.hasAttribute.bind(null,"BANDWIDTH")),c=u.map(function(e){var t=d.getSyncPoint(e,r,o,a),l=t?1:2,p=Cu.estimateSegmentRequestTime(i,n,e);return{playlist:e,rebufferingImpact:p*l-s}}),m=c.filter(function(e){return 0>=e.rebufferingImpact});om(m,function(e,t){return dm(t.playlist,e.playlist)});if(m.length){return m[0]}om(c,function(e,t){return e.rebufferingImpact-t.rebufferingImpact});return c[0]||null},cm=function(e,t,a){for(var n in a){if(!e[n]){t.trigger({type:"usage",name:"hls-608"});var r=t.textTracks().getTrackById(n);if(r){e[n]=r}else{e[n]=t.addRemoteTextTrack({kind:"captions",id:n,label:n},!1).track}}}},mm=function(e){var t=e.inbandTextTracks,a=e.captionArray,n=e.timestampOffset;if(!a){return}var r=window.WebKitDataCue||window.VTTCue;a.forEach(function(e){var a=e.stream,i=e.startTime,s=e.endTime;if(!t[a]){return}i+=n;s+=n;t[a].addCue(new r(i,s,e.text))})},gm=function(e,t,a){if(!e||!t){return!1}var n=e.segments,r=a===n.length;return e.endList&&"open"===t.readyState&&r},hm=function(e){return"number"==typeof e&&isFinite(e)},ym=function(e,t,a){if("main"!==e||!t||!a){return null}if(!a.containsAudio&&!a.containsVideo){return"Neither audio nor video found in segment."}if(t.containsVideo&&!a.containsVideo){return"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest."}if(!t.containsVideo&&a.containsVideo){return"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest."}return null},_m=function(e,t,a){var n;if(e.length&&0<e.start(0)&&e.start(0)<t){n=e.start(0)}else{n=t-30}return Math.min(n,t-a)},fm=function(e){var t=e.segment,a=t.start,n=t.end,r=e.playlist,i=r.mediaSequence,s=r.id,o=r.segments,d=o===void 0?[]:o,l=e.mediaIndex,p=e.timeline;return["appending ["+l+"] of ["+i+", "+(i+d.length)+"] from playlist ["+s+"]","["+a+" => "+n+"] in timeline ["+p+"]"].join(" ")},bm=function(t){zp(a,t);function a(e){Hp(this,a);var t=Gp(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));if(!e){throw new TypeError("Initialization settings are required")}if("function"!=typeof e.currentTime){throw new TypeError("No currentTime getter specified")}if(!e.mediaSource){throw new TypeError("No MediaSource specified")}t.bandwidth=e.bandwidth;t.throughput={rate:0,count:0};t.roundTrip=NaN;t.resetStats_();t.mediaIndex=null;t.hasPlayed_=e.hasPlayed;t.currentTime_=e.currentTime;t.seekable_=e.seekable;t.seeking_=e.seeking;t.duration_=e.duration;t.mediaSource_=e.mediaSource;t.hls_=e.hls;t.loaderType_=e.loaderType;t.startingMedia_=void 0;t.segmentMetadataTrack_=e.segmentMetadataTrack;t.goalBufferLength_=e.goalBufferLength;t.sourceType_=e.sourceType;t.inbandTextTracks_=e.inbandTextTracks;t.state_="INIT";t.checkBufferTimeout_=null;t.error_=void 0;t.currentTimeline_=-1;t.pendingSegment_=null;t.mimeType_=null;t.sourceUpdater_=null;t.xhrOptions_=null;t.activeInitSegmentId_=null;t.initSegments_={};t.captionParser_=new mp;t.decrypter_=e.decrypter;t.syncController_=e.syncController;t.syncPoint_={segmentIndex:0,time:0};t.syncController_.on("syncinfoupdate",function(){return t.trigger("syncinfoupdate")});t.mediaSource_.addEventListener("sourceopen",function(){return t.ended_=!1});t.fetchAtBuffer_=!1;t.logger_=qc("SegmentLoader["+t.loaderType_+"]");Object.defineProperty(t,"state",{get:function(){return this.state_},set:function(e){if(e!==this.state_){this.logger_(this.state_+" -> "+e);this.state_=e}}});return t}Vp(a,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0;this.mediaRequests=0;this.mediaRequestsAborted=0;this.mediaRequestsTimedout=0;this.mediaRequestsErrored=0;this.mediaTransferDuration=0;this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED";this.pause();this.abort_();if(this.sourceUpdater_){this.sourceUpdater_.dispose()}this.resetStats_();this.captionParser_.reset()}},{key:"abort",value:function(){if("WAITING"!==this.state){if(this.pendingSegment_){this.pendingSegment_=null}return}this.abort_();this.state="READY";if(!this.paused()){this.monitorBuffer_()}}},{key:"abort_",value:function(){if(this.pendingSegment_){this.pendingSegment_.abortRequests()}this.pendingSegment_=null}},{key:"error",value:function(e){if("undefined"!=typeof e){this.error_=e}this.pendingSegment_=null;return this.error_}},{key:"endOfStream",value:function(){this.ended_=!0;this.pause();this.trigger("ended")}},{key:"buffered_",value:function(){if(!this.sourceUpdater_){return mt.createTimeRanges()}return this.sourceUpdater_.buffered()}},{key:"initSegment",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1;if(!e){return null}var a=wu(e),n=this.initSegments_[a];if(t&&!n&&e.bytes){this.initSegments_[a]=n={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}}return n||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){this.monitorBuffer_();if(!this.playlist_){return}this.syncController_.setDateTimeMapping(this.playlist_);if("INIT"===this.state&&this.couldBeginLoading_()){return this.init_()}if(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state){return}this.state="READY"}},{key:"init_",value:function(){this.state="READY";this.sourceUpdater_=new zc(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_);this.resetEverything();return this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(!e){return}var a=this.playlist_,n=this.pendingSegment_;this.playlist_=e;this.xhrOptions_=t;if(!this.hasPlayed_()){e.syncInfo={mediaSequence:e.mediaSequence,time:0}}var r=null;if(a){if(a.id){r=a.id}else if(a.uri){r=a.uri}}this.logger_("playlist update ["+r+" => "+(e.id||e.uri)+"]");this.trigger("syncinfoupdate");if("INIT"===this.state&&this.couldBeginLoading_()){return this.init_()}if(!a||a.uri!==e.uri){if(null!==this.mediaIndex){this.resyncLoader()}return}var i=e.mediaSequence-a.mediaSequence;this.logger_("live window shift ["+i+"]");if(null!==this.mediaIndex){this.mediaIndex-=i}if(n){n.mediaIndex-=i;if(0<=n.mediaIndex){n.segment=e.segments[n.mediaIndex]}}this.syncController_.saveExpiredSegmentInfo(a,e)}},{key:"pause",value:function(){if(this.checkBufferTimeout_){e.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=null}}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){if(this.mimeType_){return}this.mimeType_=e;this.sourceBufferEmitter_=t;if("INIT"===this.state&&this.couldBeginLoading_()){this.init_()}}},{key:"resetEverything",value:function(e){this.ended_=!1;this.resetLoader();this.remove(0,this.duration_(),e);this.captionParser_.clearAllCaptions();this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1;this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null;this.syncPoint_=null;this.abort()}},{key:"remove",value:function(e,t,a){if(this.sourceUpdater_){this.sourceUpdater_.remove(e,t,a)}tc(e,t,this.segmentMetadataTrack_);if(this.inbandTextTracks_){for(var n in this.inbandTextTracks_){tc(e,t,this.inbandTextTracks_[n])}}}},{key:"monitorBuffer_",value:function(){if(this.checkBufferTimeout_){e.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){if("READY"===this.state){this.fillBuffer_()}if(this.checkBufferTimeout_){e.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(this.sourceUpdater_.updating()){return}if(!this.syncPoint_){this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())}var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(!e){return}if(this.isEndOfStream_(e.mediaIndex)){this.endOfStream();return}if(e.mediaIndex===this.playlist_.segments.length-1&&"ended"===this.mediaSource_.readyState&&!this.seeking_()){return}if(e.timeline!==this.currentTimeline_||null!==e.startOfSegment&&e.startOfSegment<this.sourceUpdater_.timestampOffset()){this.syncController_.reset();e.timestampOffset=e.startOfSegment;this.captionParser_.clearAllCaptions()}this.loadSegment_(e)}},{key:"isEndOfStream_",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.playlist_;return gm(t,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,a,n,r,i){var s=0,o=void 0;if(e.length){s=e.end(e.length-1)}var d=Math.max(0,s-r);if(!t.segments.length){return null}if(d>=this.goalBufferLength_()){return null}if(!n&&1<=d){return null}if(null===i){a=this.getSyncSegmentCandidate_(t);return this.generateSegmentInfo_(t,a,null,!0)}if(null!==a){var l=t.segments[a];if(l&&l.end){o=l.end}else{o=s}return this.generateSegmentInfo_(t,a+1,o,!1)}if(this.fetchAtBuffer_){var p=Cu.getMediaInfoForTime(t,s,i.segmentIndex,i.time);a=p.mediaIndex;o=p.startTime}else{var u=Cu.getMediaInfoForTime(t,r,i.segmentIndex,i.time);a=u.mediaIndex;o=u.startTime}return this.generateSegmentInfo_(t,a,o,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_){return 0}var a=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});if(a.length){return a[Math.min(a.length-1,1)].segmentIndex}return Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,a,n){if(0>t||t>=e.segments.length){return null}var r=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:r.resolvedUri,mediaIndex:t,isSyncRequest:n,startOfSegment:a,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:r.timeline,duration:r.duration,segment:r}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH){return!1}if(1e3>Date.now()-(e.firstBytesReceivedAt||Date.now())){return!1}var t=this.currentTime_(),a=e.bandwidth,n=this.pendingSegment_.duration,r=Cu.estimateSegmentRequestTime(n,a,this.playlist_,e.bytesReceived),i=Ju(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(r<=i){return!1}var s=um({master:this.hls_.playlists.master,currentTime:t,bandwidth:a,duration:this.duration_(),segmentDuration:n,timeUntilRebuffer:i,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!s){return}var o=r-i-s.rebufferingImpact,d=.5;if(i<=Gu){d=1}if(!s.playlist||s.playlist.uri===this.playlist_.uri||o<d){return!1}this.bandwidth=s.playlist.attributes.BANDWIDTH*Gc.BANDWIDTH_VARIANCE+1;this.abort();this.trigger("earlyabort");return!0}},{key:"handleProgress_",value:function(e,t){if(!this.pendingSegment_||t.requestId!==this.pendingSegment_.requestId||this.abortRequestEarly_(t.stats)){return}this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING";this.pendingSegment_=e;this.trimBackBuffer_(e);e.abortRequests=im(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(){var e=_m(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);if(0<e){this.remove(0,e)}}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,a={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var n=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);a.key={resolvedUri:t.key.resolvedUri,iv:n}}if(t.map){a.map=this.initSegment(t.map)}return a}},{key:"segmentRequestFinished_",value:function(e,t){this.mediaRequests+=1;if(t.stats){this.mediaBytesTransferred+=t.stats.bytesReceived;this.mediaTransferDuration+=t.stats.roundTripTime}if(!this.pendingSegment_){this.mediaRequestsAborted+=1;return}if(t.requestId!==this.pendingSegment_.requestId){return}if(e){this.pendingSegment_=null;this.state="READY";if(e.code===Wc.ABORTED){this.mediaRequestsAborted+=1;return}this.pause();if(e.code===Wc.TIMEOUT){this.mediaRequestsTimedout+=1;this.bandwidth=1;this.roundTrip=NaN;this.trigger("bandwidthupdate");return}this.mediaRequestsErrored+=1;this.error(e);this.trigger("error");return}this.bandwidth=t.stats.bandwidth;this.roundTrip=t.stats.roundTripTime;if(t.map){t.map=this.initSegment(t.map,!0)}this.processSegmentResponse_(t)}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes;if(e.map){t.segment.map.bytes=e.map.bytes}t.endOfAllRequests=e.endOfAllRequests;if(e.fmp4Captions){cm(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams);mm({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0});this.captionParser_.clearParsedCaptions()}this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(!this.pendingSegment_){this.state="READY";return}var t=this.pendingSegment_,a=t.segment,n=this.syncController_.probeSegmentInfo(t);if("undefined"==typeof this.startingMedia_&&n&&(n.containsAudio||n.containsVideo)){this.startingMedia_={containsAudio:n.containsAudio,containsVideo:n.containsVideo}}var r=ym(this.loaderType_,this.startingMedia_,n);if(r){this.error({message:r,blacklistDuration:1/0});this.trigger("error");return}if(t.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}if(null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()){this.sourceUpdater_.timestampOffset(t.timestampOffset);this.trigger("timestampoffset")}var i=this.syncController_.mappingForTimeline(t.timeline);if(null!==i){this.trigger({type:"segmenttimemapping",mapping:i})}this.state="APPENDING";if(a.map){var s=wu(a.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==s){var o=this.initSegment(a.map);this.sourceUpdater_.appendBuffer({bytes:o.bytes},function(){e.activeInitSegmentId_=s})}}t.byteLength=t.bytes.byteLength;if("number"==typeof a.start&&"number"==typeof a.end){this.mediaSecondsLoaded+=a.end-a.start}else{this.mediaSecondsLoaded+=a.duration}this.logger_(fm(t));this.sourceUpdater_.appendBuffer({bytes:t.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,t.requestId)},this.handleUpdateEnd_.bind(this))}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(!this.pendingSegment_||e!==this.pendingSegment_.requestId){return}var a=this.pendingSegment_.segment;if(!a.videoTimingInfo){a.videoTimingInfo={}}a.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0;a.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation;a.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation;a.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_){this.state="READY";if(!this.paused()){this.monitorBuffer_()}return}var e=this.pendingSegment_,t=e.segment,a=null!==this.mediaIndex;this.pendingSegment_=null;this.recordThroughput_(e);this.addSegmentMetadataCue_(e);this.state="READY";this.mediaIndex=e.mediaIndex;this.fetchAtBuffer_=!0;this.currentTimeline_=e.timeline;this.trigger("syncinfoupdate");if(t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration){this.resetEverything();return}if(a){this.trigger("bandwidthupdate")}this.trigger("progress");if(this.isEndOfStream_(e.mediaIndex+1,e.playlist)){this.endOfStream()}if(!this.paused()){this.monitorBuffer_()}}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,a=Date.now()-e.endOfAllRequests+1,n=Math.floor(1e3*(8*(e.byteLength/a)));this.throughput.rate+=(n-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(t){if(!this.segmentMetadataTrack_){return}var a=t.segment,n=a.start,r=a.end;if(!hm(n)||!hm(r)){return}tc(n,r,this.segmentMetadataTrack_);var i=e.WebKitDataCue||e.VTTCue,s={custom:a.custom,dateTimeObject:a.dateTimeObject,dateTimeString:a.dateTimeString,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.uri,start:n,end:r},o=JSON.stringify(s),d=new i(n,r,o);d.value=s;this.segmentMetadataTrack_.addCue(d)}}]);return a}(mt.EventTarget),Tm=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},vm=new Uint8Array(["\n","\n"].map(function(e){return e.charCodeAt(0)})),Sm=function(t){zp(a,t);function a(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};Hp(this,a);var n=Gp(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t));n.mediaSource_=null;n.subtitlesTrack_=null;return n}Vp(a,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length){return mt.createTimeRanges()}var e=this.subtitlesTrack_.cues,t=e[0].startTime,a=e[e.length-1].startTime;return mt.createTimeRanges([[t,a]])}},{key:"initSegment",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1;if(!e){return null}var a=wu(e),n=this.initSegments_[a];if(t&&!n&&e.bytes){var r=vm.byteLength+e.bytes.byteLength,i=new Uint8Array(r);i.set(e.bytes);i.set(vm,e.bytes.byteLength);this.initSegments_[a]=n={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:i}}return n||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){this.state="READY";this.resetEverything();return this.monitorBuffer_()}},{key:"track",value:function(e){if("undefined"==typeof e){return this.subtitlesTrack_}this.subtitlesTrack_=e;if("INIT"===this.state&&this.couldBeginLoading_()){this.init_()}return this.subtitlesTrack_}},{key:"remove",value:function(e,t){tc(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;if(!this.syncPoint_){this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())}var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);t=this.skipEmptySegments_(t);if(!t){return}if(null===this.syncController_.timestampOffsetForTimeline(t.timeline)){var a=function(){e.state="READY";if(!e.paused()){e.monitorBuffer_()}};this.syncController_.one("timestampoffset",a);this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(t)}},{key:"skipEmptySegments_",value:function(e){while(e&&e.segment.empty){e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest)}return e}},{key:"handleSegment_",value:function(){var t=this;if(!this.pendingSegment_||!this.subtitlesTrack_){this.state="READY";return}this.state="APPENDING";var a=this.pendingSegment_,n=a.segment;if("function"!=typeof e.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var r=function(){t.handleSegment_()};this.state="WAITING_ON_VTTJS";this.subtitlesTrack_.tech_.one("vttjsloaded",r);this.subtitlesTrack_.tech_.one("vttjserror",function(){t.subtitlesTrack_.tech_.off("vttjsloaded",r);t.error({message:"Error loading vtt.js"});t.state="READY";t.pause();t.trigger("error")});return}n.requested=!0;try{this.parseVTTCues_(a)}catch(t){this.error({message:t.message});this.state="READY";this.pause();return this.trigger("error")}this.updateTimeMapping_(a,this.syncController_.timelines[a.timeline],this.playlist_);if(a.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}a.byteLength=a.bytes.byteLength;this.mediaSecondsLoaded+=n.duration;if(a.cues.length){this.remove(a.cues[0].endTime,a.cues[a.cues.length-1].endTime)}a.cues.forEach(function(e){t.subtitlesTrack_.addCue(e)});this.handleUpdateEnd_()}},{key:"parseVTTCues_",value:function(t){var a=void 0,n=!1;if("function"==typeof e.TextDecoder){a=new e.TextDecoder("utf8")}else{a=e.WebVTT.StringDecoder();n=!0}var r=new e.WebVTT.Parser(e,e.vttjs,a);t.cues=[];t.timestampmap={MPEGTS:0,LOCAL:0};r.oncue=t.cues.push.bind(t.cues);r.ontimestampmap=function(e){return t.timestampmap=e};r.onparsingerror=function(e){mt.log.warn("Error encountered when parsing cues: "+e.message)};if(t.segment.map){var i=t.segment.map.bytes;if(n){i=Tm(i)}r.parse(i)}var s=t.bytes;if(n){s=Tm(s)}r.parse(s);r.flush()}},{key:"updateTimeMapping_",value:function(e,t,a){var n=e.segment;if(!t){return}if(!e.cues.length){n.empty=!0;return}var r=e.timestampmap,i=r.MPEGTS/9e4-r.LOCAL+t.mapping;e.cues.forEach(function(e){e.startTime+=i;e.endTime+=i});if(!a.syncInfo){var s=e.cues[0].startTime,o=e.cues[e.cues.length-1].startTime;a.syncInfo={mediaSequence:a.mediaSequence+e.mediaIndex,time:Math.min(s,o-n.duration)}}}}]);return a}(bm),km=function(e,t){for(var a=e.cues,n=0,r;n<a.length;n++){r=a[n];if(t>=r.adStartTime&&t<=r.adEndTime){return r}}return null},Cm=function(t,a){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if(!t.segments){return}for(var r=n,s=void 0,o=0,d;o<t.segments.length;o++){d=t.segments[o];if(!s){s=km(a,r+d.duration/2)}if(s){if("cueIn"in d){s.endTime=r;s.adEndTime=r;r+=d.duration;s=null;continue}if(r<s.endTime){r+=d.duration;continue}s.endTime+=d.duration}else{if("cueOut"in d){s=new e.VTTCue(r,r+d.duration,d.cueOut);s.adStartTime=r;s.adEndTime=r+parseFloat(d.cueOut);a.addCue(s)}if("cueOutCont"in d){var l=void 0,p=void 0,u=d.cueOutCont.split("/").map(parseFloat),c=Wp(u,2);l=c[0];p=c[1];s=new e.VTTCue(r,r+d.duration,"");s.adStartTime=r-l;s.adEndTime=s.adStartTime+p;a.addCue(s)}}r+=d.duration}},Em={inspect:function(e,t){var a=Tp.aac.isLikelyAacData(e),n;if(a){n=Ep(e)}else{n=Lp(e)}if(!n||!n.audio&&!n.video){return null}Cp(n,t);return n},parseAudioPes_:Sp}.inspect,Lm=[{name:"VOD",run:function(e,t,a){if(a!==1/0){return{time:0,segmentIndex:0}}return null}},{name:"ProgramDateTime",run:function(e,t,a,n,r){if(!e.datetimeToDisplayTime){return null}var s=t.segments||[],o=null,d=null;r=r||0;for(var l=0,p;l<s.length;l++){p=s[l];if(p.dateTimeObject){var u=p.dateTimeObject.getTime()/1e3,c=u+e.datetimeToDisplayTime,m=Math.abs(r-c);if(null!==d&&d<m){break}d=m;o={time:c,segmentIndex:l}}}return o}},{name:"Segment",run:function(e,t,a,n,r){var s=t.segments||[],o=null,d=null;r=r||0;for(var l=0,p;l<s.length;l++){p=s[l];if(p.timeline===n&&"undefined"!=typeof p.start){var u=Math.abs(r-p.start);if(null!==d&&d<u){break}if(!o||null===d||d>=u){d=u;o={time:p.start,segmentIndex:l}}}}return o}},{name:"Discontinuity",run:function(e,t,a,n,r){var s=null;r=r||0;if(t.discontinuityStarts&&t.discontinuityStarts.length){for(var o=null,d=0;d<t.discontinuityStarts.length;d++){var l=t.discontinuityStarts[d],p=t.discontinuitySequence+d+1,u=e.discontinuities[p];if(u){var c=Math.abs(r-u.time);if(null!==o&&o<c){break}if(!s||null===o||o>=c){o=c;s={time:u.time,segmentIndex:l}}}}}return s}},{name:"Playlist",run:function(e,t){if(t.syncInfo){var a={time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence};return a}return null}}],Im=function(e){zp(t,e);function t(){Hp(this,t);var e=Gp(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e.inspectCache_=void 0;e.timelines=[];e.discontinuities=[];e.datetimeToDisplayTime=null;e.logger_=qc("SyncController");return e}Vp(t,[{key:"getSyncPoint",value:function(e,t,a,n){var r=this.runStrategies_(e,t,a,n);if(!r.length){return null}return this.selectSyncPoint_(r,{key:"time",value:n})}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments){return null}var a=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!a.length){return null}var n=this.selectSyncPoint_(a,{key:"segmentIndex",value:0});if(0<n.segmentIndex){n.time*=-1}return Math.abs(n.time+lu(e,n.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,a,n){for(var r=[],s=0;s<Lm.length;s++){var o=Lm[s],d=o.run(this,e,t,a,n);if(d){d.strategy=o.name;r.push({strategy:o.name,syncPoint:d})}}return r}},{key:"selectSyncPoint_",value:function(e,t){for(var a=e[0].syncPoint,n=Math.abs(e[0].syncPoint[t.key]-t.value),r=e[0].strategy,s=1,o;s<e.length;s++){o=Math.abs(e[s].syncPoint[t.key]-t.value);if(o<n){n=o;a=e[s].syncPoint;r=e[s].strategy}}this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy"+(" ["+r+"]: [time:"+a.time+",")+(" segmentIndex:"+a.segmentIndex+"]"));return a}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var a=t.mediaSequence-e.mediaSequence,n=a-1,r;0<=n;n--){r=e.segments[n];if(r&&"undefined"!=typeof r.start){t.syncInfo={mediaSequence:e.mediaSequence+n,time:r.start};this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+","+(" mediaSequence: "+t.syncInfo.mediaSequence+"]"));this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.segment,a=e.playlist,n=void 0;if(t.map){n=this.probeMp4Segment_(e)}else{n=this.probeTsSegment_(e)}if(n){if(this.calculateSegmentTimeMapping_(e,n)){this.saveDiscontinuitySyncInfo_(e);if(!a.syncInfo){a.syncInfo={mediaSequence:a.mediaSequence+e.mediaIndex,time:t.start}}}}return n}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,a=xo.timescale(t.map.bytes),n=xo.startTime(a,e.bytes);if(null!==e.timestampOffset){e.timestampOffset-=n}return{start:n,end:n+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=Em(e.bytes,this.inspectCache_),a=void 0,n=void 0;if(!t){return null}if(t.video&&2===t.video.length){this.inspectCache_=t.video[1].dts;a=t.video[0].dtsTime;n=t.video[1].dtsTime}else if(t.audio&&2===t.audio.length){this.inspectCache_=t.audio[1].dts;a=t.audio[0].dtsTime;n=t.audio[1].dtsTime}var r={start:a,end:n,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length};return r}},{key:"timestampOffsetForTimeline",value:function(e){if("undefined"==typeof this.timelines[e]){return null}return this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){if("undefined"==typeof this.timelines[e]){return null}return this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var a=e.segment,n=this.timelines[e.timeline];if(null!==e.timestampOffset){n={time:e.startOfSegment,mapping:e.startOfSegment-t.start};this.timelines[e.timeline]=n;this.trigger("timestampoffset");this.logger_("time mapping for timeline "+e.timeline+": "+("[time: "+n.time+"] [mapping: "+n.mapping+"]"));a.start=e.startOfSegment;a.end=t.end+n.mapping}else if(n){a.start=t.start+n.mapping;a.end=t.end+n.mapping}else{return!1}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,a=e.segment;if(a.discontinuity){this.discontinuities[a.timeline]={time:a.start,accuracy:0}}else if(t.discontinuityStarts&&t.discontinuityStarts.length){for(var n=0;n<t.discontinuityStarts.length;n++){var r=t.discontinuityStarts[n],s=t.discontinuitySequence+n+1,o=r-e.mediaIndex,d=Math.abs(o);if(!this.discontinuities[s]||this.discontinuities[s].accuracy>d){var l=void 0;if(0>o){l=a.start-lu(t,e.mediaIndex,r)}else{l=a.end+lu(t,e.mediaIndex+1,r)}this.discontinuities[s]={time:l,accuracy:d}}}}}}]);return t}(mt.EventTarget),Pm=new bt("./decrypter-worker.worker.js",function(){var e=this,t=function(){function t(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var a=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}},n=function(){function e(e,t){for(var a=0,n;a<t.length;a++){n=t[a];n.enumerable=n.enumerable||!1;n.configurable=!0;if("value"in n)n.writable=!0;Object.defineProperty(e,n.key,n)}}return function(t,a,n){if(a)e(t.prototype,a);if(n)e(t,n);return t}}(),r=function(e,t){if("function"!=typeof t&&null!==t){throw new TypeError("Super expression must either be null or a function, not "+_typeof(t))}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t},i=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&("object"===_typeof(t)||"function"==typeof t)?t:e},s=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],a=e[1],n=t[4],r=a[4],o=void 0,l=void 0,p=void 0,u=[],d=[],c=void 0,m=void 0,g=void 0,h=void 0,y=void 0,_=void 0;for(o=0;256>o;o++){d[(u[o]=o<<1^283*(o>>7))^o]=o}for(l=p=0;!n[l];l^=c||1,p=d[p]||1){h=p^p<<1^p<<2^p<<3^p<<4;h=99^(h>>8^255&h);n[l]=h;r[h]=l;g=u[m=u[c=u[l]]];_=16843009*g^65537*m^257*c^16843008*l;y=257*u[h]^16843008*h;for(o=0;4>o;o++){t[o][l]=y=y<<24^y>>>8;a[o][h]=_=_<<24^_>>>8}}for(o=0;5>o;o++){t[o]=t[o].slice(0);a[o]=a[o].slice(0)}return e},o=null,d=function(){function e(t){a(this,e);if(!o){o=s()}this._tables=[[o[0][0].slice(),o[0][1].slice(),o[0][2].slice(),o[0][3].slice(),o[0][4].slice()],[o[1][0].slice(),o[1][1].slice(),o[1][2].slice(),o[1][3].slice(),o[1][4].slice()]];var n=void 0,r=void 0,d=void 0,l=void 0,p=void 0,u=this._tables[0][4],c=this._tables[1],m=t.length,g=1;if(4!==m&&6!==m&&8!==m){throw new Error("Invalid aes key size")}l=t.slice(0);p=[];this._key=[l,p];for(n=m;n<4*m+28;n++){d=l[n-1];if(0==n%m||8===m&&4==n%m){d=u[d>>>24]<<24^u[255&d>>16]<<16^u[255&d>>8]<<8^u[255&d];if(0==n%m){d=d<<8^d>>>24^g<<24;g=g<<1^283*(g>>7)}}l[n]=l[n-m]^d}for(r=0;n;r++,n--){d=l[3&r?n:n-4];if(4>=n||4>r){p[r]=d}else{p[r]=c[0][u[d>>>24]]^c[1][u[255&d>>16]]^c[2][u[255&d>>8]]^c[3][u[255&d]]}}}e.prototype.decrypt=function(e,t,n,r,s,o){var l=this._key[1],p=e^l[0],u=r^l[1],m=n^l[2],g=t^l[3],h=void 0,y=void 0,_=void 0,f=l.length/4-2,T=void 0,v=4,S=this._tables[1],k=S[0],C=S[1],E=S[2],L=S[3],I=S[4];for(T=0;T<f;T++){h=k[p>>>24]^C[255&u>>16]^E[255&m>>8]^L[255&g]^l[v];y=k[u>>>24]^C[255&m>>16]^E[255&g>>8]^L[255&p]^l[v+1];_=k[m>>>24]^C[255&g>>16]^E[255&p>>8]^L[255&u]^l[v+2];g=k[g>>>24]^C[255&p>>16]^E[255&u>>8]^L[255&m]^l[v+3];v+=4;p=h;u=y;m=_}for(T=0;4>T;T++){s[(3&-T)+o]=I[p>>>24]<<24^I[255&u>>16]<<16^I[255&m>>8]<<8^I[255&g]^l[v++];h=p;p=u;u=m;m=g;g=h}};return e}(),l=function(){function e(){a(this,e);this.listeners={}}e.prototype.on=function(e,t){if(!this.listeners[e]){this.listeners[e]=[]}this.listeners[e].push(t)};e.prototype.off=function(e,t){if(!this.listeners[e]){return!1}var a=this.listeners[e].indexOf(t);this.listeners[e].splice(a,1);return-1<a};e.prototype.trigger=function(e){var t=this.listeners[e];if(!t){return}if(2===arguments.length){for(var a=t.length,n=0;n<a;++n){t[n].call(this,arguments[1])}}else{for(var r=Array.prototype.slice.call(arguments,1),s=t.length,o=0;o<s;++o){t[o].apply(this,r)}}};e.prototype.dispose=function(){this.listeners={}};e.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})};return e}(),p=function(e){r(t,e);function t(){a(this,t);var n=i(this,e.call(this,l));n.jobs=[];n.delay=1;n.timeout_=null;return n}t.prototype.processJob_=function(){this.jobs.shift()();if(this.jobs.length){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}else{this.timeout_=null}};t.prototype.push=function(e){this.jobs.push(e);if(!this.timeout_){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}};return t}(l),u=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},c=function(e,t,a){var n=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),r=new d(Array.prototype.slice.call(t)),i=new Uint8Array(e.byteLength),s=new Int32Array(i.buffer),o=void 0,l=void 0,p=void 0,c=void 0,m=void 0,g=void 0,h=void 0,y=void 0,_=void 0;o=a[0];l=a[1];p=a[2];c=a[3];for(_=0;_<n.length;_+=4){m=u(n[_]);g=u(n[_+1]);h=u(n[_+2]);y=u(n[_+3]);r.decrypt(m,g,h,y,s,_);s[_]=u(s[_]^o);s[_+1]=u(s[_+1]^l);s[_+2]=u(s[_+2]^p);s[_+3]=u(s[_+3]^c);o=m;l=g;p=h;c=y}return i},m=function(){function e(n,r,s,o){a(this,e);var d=e.STEP,l=new Int32Array(n.buffer),c=new Uint8Array(n.byteLength),m=0;this.asyncStream_=new p;this.asyncStream_.push(this.decryptChunk_(l.subarray(m,m+d),r,s,c));for(m=d;m<l.length;m+=d){s=new Uint32Array([u(l[m-4]),u(l[m-3]),u(l[m-2]),u(l[m-1])]);this.asyncStream_.push(this.decryptChunk_(l.subarray(m,m+d),r,s,c))}this.asyncStream_.push(function(){o(null,t(c))})}e.prototype.decryptChunk_=function(e,t,a,n){return function(){var r=c(e,t,a);n.set(r,e.byteOffset)}};n(e,null,[{key:"STEP",get:function(){return 32e3}}]);return e}(),g=function(e){var t={};Object.keys(e).forEach(function(a){var n=e[a];if(ArrayBuffer.isView(n)){t[a]={bytes:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength}}else{t[a]=n}});return t},h=new function(e){e.onmessage=function(t){var a=t.data,n=new Uint8Array(a.encrypted.bytes,a.encrypted.byteOffset,a.encrypted.byteLength),r=new Uint32Array(a.key.bytes,a.key.byteOffset,a.key.byteLength/4),i=new Uint32Array(a.iv.bytes,a.iv.byteOffset,a.iv.byteLength/4);new m(n,r,i,function(t,n){e.postMessage(g({source:a.source,decrypted:n}),[n.buffer])})}}(e);return h}()}),xm=function(e){var t=e.default?"main":"alternative";if(e.characteristics&&0<=e.characteristics.indexOf("public.accessibility.describes-video")){t="main-desc"}return t},Dm=function(e,t){e.abort();e.pause();if(t&&t.activePlaylistLoader){t.activePlaylistLoader.pause();t.activePlaylistLoader=null}},Am=function(e,t){t.activePlaylistLoader=e;e.load()},wm=function(e,t){return function(){var a=t.segmentLoaders,n=a[e],r=a.main,i=t.mediaTypes[e],s=i.activeTrack(),o=i.activeGroup(s),d=i.activePlaylistLoader;Dm(n,i);if(!o){return}if(!o.playlistLoader){if(d){r.resetEverything()}return}n.resyncLoader();Am(o.playlistLoader,i)}},Om=function(e,t){return function(){var a=t.segmentLoaders,n=a[e],r=a.main,i=t.mediaTypes[e],s=i.activeTrack(),o=i.activeGroup(s),d=i.activePlaylistLoader;Dm(n,i);if(!o){return}if(!o.playlistLoader){r.resetEverything();return}if(d===o.playlistLoader){Am(o.playlistLoader,i);return}if(n.track){n.track(s)}n.resetEverything();Am(o.playlistLoader,i)}},Um={AUDIO:function(e,t){return function(){var a=t.segmentLoaders[e],n=t.mediaTypes[e],r=t.blacklistCurrentPlaylist;Dm(a,n);var i=n.activeTrack(),s=n.activeGroup(),o=(s.filter(function(e){return e.default})[0]||s[0]).id,d=n.tracks[o];if(i===d){r({message:"Problem encountered loading the default audio track."});return}mt.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(var l in n.tracks){n.tracks[l].enabled=n.tracks[l]===d}n.onTrackChanged()}},SUBTITLES:function(e,t){return function(){var a=t.segmentLoaders[e],n=t.mediaTypes[e];mt.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");Dm(a,n);var r=n.activeTrack();if(r){r.mode="disabled"}n.onTrackChanged()}}},Rm={AUDIO:function(e,t,a){if(!t){return}var n=a.tech,r=a.requestOptions,i=a.segmentLoaders[e];t.on("loadedmetadata",function(){var e=t.media();i.playlist(e,r);if(!n.paused()||e.endList&&"none"!==n.preload()){i.load()}});t.on("loadedplaylist",function(){i.playlist(t.media(),r);if(!n.paused()){i.load()}});t.on("error",Um[e](e,a))},SUBTITLES:function(e,t,a){var n=a.tech,r=a.requestOptions,i=a.segmentLoaders[e],s=a.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();i.playlist(e,r);i.track(s.activeTrack());if(!n.paused()||e.endList&&"none"!==n.preload()){i.load()}});t.on("loadedplaylist",function(){i.playlist(t.media(),r);if(!n.paused()){i.load()}});t.on("error",Um[e](e,a))}},Mm=function(e,t){return function(a){return a.attributes[e]===t}},Bm=function(e){return function(t){return t.resolvedUri===e}},Nm={AUDIO:function(e,t){var a=t.hls,n=t.sourceType,r=t.segmentLoaders[e],i=t.requestOptions,s=t.master,o=s.mediaGroups,d=s.playlists,l=t.mediaTypes[e],p=l.groups,u=l.tracks,c=t.masterPlaylistLoader;if(!o[e]||0===Object.keys(o[e]).length){o[e]={main:{default:{default:!0}}}}for(var m in o[e]){if(!p[m]){p[m]=[]}var g=d.filter(Mm(e,m));for(var h in o[e][m]){var y=o[e][m][h],_=g.filter(Bm(y.resolvedUri));if(_.length){delete y.resolvedUri}var f=void 0;if(y.resolvedUri){f=new nu(y.resolvedUri,a,i)}else if(y.playlists&&"dash"===n){f=new Vc(y.playlists[0],a,i,c)}else{f=null}y=mt.mergeOptions({id:h,playlistLoader:f},y);Rm[e](e,y.playlistLoader,t);p[m].push(y);if("undefined"==typeof u[h]){var b=new mt.AudioTrack({id:h,kind:xm(y),enabled:!1,language:y.language,default:y.default,label:h});u[h]=b}}}r.on("error",Um[e](e,t))},SUBTITLES:function(e,t){var a=t.tech,n=t.hls,r=t.sourceType,i=t.segmentLoaders[e],s=t.requestOptions,o=t.master.mediaGroups,d=t.mediaTypes[e],l=d.groups,p=d.tracks,u=t.masterPlaylistLoader;for(var c in o[e]){if(!l[c]){l[c]=[]}for(var m in o[e][c]){if(o[e][c][m].forced){continue}var g=o[e][c][m],h=void 0;if("hls"===r){h=new nu(g.resolvedUri,n,s)}else if("dash"===r){h=new Vc(g.playlists[0],n,s,u)}g=mt.mergeOptions({id:m,playlistLoader:h},g);Rm[e](e,g.playlistLoader,t);l[c].push(g);if("undefined"==typeof p[m]){var y=a.addRemoteTextTrack({id:m,kind:"subtitles",default:g.default&&g.autoselect,language:g.language,label:m},!1).track;p[m]=y}}}i.on("error",Um[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var a=t.tech,n=t.master.mediaGroups,r=t.mediaTypes[e],i=r.groups,s=r.tracks;for(var o in n[e]){if(!i[o]){i[o]=[]}for(var d in n[e][o]){var l=n[e][o][d];if(!l.instreamId.match(/CC\d/)){continue}i[o].push(mt.mergeOptions({id:d},l));if("undefined"==typeof s[d]){var p=a.addRemoteTextTrack({id:l.instreamId,kind:"captions",default:l.default&&l.autoselect,language:l.language,label:d},!1).track;s[d]=p}}}}},jm=function(e,t){return function(a){var n=t.masterPlaylistLoader,r=t.mediaTypes[e].groups,i=n.media();if(!i){return null}var s=null;if(i.attributes[e]){s=r[i.attributes[e]]}s=s||r.main;if("undefined"==typeof a){return s}if(null===a){return null}return s.filter(function(e){return e.id===a.id})[0]||null}},Fm={AUDIO:function(e,t){return function(){var a=t.mediaTypes[e].tracks;for(var n in a){if(a[n].enabled){return a[n]}}return null}},SUBTITLES:function(e,t){return function(){var a=t.mediaTypes[e].tracks;for(var n in a){if("showing"===a[n].mode){return a[n]}}return null}}},Hm=function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){Nm[t](t,e)});var t=e.mediaTypes,a=e.masterPlaylistLoader,n=e.tech,r=e.hls;["AUDIO","SUBTITLES"].forEach(function(a){t[a].activeGroup=jm(a,e);t[a].activeTrack=Fm[a](a,e);t[a].onGroupChanged=wm(a,e);t[a].onTrackChanged=Om(a,e)});var i=t.AUDIO.activeGroup(),s=(i.filter(function(e){return e.default})[0]||i[0]).id;t.AUDIO.tracks[s].enabled=!0;t.AUDIO.onTrackChanged();a.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return t[e].onGroupChanged()})});var o=function(){t.AUDIO.onTrackChanged();n.trigger({type:"usage",name:"hls-audio-change"})};n.audioTracks().addEventListener("change",o);n.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged);r.on("dispose",function(){n.audioTracks().removeEventListener("change",o);n.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)});n.clearTracks("audio");for(var d in t.AUDIO.tracks){n.audioTracks().addTrack(t.AUDIO.tracks[d])}},Vm=function(){var e={};["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:St,activeTrack:St,onGroupChanged:St,onTrackChanged:St}});return e},qm=void 0,zm=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],Gm=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},Wm=function(t){zp(a,t);function a(e){Hp(this,a);var t=Gp(this,(a.__proto__||Object.getPrototypeOf(a)).call(this)),n=e.url,r=e.handleManifestRedirects,i=e.withCredentials,s=e.tech,o=e.bandwidth,d=e.externHls,l=e.useCueTags,p=e.blacklistDuration,u=e.enableLowInitialPlaylist,c=e.sourceType,m=e.seekTo;if(!n){throw new Error("A non-empty playlist URL is required")}qm=d;t.withCredentials=i;t.tech_=s;t.hls_=s.hls;t.seekTo_=m;t.sourceType_=c;t.useCueTags_=l;t.blacklistDuration=p;t.enableLowInitialPlaylist=u;if(t.useCueTags_){t.cueTagsTrack_=t.tech_.addTextTrack("metadata","ad-cues");t.cueTagsTrack_.inBandMetadataTrackDispatchType=""}t.requestOptions_={withCredentials:i,handleManifestRedirects:r,timeout:null};t.mediaTypes_=Vm();t.mediaSource=new mt.MediaSource;t.mediaSource.addEventListener("sourceopen",t.handleSourceOpen_.bind(t));t.seekable_=mt.createTimeRanges();t.hasPlayed_=function(){return!1};t.syncController_=new Im(e);t.segmentMetadataTrack_=s.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track;t.decrypter_=new Pm;t.inbandTextTracks_={};var g={hls:t.hls_,mediaSource:t.mediaSource,currentTime:t.tech_.currentTime.bind(t.tech_),seekable:function(){return t.seekable()},seeking:function(){return t.tech_.seeking()},duration:function(){return t.mediaSource.duration},hasPlayed:function(){return t.hasPlayed_()},goalBufferLength:function(){return t.goalBufferLength()},bandwidth:o,syncController:t.syncController_,decrypter:t.decrypter_,sourceType:t.sourceType_,inbandTextTracks:t.inbandTextTracks_};t.masterPlaylistLoader_="dash"===t.sourceType_?new Vc(n,t.hls_,t.requestOptions_):new nu(n,t.hls_,t.requestOptions_);t.setupMasterPlaylistLoaderListeners_();t.mainSegmentLoader_=new bm(mt.mergeOptions(g,{segmentMetadataTrack:t.segmentMetadataTrack_,loaderType:"main"}),e);t.audioSegmentLoader_=new bm(mt.mergeOptions(g,{loaderType:"audio"}),e);t.subtitleSegmentLoader_=new Sm(mt.mergeOptions(g,{loaderType:"vtt"}),e);t.setupSegmentLoaderListeners_();zm.forEach(function(e){t[e+"_"]=Gm.bind(t,e)});t.logger_=qc("MPC");t.masterPlaylistLoader_.load();return t}Vp(a,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var t=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var e=t.masterPlaylistLoader_.media(),a=1e3*(1.5*e.targetDuration);if(ku(t.masterPlaylistLoader_.master,t.masterPlaylistLoader_.media())){t.requestOptions_.timeout=0}else{t.requestOptions_.timeout=a}if(e.endList&&"none"!==t.tech_.preload()){t.mainSegmentLoader_.playlist(e,t.requestOptions_);t.mainSegmentLoader_.load()}Hm({sourceType:t.sourceType_,segmentLoaders:{AUDIO:t.audioSegmentLoader_,SUBTITLES:t.subtitleSegmentLoader_,main:t.mainSegmentLoader_},tech:t.tech_,requestOptions:t.requestOptions_,masterPlaylistLoader:t.masterPlaylistLoader_,hls:t.hls_,master:t.master(),mediaTypes:t.mediaTypes_,blacklistCurrentPlaylist:t.blacklistCurrentPlaylist.bind(t)});t.triggerPresenceUsage_(t.master(),e);try{t.setupSourceBuffers_()}catch(a){mt.log.warn("Failed to create SourceBuffers",a);return t.mediaSource.endOfStream("decode")}t.setupFirstPlay();if(!t.mediaTypes_.AUDIO.activePlaylistLoader||t.mediaTypes_.AUDIO.activePlaylistLoader.media()){t.trigger("selectedinitialmedia")}else{t.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){t.trigger("selectedinitialmedia")})}});this.masterPlaylistLoader_.on("loadedplaylist",function(){var e=t.masterPlaylistLoader_.media();if(!e){t.excludeUnsupportedVariants_();var a;if(t.enableLowInitialPlaylist){a=t.selectInitialPlaylist()}if(!a){a=t.selectPlaylist()}t.initialMedia_=a;t.masterPlaylistLoader_.media(t.initialMedia_);return}if(t.useCueTags_){t.updateAdCues_(e)}t.mainSegmentLoader_.playlist(e,t.requestOptions_);t.updateDuration();if(!t.tech_.paused()){t.mainSegmentLoader_.load();if(t.audioSegmentLoader_){t.audioSegmentLoader_.load()}}if(!e.endList){var n=function(){var e=t.seekable();if(0!==e.length){t.mediaSource.addSeekableRange_(e.start(0),e.end(0))}};if(t.duration()!==1/0){var r=function e(){if(t.duration()===1/0){n()}else{t.tech_.one("durationchange",e)}};t.tech_.one("durationchange",r)}else{n()}}});this.masterPlaylistLoader_.on("error",function(){t.blacklistCurrentPlaylist(t.masterPlaylistLoader_.error)});this.masterPlaylistLoader_.on("mediachanging",function(){t.mainSegmentLoader_.abort();t.mainSegmentLoader_.pause()});this.masterPlaylistLoader_.on("mediachange",function(){var e=t.masterPlaylistLoader_.media(),a=1e3*(1.5*e.targetDuration);if(ku(t.masterPlaylistLoader_.master,t.masterPlaylistLoader_.media())){t.requestOptions_.timeout=0}else{t.requestOptions_.timeout=a}t.mainSegmentLoader_.playlist(e,t.requestOptions_);t.mainSegmentLoader_.load();t.tech_.trigger({type:"mediachange",bubbles:!0})});this.masterPlaylistLoader_.on("playlistunchanged",function(){var e=t.masterPlaylistLoader_.media(),a=t.stuckAtPlaylistEnd_(e);if(a){t.blacklistCurrentPlaylist({message:"Playlist no longer updating."});t.tech_.trigger("playliststuck")}});this.masterPlaylistLoader_.on("renditiondisabled",function(){t.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})});this.masterPlaylistLoader_.on("renditionenabled",function(){t.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(e,t){var a=e.mediaGroups||{},n=!0,r=Object.keys(a.AUDIO);for(var i in a.AUDIO){for(var s in a.AUDIO[i]){var o=a.AUDIO[i][s];if(!o.uri){n=!1}}}if(n){this.tech_.trigger({type:"usage",name:"hls-demuxed"})}if(Object.keys(a.SUBTITLES).length){this.tech_.trigger({type:"usage",name:"hls-webvtt"})}if(qm.Playlist.isAes(t)){this.tech_.trigger({type:"usage",name:"hls-aes"})}if(qm.Playlist.isFmp4(t)){this.tech_.trigger({type:"usage",name:"hls-fmp4"})}if(r.length&&1<Object.keys(a.AUDIO[r[0]]).length){this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})}if(this.useCueTags_){this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var t=e.selectPlaylist(),a=e.masterPlaylistLoader_.media(),n=e.tech_.buffered(),r=n.length?n.end(n.length-1)-e.tech_.currentTime():0,i=e.bufferLowWaterLine();if(!a.endList||e.duration()<Gc.MAX_BUFFER_LOW_WATER_LINE||t.attributes.BANDWIDTH<a.attributes.BANDWIDTH||r>=i){e.masterPlaylistLoader_.media(t)}e.tech_.trigger("bandwidthupdate")});this.mainSegmentLoader_.on("progress",function(){e.trigger("progress")});this.mainSegmentLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())});this.mainSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()});this.mainSegmentLoader_.on("timestampoffset",function(){e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})});this.audioSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()});this.mainSegmentLoader_.on("ended",function(){e.onEndOfStream()});this.mainSegmentLoader_.on("earlyabort",function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)});this.mainSegmentLoader_.on("reseteverything",function(){e.tech_.trigger("hls-reset")});this.mainSegmentLoader_.on("segmenttimemapping",function(t){e.tech_.trigger({type:"hls-segment-time-mapping",mapping:t.mapping})});this.audioSegmentLoader_.on("ended",function(){e.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.load()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.load()}}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();if(e!==this.masterPlaylistLoader_.media()){this.masterPlaylistLoader_.media(e);this.mainSegmentLoader_.resetLoader()}}},{key:"fastQualityChange_",value:function(){var e=this,t=this.selectPlaylist();if(t===this.masterPlaylistLoader_.media()){return}this.masterPlaylistLoader_.media(t);this.mainSegmentLoader_.resetEverything(function(){if(mt.browser.IE_VERSION||mt.browser.IS_EDGE){e.tech_.setCurrentTime(e.tech_.currentTime()+.04)}else{e.tech_.setCurrentTime(e.tech_.currentTime())}})}},{key:"play",value:function(){if(this.setupFirstPlay()){return}if(this.tech_.ended()){this.seekTo_(0)}if(this.hasPlayed_()){this.load()}var e=this.tech_.seekable();if(this.tech_.duration()===1/0){if(this.tech_.currentTime()<e.start(0)){return this.seekTo_(e.end(e.length-1))}}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_()){return!1}if(!t.endList){var a=this.seekable();if(!a.length){return!1}if(mt.browser.IE_VERSION&&0===this.tech_.readyState()){this.tech_.one("loadedmetadata",function(){e.trigger("firstplay");e.seekTo_(a.end(0));e.hasPlayed_=function(){return!0}});return!1}this.trigger("firstplay");this.seekTo_(a.end(0))}this.hasPlayed_=function(){return!0};this.load();return!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(t){mt.log.warn("Failed to create Source Buffers",t);return this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();if("undefined"!=typeof e&&"function"==typeof e.then){e.then(null,function(){})}}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo){e=e&&this.audioSegmentLoader_.ended_}else{e=this.audioSegmentLoader_.ended_}}if(!e){return}this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(t){mt.log.warn("Failed to call media source endOfStream",t)}}},{key:"stuckAtPlaylistEnd_",value:function(e){var t=this.seekable();if(!t.length){return!1}var a=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===a){return!1}var n=qm.Playlist.playlistEnd(e,a),r=this.tech_.currentTime(),i=this.tech_.buffered();if(!i.length){return n-r<=Wu}var s=i.end(i.length-1);return s-r<=Wu&&n-s<=Wu}},{key:"blacklistCurrentPlaylist",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},t=arguments[1],a=void 0,n=void 0;a=e.playlist||this.masterPlaylistLoader_.media();t=t||e.blacklistDuration||this.blacklistDuration;if(!a){this.error=e;try{return this.mediaSource.endOfStream("network")}catch(t){return this.trigger("error")}}var r=1===this.masterPlaylistLoader_.master.playlists.filter(bu).length;if(r){mt.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the final playlist.");this.tech_.trigger("retryplaylist");return this.masterPlaylistLoader_.load(r)}a.excludeUntil=Date.now()+1e3*t;this.tech_.trigger("blacklistplaylist");this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});n=this.selectPlaylist();mt.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist.");return this.masterPlaylistLoader_.media(n)}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.pause()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.pause()}}},{key:"setCurrentTime",value:function(e){var t=Yu(this.tech_.buffered(),e);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())){return 0}if(!this.masterPlaylistLoader_.media().segments){return 0}if(t&&t.length){return e}this.mainSegmentLoader_.resetEverything();this.mainSegmentLoader_.abort();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.resetEverything();this.audioSegmentLoader_.abort()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.resetEverything();this.subtitleSegmentLoader_.abort()}this.load()}},{key:"duration",value:function(){if(!this.masterPlaylistLoader_){return 0}if(this.mediaSource){return this.mediaSource.duration}return qm.Playlist.duration(this.masterPlaylistLoader_.media())}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0,t=void 0;if(!this.masterPlaylistLoader_){return}var a=this.masterPlaylistLoader_.media();if(!a){return}var n=this.syncController_.getExpiredTime(a,this.mediaSource.duration);if(null===n){return}e=qm.Playlist.seekable(a,n);if(0===e.length){return}if(this.mediaTypes_.AUDIO.activePlaylistLoader){a=this.mediaTypes_.AUDIO.activePlaylistLoader.media();n=this.syncController_.getExpiredTime(a,this.mediaSource.duration);if(null===n){return}t=qm.Playlist.seekable(a,n);if(0===t.length){return}}var r=void 0,i=void 0;if(this.seekable_&&this.seekable_.length){r=this.seekable_.end(0);i=this.seekable_.start(0)}if(!t){this.seekable_=e}else if(t.start(0)>e.end(0)||e.start(0)>t.end(0)){this.seekable_=e}else{this.seekable_=mt.createTimeRanges([[t.start(0)>e.start(0)?t.start(0):e.start(0),t.end(0)<e.end(0)?t.end(0):e.end(0)]])}if(this.seekable_&&this.seekable_.length){if(this.seekable_.end(0)===r&&this.seekable_.start(0)===i){return}}this.logger_("seekable updated ["+Qu(this.seekable_)+"]");this.tech_.trigger("seekablechanged")}},{key:"updateDuration",value:function(){var e=this,t=this.mediaSource.duration,a=qm.Playlist.duration(this.masterPlaylistLoader_.media()),n=this.tech_.buffered(),r=function t(){e.logger_("Setting duration from "+e.mediaSource.duration+" => "+a);try{e.mediaSource.duration=a}catch(t){mt.log.warn("Failed to set media source duration",t)}e.tech_.trigger("durationchange");e.mediaSource.removeEventListener("sourceopen",t)};if(0<n.length){a=Math.max(a,n.end(n.length-1))}if(t!==a){if("open"!==this.mediaSource.readyState){this.mediaSource.addEventListener("sourceopen",r)}else{r()}}}},{key:"dispose",value:function(){var e=this;this.decrypter_.terminate();this.masterPlaylistLoader_.dispose();this.mainSegmentLoader_.dispose();["AUDIO","SUBTITLES"].forEach(function(t){var a=e.mediaTypes_[t].groups;for(var n in a){a[n].forEach(function(e){if(e.playlistLoader){e.playlistLoader.dispose()}})}});this.audioSegmentLoader_.dispose();this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e=this.masterPlaylistLoader_.media(),t=void 0;if(!e||"open"!==this.mediaSource.readyState){return}t=Sc(this.masterPlaylistLoader_.master,e);if(1>t.length){this.error="No compatible SourceBuffer configuration for the variant stream:"+e.resolvedUri;return this.mediaSource.endOfStream("decode")}this.configureLoaderMimeTypes_(t);this.excludeIncompatibleVariants_(e)}},{key:"configureLoaderMimeTypes_",value:function(e){var t=1<e.length&&-1===e[0].indexOf(",")&&e[0]!==e[1]?new mt.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t);if(e[1]){this.audioSegmentLoader_.mimeType(e[1],t)}}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(t){if(t.attributes.CODECS&&e.MediaSource&&e.MediaSource.isTypeSupported&&!e.MediaSource.isTypeSupported("video/mp4; codecs=\""+_c(t.attributes.CODECS)+"\"")){t.excludeUntil=1/0}})}},{key:"excludeIncompatibleVariants_",value:function(e){var t=2,a=null,n=void 0;if(e.attributes.CODECS){n=yc(e.attributes.CODECS);a=n.videoCodec;t=n.codecCount}this.master().playlists.forEach(function(e){var n={codecCount:2,videoCodec:null};if(e.attributes.CODECS){n=yc(e.attributes.CODECS)}if(n.codecCount!==t){e.excludeUntil=1/0}if(n.videoCodec!==a){e.excludeUntil=1/0}})}},{key:"updateAdCues_",value:function(e){var t=0,a=this.seekable();if(a.length){t=a.start(0)}Cm(e,this.cueTagsTrack_,t)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=Gc.GOAL_BUFFER_LENGTH,a=Gc.GOAL_BUFFER_LENGTH_RATE,n=Math.max(t,Gc.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*a,n)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=Gc.BUFFER_LOW_WATER_LINE,a=Gc.BUFFER_LOW_WATER_LINE_RATE,n=Math.max(t,Gc.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*a,n)}}]);return a}(mt.EventTarget),Km=function(e,t,a){return function(n){var r=e.master.playlists[t],i=fu(r),s=bu(r);if("undefined"==typeof n){return s}if(n){delete r.disabled}else{r.disabled=!0}if(n!==s&&!i){a();if(n){e.trigger("renditionenabled")}else{e.trigger("renditiondisabled")}}return n}},Ym=function e(t,a,n){Hp(this,e);var r=t.masterPlaylistController_,i=t.options_.smoothQualityChange,s=i?"smooth":"fast",o=r[s+"QualityChange_"].bind(r);if(a.attributes.RESOLUTION){var d=a.attributes.RESOLUTION;this.width=d.width;this.height=d.height}this.bandwidth=a.attributes.BANDWIDTH;this.id=n;this.enabled=Km(t.playlists,a.uri,o)},Xm=function(t){var a=t.playlists;t.representations=function(){return a.master.playlists.filter(function(e){return!fu(e)}).map(function(a){return new Ym(t,a,a.uri)})}},$m=["seeking","seeked","pause","playing","error"],Qm=function(){function t(a){var n=this;Hp(this,t);this.tech_=a.tech;this.seekable=a.seekable;this.seekTo=a.seekTo;this.allowSeeksWithinUnsafeLiveWindow=a.allowSeeksWithinUnsafeLiveWindow;this.media=a.media;this.consecutiveUpdates=0;this.lastRecordedTime=null;this.timer_=null;this.checkCurrentTimeTimeout_=null;this.logger_=qc("PlaybackWatcher");this.logger_("initialize");var r=function(){return n.monitorCurrentTime_()},i=function(){return n.techWaiting_()},s=function(){return n.cancelTimer_()},o=function(){return n.fixesBadSeeks_()};this.tech_.on("seekablechanged",o);this.tech_.on("waiting",i);this.tech_.on($m,s);this.tech_.on("canplay",r);this.dispose=function(){n.logger_("dispose");n.tech_.off("seekablechanged",o);n.tech_.off("waiting",i);n.tech_.off($m,s);n.tech_.off("canplay",r);if(n.checkCurrentTimeTimeout_){e.clearTimeout(n.checkCurrentTimeTimeout_)}n.cancelTimer_()}}Vp(t,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_();if(this.checkCurrentTimeTimeout_){e.clearTimeout(this.checkCurrentTimeTimeout_)}this.checkCurrentTimeTimeout_=e.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_()){this.consecutiveUpdates=0;this.lastRecordedTime=this.tech_.currentTime();return}if(this.tech_.paused()||this.tech_.seeking()){return}var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+Wu>=t.end(t.length-1))){return this.techWaiting_()}if(5<=this.consecutiveUpdates&&e===this.lastRecordedTime){this.consecutiveUpdates++;this.waiting_()}else if(e===this.lastRecordedTime){this.consecutiveUpdates++}else{this.consecutiveUpdates=0;this.lastRecordedTime=e}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0;if(this.timer_){this.logger_("cancelTimer_");clearTimeout(this.timer_)}this.timer_=null}},{key:"fixesBadSeeks_",value:function(){var e=this.tech_.seeking();if(!e){return!1}var t=this.seekable(),a=this.tech_.currentTime(),n=this.afterSeekableWindow_(t,a,this.media(),this.allowSeeksWithinUnsafeLiveWindow),r=void 0;if(n){var i=t.end(t.length-1);r=i}if(this.beforeSeekableWindow_(t,a)){var s=t.start(0);r=s+Wu}if("undefined"!=typeof r){this.logger_("Trying to seek outside of seekable at time "+a+" with "+("seekable range "+Qu(t)+". Seeking to ")+(r+"."));this.seekTo(r);return!0}return!1}},{key:"waiting_",value:function(){if(this.techWaiting_()){return}var e=this.tech_.currentTime(),t=this.tech_.buffered(),a=Yu(t,e);if(a.length&&e+3<=a.end(0)){this.cancelTimer_();this.seekTo(e);this.logger_("Stopped at "+e+" while inside a buffered region "+("["+a.start(0)+" -> "+a.end(0)+"]. Attempting to resume playback by seeking to the current time."));this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_()){return!0}if(this.tech_.seeking()||null!==this.timer_){return!0}if(this.beforeSeekableWindow_(e,t)){var a=e.end(e.length-1);this.logger_("Fell out of live window at time "+t+". Seeking to "+("live point (seekable end) "+a));this.cancelTimer_();this.seekTo(a);this.tech_.trigger({type:"usage",name:"hls-live-resync"});return!0}var n=this.tech_.buffered(),r=Xu(n,t);if(this.videoUnderflow_(r,n,t)){this.cancelTimer_();this.seekTo(t);this.tech_.trigger({type:"usage",name:"hls-video-underflow"});return!0}if(0<r.length){var i=r.start(0)-t;this.logger_("Stopped at "+t+", setting timer for "+i+", seeking "+("to "+r.start(0)));this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*i,t);return!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t,a){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:!1;if(!e.length){return!1}var r=e.end(e.length-1)+Wu,i=!a.endList;if(i&&n){r=e.end(e.length-1)+3*a.targetDuration}if(t>r){return!0}return!1}},{key:"beforeSeekableWindow_",value:function(e,t){if(e.length&&0<e.start(0)&&t<e.start(0)-Wu){return!0}return!1}},{key:"videoUnderflow_",value:function(e,t,a){if(0===e.length){var n=this.gapFromVideoUnderflow_(t,a);if(n){this.logger_("Encountered a gap in video from "+n.start+" to "+n.end+". "+("Seeking to current time "+a));return!0}}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),a=this.tech_.currentTime(),n=Xu(t,a);this.cancelTimer_();if(0===n.length||a!==e){return}this.logger_("skipTheGap_:","currentTime:",a,"scheduled currentTime:",e,"nextRange start:",n.start(0));this.seekTo(n.start(0)+Gu);this.tech_.trigger({type:"usage",name:"hls-gap-skip"})}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var a=$u(e),n=0;n<a.length;n++){var r=a.start(n),s=a.end(n);if(4>t-r&&2<t-r){return{start:r,end:s}}}return null}}]);return t}(),Jm={errorInterval:30,getSource:function(e){var t=this.tech({IWillNotUseThisInPlugins:!0}),a=t.currentSource_;return e(a)}},Zm=function e(t,a){var n=0,r=0,i=mt.mergeOptions(Jm,a);t.ready(function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})});var s=function(){if(r){t.currentTime(r)}},o=function(e){if(null===e||e===void 0){return}r=t.duration()!==1/0&&t.currentTime()||0;t.one("loadedmetadata",s);t.src(e);t.trigger({type:"usage",name:"hls-error-reload"});t.play()},d=function(){if(Date.now()-n<1e3*i.errorInterval){t.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!i.getSource||"function"!=typeof i.getSource){mt.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}n=Date.now();return i.getSource.call(t,o)},l=function e(){t.off("loadedmetadata",s);t.off("error",d);t.off("dispose",e)};t.on("error",d);t.on("dispose",l);t.reloadSourceOnError=function(a){l();e(t,a)}},eg=function(e){Zm(this,e)};mt.use("*",function(e){return{setSource:function(e,t){t(null,e)},setCurrentTime:function(t){if(e.vhs&&e.currentSource().src===e.vhs.source_.src){e.vhs.setCurrentTime(t)}return t},play:function(){if(e.vhs&&e.currentSource().src===e.vhs.source_.src){e.vhs.setCurrentTime(e.tech_.currentTime())}}}});var tg={PlaylistLoader:nu,Playlist:Cu,Decrypter:Np,AsyncStream:Rp,decrypt:Bp,utils:Ru,STANDARD_PLAYLIST_SELECTOR:function(){return pm(this.playlists.master,this.systemBandwidth,parseInt(sm(this.tech_.el(),"width"),10),parseInt(sm(this.tech_.el(),"height"),10),this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.master.playlists.filter(Cu.isEnabled);om(e,function(e,t){return dm(e,t)});var t=e.filter(function(e){return yc(e.attributes.CODECS).videoCodec});return t[0]||null},comparePlaylistBandwidth:dm,comparePlaylistResolution:lm,xhr:Iu()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(e){Object.defineProperty(tg,e,{get:function(){mt.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing");return Gc[e]},set:function(t){mt.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing");if("number"!=typeof t||0>t){mt.log.warn("value of Hls."+e+" must be greater than or equal to 0");return}Gc[e]=t}})});var ag=function(e){var t=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;if(t.test(e)){return"hls"}var a=/^application\/dash\+xml/i;if(a.test(e)){return"dash"}return null},ng=function(e,t){for(var a=t.media(),n=-1,r=0;r<e.length;r++){if(e[r].id===a.uri){n=r;break}}e.selectedIndex_=n;e.trigger({selectedIndex:n,type:"change"})},rg=function(e,t){t.representations().forEach(function(t){e.addQualityLevel(t)});ng(e,t.playlists)};tg.canPlaySource=function(){return mt.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var ig=function(e,t,a){if(!e){return e}var n={};for(var r in e){n[r]={audioContentType:"audio/mp4; codecs=\""+a.attributes.CODECS+"\"",videoContentType:"video/mp4; codecs=\""+t.attributes.CODECS+"\""};if(t.contentProtection&&t.contentProtection[r]&&t.contentProtection[r].pssh){n[r].pssh=t.contentProtection[r].pssh}if("string"==typeof e[r]){n[r].url=e[r]}}return mt.mergeOptions(e,n)},sg=function(e){if("dash"!==e.options_.sourceType){return}var t=mt.players[e.tech_.options_.playerId];if(t.eme){var a=ig(e.source_.keySystems,e.playlists.media(),e.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());if(a){t.currentSource().keySystems=a;if(t.eme.initializeMediaKeys){t.eme.initializeMediaKeys()}}}},og=function(){if(!window.localStorage){return null}var e=window.localStorage.getItem("videojs-vhs");if(!e){return null}try{return JSON.parse(e)}catch(t){return null}},dg=function(e){if(!window.localStorage){return!1}var t=og();t=t?mt.mergeOptions(t,e):e;try{window.localStorage.setItem("videojs-vhs",JSON.stringify(t))}catch(t){return!1}return t};tg.supportsNativeHls=function(){var e=t.createElement("video");if(!mt.getTech("Html5").isSupported()){return!1}return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return /maybe|probably/i.test(e.canPlayType(t))})}();tg.supportsNativeDash=function(){if(!mt.getTech("Html5").isSupported()){return!1}return /maybe|probably/i.test(t.createElement("video").canPlayType("application/dash+xml"))}();tg.supportsTypeNatively=function(e){if("hls"===e){return tg.supportsNativeHls}if("dash"===e){return tg.supportsNativeDash}return!1};tg.isSupported=function(){return mt.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var lg=mt.getComponent("Component"),pg=function(e){zp(a,e);function a(e,n,r){Hp(this,a);var i=Gp(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,n,r.hls));if(n.options_&&n.options_.playerId){var s=mt(n.options_.playerId);if(!s.hasOwnProperty("hls")){Object.defineProperty(s,"hls",{get:function(){mt.log.warn("player.hls is deprecated. Use player.tech().hls instead.");n.trigger({type:"usage",name:"hls-player-access"});return i},configurable:!0})}s.vhs=i;s.dash=i;i.player_=s}i.tech_=n;i.source_=e;i.stats={};i.setOptions_();if(i.options_.overrideNative&&n.overrideNativeAudioTracks&&n.overrideNativeVideoTracks){n.overrideNativeAudioTracks(!0);n.overrideNativeVideoTracks(!0)}else if(i.options_.overrideNative&&(n.featuresNativeVideoTracks||n.featuresNativeAudioTracks)){throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB")}i.on(t,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(){var e=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement;if(e&&e.contains(i.tech_.el())){i.masterPlaylistController_.smoothQualityChange_()}});i.on(i.tech_,"seeking",function(){if(0===this.tech_.currentTime()&&this.tech_.player_.loop()){this.setCurrentTime(0)}});i.on(i.tech_,"error",function(){if(this.masterPlaylistController_){this.masterPlaylistController_.pauseLoading()}});i.on(i.tech_,"play",i.play);return i}Vp(a,[{key:"setOptions_",value:function(){var e=this;this.options_.withCredentials=this.options_.withCredentials||!1;this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1;this.options_.limitRenditionByPlayerDimensions=!1===this.options_.limitRenditionByPlayerDimensions?!1:!0;this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1;this.options_.useBandwidthFromLocalStorage="undefined"!=typeof this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1;this.options_.customTagParsers=this.options_.customTagParsers||[];this.options_.customTagMappers=this.options_.customTagMappers||[];if("number"!=typeof this.options_.blacklistDuration){this.options_.blacklistDuration=300}if("number"!=typeof this.options_.bandwidth){if(this.options_.useBandwidthFromLocalStorage){var t=og();if(t&&t.bandwidth){this.options_.bandwidth=t.bandwidth;this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})}if(t&&t.throughput){this.options_.throughput=t.throughput;this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"})}}}if("number"!=typeof this.options_.bandwidth){this.options_.bandwidth=Gc.INITIAL_BANDWIDTH}this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Gc.INITIAL_BANDWIDTH;["withCredentials","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects"].forEach(function(t){if("undefined"!=typeof e.source_[t]){e.options_[t]=e.source_[t]}});this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions}},{key:"src",value:function(e,t){var a=this;if(!e){return}this.setOptions_();this.options_.url=this.source_.src;this.options_.tech=this.tech_;this.options_.externHls=tg;this.options_.sourceType=ag(t);this.options_.seekTo=function(e){a.tech_.setCurrentTime(e);a.setCurrentTime(e)};this.masterPlaylistController_=new Wm(this.options_);this.playbackWatcher_=new Qm(mt.mergeOptions(this.options_,{seekable:function(){return a.seekable()},media:function(){return a.masterPlaylistController_.media()}}));this.masterPlaylistController_.on("error",function(){var e=mt.players[a.tech_.options_.playerId];e.error(a.masterPlaylistController_.error)});this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):tg.STANDARD_PLAYLIST_SELECTOR.bind(this);this.masterPlaylistController_.selectInitialPlaylist=tg.INITIAL_PLAYLIST_SELECTOR.bind(this);this.playlists=this.masterPlaylistController_.masterPlaylistLoader_;this.mediaSource=this.masterPlaylistController_.mediaSource;Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e;this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e;this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1),t=void 0;if(0<this.throughput){t=1/this.throughput}else{t=0}var a=Math.floor(1/(e+t));return a},set:function(){mt.log.error("The \"systemBandwidth\" property is read-only")}}});if(this.options_.bandwidth){this.bandwidth=this.options_.bandwidth}if(this.options_.throughput){this.throughput=this.options_.throughput}Object.defineProperties(this.stats,{bandwidth:{get:function(){return a.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return a.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return a.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return a.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return a.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return a.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return a.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return a.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return Zu(a.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return a.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return a.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return a.tech_.name_},enumerable:!0},duration:{get:function(){return a.tech_.duration()},enumerable:!0},master:{get:function(){return a.playlists.master},enumerable:!0},playerDimensions:{get:function(){return a.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Zu(a.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return a.tech_.getVideoPlaybackQuality()},enumerable:!0}});this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_));this.tech_.on("bandwidthupdate",function(){if(a.options_.useBandwidthFromLocalStorage){dg({bandwidth:a.bandwidth,throughput:Math.round(a.throughput)})}});this.masterPlaylistController_.on("selectedinitialmedia",function(){Xm(a);sg(a)});this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")});this.tech_.ready(function(){return a.setupQualityLevels_()});if(!this.tech_.el()){return}this.tech_.src(mt.URL.createObjectURL(this.masterPlaylistController_.mediaSource))}},{key:"setupQualityLevels_",value:function(){var e=this,t=mt.players[this.tech_.options_.playerId];if(t&&t.qualityLevels){this.qualityLevels_=t.qualityLevels();this.masterPlaylistController_.on("selectedinitialmedia",function(){rg(e.qualityLevels_,e)});this.playlists.on("mediachange",function(){ng(e.qualityLevels_,e.playlists)})}}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){if(this.playbackWatcher_){this.playbackWatcher_.dispose()}if(this.masterPlaylistController_){this.masterPlaylistController_.dispose()}if(this.qualityLevels_){this.qualityLevels_.dispose()}if(this.player_){delete this.player_.vhs;delete this.player_.dash;delete this.player_.hls}if(this.tech_&&this.tech_.hls){delete this.tech_.hls}qp(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return qu({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0,n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:2;return zu({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:n,pauseAfterSeek:a,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]);return a}(lg),ug={name:"videojs-http-streaming",VERSION:"1.9.3",canHandleSource:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},a=mt.mergeOptions(mt.options,t);return ug.canPlayType(e.type,a)},handleSource:function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},n=mt.mergeOptions(mt.options,a);t.hls=new pg(e,t,n);t.hls.xhr=Iu();t.hls.src(e.src,e.type);return t.hls},canPlayType:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},a=mt.mergeOptions(mt.options,t),n=a.hls.overrideNative,r=ag(e),i=r&&(!tg.supportsTypeNatively(r)||n);return i?"maybe":""}};if("undefined"==typeof mt.MediaSource||"undefined"==typeof mt.URL){mt.MediaSource=Bc;mt.URL=Nc}if(Bc.supportsNativeMediaSources()){mt.getTech("Html5").registerSourceHandler(ug,0)}mt.HlsHandler=pg;mt.HlsSourceHandler=ug;mt.Hls=tg;if(!mt.use){mt.registerComponent("Hls",tg)}mt.options.hls=mt.options.hls||{};if(mt.registerPlugin){mt.registerPlugin("reloadSourceOnError",eg)}else{mt.plugin("reloadSourceOnError",eg)}return mt});
//# sourceMappingURL=video-lazy.min.js.map
